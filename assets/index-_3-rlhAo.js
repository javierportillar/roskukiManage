function $v(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var At=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Wv(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var Wp={exports:{}},Ql={},Hp={exports:{}},Fe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Za=Symbol.for("react.element"),Hv=Symbol.for("react.portal"),Vv=Symbol.for("react.fragment"),Gv=Symbol.for("react.strict_mode"),Kv=Symbol.for("react.profiler"),qv=Symbol.for("react.provider"),Xv=Symbol.for("react.context"),Yv=Symbol.for("react.forward_ref"),Jv=Symbol.for("react.suspense"),Qv=Symbol.for("react.memo"),Zv=Symbol.for("react.lazy"),cd=Symbol.iterator;function ey(e){return e===null||typeof e!="object"?null:(e=cd&&e[cd]||e["@@iterator"],typeof e=="function"?e:null)}var Vp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Gp=Object.assign,Kp={};function Os(e,t,r){this.props=e,this.context=t,this.refs=Kp,this.updater=r||Vp}Os.prototype.isReactComponent={};Os.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Os.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function qp(){}qp.prototype=Os.prototype;function j0(e,t,r){this.props=e,this.context=t,this.refs=Kp,this.updater=r||Vp}var P0=j0.prototype=new qp;P0.constructor=j0;Gp(P0,Os.prototype);P0.isPureReactComponent=!0;var ud=Array.isArray,Xp=Object.prototype.hasOwnProperty,D0={current:null},Yp={key:!0,ref:!0,__self:!0,__source:!0};function Jp(e,t,r){var n,i={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)Xp.call(t,n)&&!Yp.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Za,type:e,key:s,ref:a,props:i,_owner:D0.current}}function ty(e,t){return{$$typeof:Za,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function I0(e){return typeof e=="object"&&e!==null&&e.$$typeof===Za}function ry(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var fd=/\/+/g;function Pc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?ry(""+e.key):t.toString(36)}function Ko(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Za:case Hv:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+Pc(a,0):n,ud(i)?(r="",e!=null&&(r=e.replace(fd,"$&/")+"/"),Ko(i,t,r,"",function(c){return c})):i!=null&&(I0(i)&&(i=ty(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(fd,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",ud(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Pc(s,o);a+=Ko(s,t,r,l,i)}else if(l=ey(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Pc(s,o++),a+=Ko(s,t,r,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function mo(e,t,r){if(e==null)return e;var n=[],i=0;return Ko(e,n,"","",function(s){return t.call(r,s,i++)}),n}function ny(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Qt={current:null},qo={transition:null},iy={ReactCurrentDispatcher:Qt,ReactCurrentBatchConfig:qo,ReactCurrentOwner:D0};function Qp(){throw Error("act(...) is not supported in production builds of React.")}Fe.Children={map:mo,forEach:function(e,t,r){mo(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return mo(e,function(){t++}),t},toArray:function(e){return mo(e,function(t){return t})||[]},only:function(e){if(!I0(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Fe.Component=Os;Fe.Fragment=Vv;Fe.Profiler=Kv;Fe.PureComponent=j0;Fe.StrictMode=Gv;Fe.Suspense=Jv;Fe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iy;Fe.act=Qp;Fe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Gp({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=D0.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Xp.call(t,l)&&!Yp.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:Za,type:e.type,key:i,ref:s,props:n,_owner:a}};Fe.createContext=function(e){return e={$$typeof:Xv,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:qv,_context:e},e.Consumer=e};Fe.createElement=Jp;Fe.createFactory=function(e){var t=Jp.bind(null,e);return t.type=e,t};Fe.createRef=function(){return{current:null}};Fe.forwardRef=function(e){return{$$typeof:Yv,render:e}};Fe.isValidElement=I0;Fe.lazy=function(e){return{$$typeof:Zv,_payload:{_status:-1,_result:e},_init:ny}};Fe.memo=function(e,t){return{$$typeof:Qv,type:e,compare:t===void 0?null:t}};Fe.startTransition=function(e){var t=qo.transition;qo.transition={};try{e()}finally{qo.transition=t}};Fe.unstable_act=Qp;Fe.useCallback=function(e,t){return Qt.current.useCallback(e,t)};Fe.useContext=function(e){return Qt.current.useContext(e)};Fe.useDebugValue=function(){};Fe.useDeferredValue=function(e){return Qt.current.useDeferredValue(e)};Fe.useEffect=function(e,t){return Qt.current.useEffect(e,t)};Fe.useId=function(){return Qt.current.useId()};Fe.useImperativeHandle=function(e,t,r){return Qt.current.useImperativeHandle(e,t,r)};Fe.useInsertionEffect=function(e,t){return Qt.current.useInsertionEffect(e,t)};Fe.useLayoutEffect=function(e,t){return Qt.current.useLayoutEffect(e,t)};Fe.useMemo=function(e,t){return Qt.current.useMemo(e,t)};Fe.useReducer=function(e,t,r){return Qt.current.useReducer(e,t,r)};Fe.useRef=function(e){return Qt.current.useRef(e)};Fe.useState=function(e){return Qt.current.useState(e)};Fe.useSyncExternalStore=function(e,t,r){return Qt.current.useSyncExternalStore(e,t,r)};Fe.useTransition=function(){return Qt.current.useTransition()};Fe.version="18.3.1";Hp.exports=Fe;var H=Hp.exports;const Zp=zv(H),sy=$v({__proto__:null,default:Zp},[H]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ay=H,oy=Symbol.for("react.element"),ly=Symbol.for("react.fragment"),cy=Object.prototype.hasOwnProperty,uy=ay.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fy={key:!0,ref:!0,__self:!0,__source:!0};function em(e,t,r){var n,i={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)cy.call(t,n)&&!fy.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:oy,type:e,key:s,ref:a,props:i,_owner:uy.current}}Ql.Fragment=ly;Ql.jsx=em;Ql.jsxs=em;Wp.exports=Ql;var f=Wp.exports,tm={exports:{}},_r={},rm={exports:{}},nm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(le,xe){var we=le.length;le.push(xe);e:for(;0<we;){var be=we-1>>>1,F=le[be];if(0<i(F,xe))le[be]=xe,le[we]=F,we=be;else break e}}function r(le){return le.length===0?null:le[0]}function n(le){if(le.length===0)return null;var xe=le[0],we=le.pop();if(we!==xe){le[0]=we;e:for(var be=0,F=le.length,U=F>>>1;be<U;){var D=2*(be+1)-1,P=le[D],J=D+1,pe=le[J];if(0>i(P,we))J<F&&0>i(pe,P)?(le[be]=pe,le[J]=we,be=J):(le[be]=P,le[D]=we,be=D);else if(J<F&&0>i(pe,we))le[be]=pe,le[J]=we,be=J;else break e}}return xe}function i(le,xe){var we=le.sortIndex-xe.sortIndex;return we!==0?we:le.id-xe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,h=3,p=!1,v=!1,m=!1,x=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(le){for(var xe=r(c);xe!==null;){if(xe.callback===null)n(c);else if(xe.startTime<=le)n(c),xe.sortIndex=xe.expirationTime,t(l,xe);else break;xe=r(c)}}function k(le){if(m=!1,g(le),!v)if(r(l)!==null)v=!0,re(j);else{var xe=r(c);xe!==null&&Se(k,xe.startTime-le)}}function j(le,xe){v=!1,m&&(m=!1,w(I),I=-1),p=!0;var we=h;try{for(g(xe),d=r(l);d!==null&&(!(d.expirationTime>xe)||le&&!K());){var be=d.callback;if(typeof be=="function"){d.callback=null,h=d.priorityLevel;var F=be(d.expirationTime<=xe);xe=e.unstable_now(),typeof F=="function"?d.callback=F:d===r(l)&&n(l),g(xe)}else n(l);d=r(l)}if(d!==null)var U=!0;else{var D=r(c);D!==null&&Se(k,D.startTime-xe),U=!1}return U}finally{d=null,h=we,p=!1}}var O=!1,T=null,I=-1,A=5,R=-1;function K(){return!(e.unstable_now()-R<A)}function G(){if(T!==null){var le=e.unstable_now();R=le;var xe=!0;try{xe=T(!0,le)}finally{xe?Q():(O=!1,T=null)}}else O=!1}var Q;if(typeof y=="function")Q=function(){y(G)};else if(typeof MessageChannel<"u"){var ye=new MessageChannel,Ee=ye.port2;ye.port1.onmessage=G,Q=function(){Ee.postMessage(null)}}else Q=function(){x(G,0)};function re(le){T=le,O||(O=!0,Q())}function Se(le,xe){I=x(function(){le(e.unstable_now())},xe)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(le){le.callback=null},e.unstable_continueExecution=function(){v||p||(v=!0,re(j))},e.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<le?Math.floor(1e3/le):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(le){switch(h){case 1:case 2:case 3:var xe=3;break;default:xe=h}var we=h;h=xe;try{return le()}finally{h=we}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(le,xe){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var we=h;h=le;try{return xe()}finally{h=we}},e.unstable_scheduleCallback=function(le,xe,we){var be=e.unstable_now();switch(typeof we=="object"&&we!==null?(we=we.delay,we=typeof we=="number"&&0<we?be+we:be):we=be,le){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=we+F,le={id:u++,callback:xe,priorityLevel:le,startTime:we,expirationTime:F,sortIndex:-1},we>be?(le.sortIndex=we,t(c,le),r(l)===null&&le===r(c)&&(m?(w(I),I=-1):m=!0,Se(k,we-be))):(le.sortIndex=F,t(l,le),v||p||(v=!0,re(j))),le},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(le){var xe=h;return function(){var we=h;h=xe;try{return le.apply(this,arguments)}finally{h=we}}}})(nm);rm.exports=nm;var dy=rm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hy=H,yr=dy;function te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var im=new Set,Na={};function ji(e,t){_s(e,t),_s(e+"Capture",t)}function _s(e,t){for(Na[e]=t,e=0;e<t.length;e++)im.add(t[e])}var yn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Su=Object.prototype.hasOwnProperty,py=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,dd={},hd={};function my(e){return Su.call(hd,e)?!0:Su.call(dd,e)?!1:py.test(e)?hd[e]=!0:(dd[e]=!0,!1)}function xy(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function gy(e,t,r,n){if(t===null||typeof t>"u"||xy(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Zt(e,t,r,n,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var Dt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Dt[e]=new Zt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Dt[t]=new Zt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Dt[e]=new Zt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Dt[e]=new Zt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Dt[e]=new Zt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Dt[e]=new Zt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Dt[e]=new Zt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Dt[e]=new Zt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Dt[e]=new Zt(e,5,!1,e.toLowerCase(),null,!1,!1)});var R0=/[\-:]([a-z])/g;function L0(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(R0,L0);Dt[t]=new Zt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(R0,L0);Dt[t]=new Zt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(R0,L0);Dt[t]=new Zt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Dt[e]=new Zt(e,1,!1,e.toLowerCase(),null,!1,!1)});Dt.xlinkHref=new Zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Dt[e]=new Zt(e,1,!1,e.toLowerCase(),null,!0,!0)});function M0(e,t,r,n){var i=Dt.hasOwnProperty(t)?Dt[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(gy(t,r,i,n)&&(r=null),n||i===null?my(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Nn=hy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xo=Symbol.for("react.element"),Ji=Symbol.for("react.portal"),Qi=Symbol.for("react.fragment"),B0=Symbol.for("react.strict_mode"),Eu=Symbol.for("react.profiler"),sm=Symbol.for("react.provider"),am=Symbol.for("react.context"),U0=Symbol.for("react.forward_ref"),Tu=Symbol.for("react.suspense"),ku=Symbol.for("react.suspense_list"),$0=Symbol.for("react.memo"),On=Symbol.for("react.lazy"),om=Symbol.for("react.offscreen"),pd=Symbol.iterator;function Gs(e){return e===null||typeof e!="object"?null:(e=pd&&e[pd]||e["@@iterator"],typeof e=="function"?e:null)}var st=Object.assign,Dc;function ra(e){if(Dc===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Dc=t&&t[1]||""}return`
`+Dc+e}var Ic=!1;function Rc(e,t){if(!e||Ic)return"";Ic=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=n.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{Ic=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ra(e):""}function vy(e){switch(e.tag){case 5:return ra(e.type);case 16:return ra("Lazy");case 13:return ra("Suspense");case 19:return ra("SuspenseList");case 0:case 2:case 15:return e=Rc(e.type,!1),e;case 11:return e=Rc(e.type.render,!1),e;case 1:return e=Rc(e.type,!0),e;default:return""}}function Nu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Qi:return"Fragment";case Ji:return"Portal";case Eu:return"Profiler";case B0:return"StrictMode";case Tu:return"Suspense";case ku:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case am:return(e.displayName||"Context")+".Consumer";case sm:return(e._context.displayName||"Context")+".Provider";case U0:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case $0:return t=e.displayName||null,t!==null?t:Nu(e.type)||"Memo";case On:t=e._payload,e=e._init;try{return Nu(e(t))}catch{}}return null}function yy(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Nu(t);case 8:return t===B0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Jn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function lm(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function wy(e){var t=lm(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function go(e){e._valueTracker||(e._valueTracker=wy(e))}function cm(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=lm(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function sl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Cu(e,t){var r=t.checked;return st({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function md(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Jn(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function um(e,t){t=t.checked,t!=null&&M0(e,"checked",t,!1)}function bu(e,t){um(e,t);var r=Jn(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Au(e,t.type,r):t.hasOwnProperty("defaultValue")&&Au(e,t.type,Jn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function xd(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Au(e,t,r){(t!=="number"||sl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var na=Array.isArray;function us(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Jn(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Fu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(te(91));return st({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function gd(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(te(92));if(na(r)){if(1<r.length)throw Error(te(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Jn(r)}}function fm(e,t){var r=Jn(t.value),n=Jn(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function vd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function dm(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ou(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?dm(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var vo,hm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(vo=vo||document.createElement("div"),vo.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=vo.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ca(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var la={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_y=["Webkit","ms","Moz","O"];Object.keys(la).forEach(function(e){_y.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),la[t]=la[e]})});function pm(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||la.hasOwnProperty(e)&&la[e]?(""+t).trim():t+"px"}function mm(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=pm(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var Sy=st({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ju(e,t){if(t){if(Sy[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(te(62))}}function Pu(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Du=null;function z0(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Iu=null,fs=null,ds=null;function yd(e){if(e=ro(e)){if(typeof Iu!="function")throw Error(te(280));var t=e.stateNode;t&&(t=nc(t),Iu(e.stateNode,e.type,t))}}function xm(e){fs?ds?ds.push(e):ds=[e]:fs=e}function gm(){if(fs){var e=fs,t=ds;if(ds=fs=null,yd(e),t)for(e=0;e<t.length;e++)yd(t[e])}}function vm(e,t){return e(t)}function ym(){}var Lc=!1;function wm(e,t,r){if(Lc)return e(t,r);Lc=!0;try{return vm(e,t,r)}finally{Lc=!1,(fs!==null||ds!==null)&&(ym(),gm())}}function ba(e,t){var r=e.stateNode;if(r===null)return null;var n=nc(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(te(231,t,typeof r));return r}var Ru=!1;if(yn)try{var Ks={};Object.defineProperty(Ks,"passive",{get:function(){Ru=!0}}),window.addEventListener("test",Ks,Ks),window.removeEventListener("test",Ks,Ks)}catch{Ru=!1}function Ey(e,t,r,n,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var ca=!1,al=null,ol=!1,Lu=null,Ty={onError:function(e){ca=!0,al=e}};function ky(e,t,r,n,i,s,a,o,l){ca=!1,al=null,Ey.apply(Ty,arguments)}function Ny(e,t,r,n,i,s,a,o,l){if(ky.apply(this,arguments),ca){if(ca){var c=al;ca=!1,al=null}else throw Error(te(198));ol||(ol=!0,Lu=c)}}function Pi(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function _m(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function wd(e){if(Pi(e)!==e)throw Error(te(188))}function Cy(e){var t=e.alternate;if(!t){if(t=Pi(e),t===null)throw Error(te(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return wd(i),e;if(s===n)return wd(i),t;s=s.sibling}throw Error(te(188))}if(r.return!==n.return)r=i,n=s;else{for(var a=!1,o=i.child;o;){if(o===r){a=!0,r=i,n=s;break}if(o===n){a=!0,n=i,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,n=i;break}if(o===n){a=!0,n=s,r=i;break}o=o.sibling}if(!a)throw Error(te(189))}}if(r.alternate!==n)throw Error(te(190))}if(r.tag!==3)throw Error(te(188));return r.stateNode.current===r?e:t}function Sm(e){return e=Cy(e),e!==null?Em(e):null}function Em(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Em(e);if(t!==null)return t;e=e.sibling}return null}var Tm=yr.unstable_scheduleCallback,_d=yr.unstable_cancelCallback,by=yr.unstable_shouldYield,Ay=yr.unstable_requestPaint,ct=yr.unstable_now,Fy=yr.unstable_getCurrentPriorityLevel,W0=yr.unstable_ImmediatePriority,km=yr.unstable_UserBlockingPriority,ll=yr.unstable_NormalPriority,Oy=yr.unstable_LowPriority,Nm=yr.unstable_IdlePriority,Zl=null,tn=null;function jy(e){if(tn&&typeof tn.onCommitFiberRoot=="function")try{tn.onCommitFiberRoot(Zl,e,void 0,(e.current.flags&128)===128)}catch{}}var Gr=Math.clz32?Math.clz32:Iy,Py=Math.log,Dy=Math.LN2;function Iy(e){return e>>>=0,e===0?32:31-(Py(e)/Dy|0)|0}var yo=64,wo=4194304;function ia(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function cl(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~i;o!==0?n=ia(o):(s&=a,s!==0&&(n=ia(s)))}else a=r&~i,a!==0?n=ia(a):s!==0&&(n=ia(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Gr(t),i=1<<r,n|=e[r],t&=~i;return n}function Ry(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ly(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-Gr(s),o=1<<a,l=i[a];l===-1?(!(o&r)||o&n)&&(i[a]=Ry(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function Mu(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Cm(){var e=yo;return yo<<=1,!(yo&4194240)&&(yo=64),e}function Mc(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function eo(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Gr(t),e[t]=r}function My(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Gr(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function H0(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Gr(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var He=0;function bm(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Am,V0,Fm,Om,jm,Bu=!1,_o=[],zn=null,Wn=null,Hn=null,Aa=new Map,Fa=new Map,Dn=[],By="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sd(e,t){switch(e){case"focusin":case"focusout":zn=null;break;case"dragenter":case"dragleave":Wn=null;break;case"mouseover":case"mouseout":Hn=null;break;case"pointerover":case"pointerout":Aa.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fa.delete(t.pointerId)}}function qs(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=ro(t),t!==null&&V0(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Uy(e,t,r,n,i){switch(t){case"focusin":return zn=qs(zn,e,t,r,n,i),!0;case"dragenter":return Wn=qs(Wn,e,t,r,n,i),!0;case"mouseover":return Hn=qs(Hn,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Aa.set(s,qs(Aa.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Fa.set(s,qs(Fa.get(s)||null,e,t,r,n,i)),!0}return!1}function Pm(e){var t=vi(e.target);if(t!==null){var r=Pi(t);if(r!==null){if(t=r.tag,t===13){if(t=_m(r),t!==null){e.blockedOn=t,jm(e.priority,function(){Fm(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xo(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Uu(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Du=n,r.target.dispatchEvent(n),Du=null}else return t=ro(r),t!==null&&V0(t),e.blockedOn=r,!1;t.shift()}return!0}function Ed(e,t,r){Xo(e)&&r.delete(t)}function $y(){Bu=!1,zn!==null&&Xo(zn)&&(zn=null),Wn!==null&&Xo(Wn)&&(Wn=null),Hn!==null&&Xo(Hn)&&(Hn=null),Aa.forEach(Ed),Fa.forEach(Ed)}function Xs(e,t){e.blockedOn===t&&(e.blockedOn=null,Bu||(Bu=!0,yr.unstable_scheduleCallback(yr.unstable_NormalPriority,$y)))}function Oa(e){function t(i){return Xs(i,e)}if(0<_o.length){Xs(_o[0],e);for(var r=1;r<_o.length;r++){var n=_o[r];n.blockedOn===e&&(n.blockedOn=null)}}for(zn!==null&&Xs(zn,e),Wn!==null&&Xs(Wn,e),Hn!==null&&Xs(Hn,e),Aa.forEach(t),Fa.forEach(t),r=0;r<Dn.length;r++)n=Dn[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Dn.length&&(r=Dn[0],r.blockedOn===null);)Pm(r),r.blockedOn===null&&Dn.shift()}var hs=Nn.ReactCurrentBatchConfig,ul=!0;function zy(e,t,r,n){var i=He,s=hs.transition;hs.transition=null;try{He=1,G0(e,t,r,n)}finally{He=i,hs.transition=s}}function Wy(e,t,r,n){var i=He,s=hs.transition;hs.transition=null;try{He=4,G0(e,t,r,n)}finally{He=i,hs.transition=s}}function G0(e,t,r,n){if(ul){var i=Uu(e,t,r,n);if(i===null)qc(e,t,n,fl,r),Sd(e,n);else if(Uy(i,e,t,r,n))n.stopPropagation();else if(Sd(e,n),t&4&&-1<By.indexOf(e)){for(;i!==null;){var s=ro(i);if(s!==null&&Am(s),s=Uu(e,t,r,n),s===null&&qc(e,t,n,fl,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else qc(e,t,n,null,r)}}var fl=null;function Uu(e,t,r,n){if(fl=null,e=z0(n),e=vi(e),e!==null)if(t=Pi(e),t===null)e=null;else if(r=t.tag,r===13){if(e=_m(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return fl=e,null}function Dm(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Fy()){case W0:return 1;case km:return 4;case ll:case Oy:return 16;case Nm:return 536870912;default:return 16}default:return 16}}var Ln=null,K0=null,Yo=null;function Im(){if(Yo)return Yo;var e,t=K0,r=t.length,n,i="value"in Ln?Ln.value:Ln.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[s-n];n++);return Yo=i.slice(e,1<n?1-n:void 0)}function Jo(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function So(){return!0}function Td(){return!1}function Sr(e){function t(r,n,i,s,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?So:Td,this.isPropagationStopped=Td,this}return st(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=So)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=So)},persist:function(){},isPersistent:So}),t}var js={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},q0=Sr(js),to=st({},js,{view:0,detail:0}),Hy=Sr(to),Bc,Uc,Ys,ec=st({},to,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:X0,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ys&&(Ys&&e.type==="mousemove"?(Bc=e.screenX-Ys.screenX,Uc=e.screenY-Ys.screenY):Uc=Bc=0,Ys=e),Bc)},movementY:function(e){return"movementY"in e?e.movementY:Uc}}),kd=Sr(ec),Vy=st({},ec,{dataTransfer:0}),Gy=Sr(Vy),Ky=st({},to,{relatedTarget:0}),$c=Sr(Ky),qy=st({},js,{animationName:0,elapsedTime:0,pseudoElement:0}),Xy=Sr(qy),Yy=st({},js,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jy=Sr(Yy),Qy=st({},js,{data:0}),Nd=Sr(Qy),Zy={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},e2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},t2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function r2(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=t2[e])?!!t[e]:!1}function X0(){return r2}var n2=st({},to,{key:function(e){if(e.key){var t=Zy[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Jo(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?e2[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:X0,charCode:function(e){return e.type==="keypress"?Jo(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Jo(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),i2=Sr(n2),s2=st({},ec,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cd=Sr(s2),a2=st({},to,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:X0}),o2=Sr(a2),l2=st({},js,{propertyName:0,elapsedTime:0,pseudoElement:0}),c2=Sr(l2),u2=st({},ec,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),f2=Sr(u2),d2=[9,13,27,32],Y0=yn&&"CompositionEvent"in window,ua=null;yn&&"documentMode"in document&&(ua=document.documentMode);var h2=yn&&"TextEvent"in window&&!ua,Rm=yn&&(!Y0||ua&&8<ua&&11>=ua),bd=" ",Ad=!1;function Lm(e,t){switch(e){case"keyup":return d2.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Mm(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Zi=!1;function p2(e,t){switch(e){case"compositionend":return Mm(t);case"keypress":return t.which!==32?null:(Ad=!0,bd);case"textInput":return e=t.data,e===bd&&Ad?null:e;default:return null}}function m2(e,t){if(Zi)return e==="compositionend"||!Y0&&Lm(e,t)?(e=Im(),Yo=K0=Ln=null,Zi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Rm&&t.locale!=="ko"?null:t.data;default:return null}}var x2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fd(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!x2[e.type]:t==="textarea"}function Bm(e,t,r,n){xm(n),t=dl(t,"onChange"),0<t.length&&(r=new q0("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var fa=null,ja=null;function g2(e){Ym(e,0)}function tc(e){var t=rs(e);if(cm(t))return e}function v2(e,t){if(e==="change")return t}var Um=!1;if(yn){var zc;if(yn){var Wc="oninput"in document;if(!Wc){var Od=document.createElement("div");Od.setAttribute("oninput","return;"),Wc=typeof Od.oninput=="function"}zc=Wc}else zc=!1;Um=zc&&(!document.documentMode||9<document.documentMode)}function jd(){fa&&(fa.detachEvent("onpropertychange",$m),ja=fa=null)}function $m(e){if(e.propertyName==="value"&&tc(ja)){var t=[];Bm(t,ja,e,z0(e)),wm(g2,t)}}function y2(e,t,r){e==="focusin"?(jd(),fa=t,ja=r,fa.attachEvent("onpropertychange",$m)):e==="focusout"&&jd()}function w2(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return tc(ja)}function _2(e,t){if(e==="click")return tc(t)}function S2(e,t){if(e==="input"||e==="change")return tc(t)}function E2(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Xr=typeof Object.is=="function"?Object.is:E2;function Pa(e,t){if(Xr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Su.call(t,i)||!Xr(e[i],t[i]))return!1}return!0}function Pd(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Dd(e,t){var r=Pd(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Pd(r)}}function zm(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?zm(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Wm(){for(var e=window,t=sl();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=sl(e.document)}return t}function J0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function T2(e){var t=Wm(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&zm(r.ownerDocument.documentElement,r)){if(n!==null&&J0(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=Dd(r,s);var a=Dd(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var k2=yn&&"documentMode"in document&&11>=document.documentMode,es=null,$u=null,da=null,zu=!1;function Id(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;zu||es==null||es!==sl(n)||(n=es,"selectionStart"in n&&J0(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),da&&Pa(da,n)||(da=n,n=dl($u,"onSelect"),0<n.length&&(t=new q0("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=es)))}function Eo(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ts={animationend:Eo("Animation","AnimationEnd"),animationiteration:Eo("Animation","AnimationIteration"),animationstart:Eo("Animation","AnimationStart"),transitionend:Eo("Transition","TransitionEnd")},Hc={},Hm={};yn&&(Hm=document.createElement("div").style,"AnimationEvent"in window||(delete ts.animationend.animation,delete ts.animationiteration.animation,delete ts.animationstart.animation),"TransitionEvent"in window||delete ts.transitionend.transition);function rc(e){if(Hc[e])return Hc[e];if(!ts[e])return e;var t=ts[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Hm)return Hc[e]=t[r];return e}var Vm=rc("animationend"),Gm=rc("animationiteration"),Km=rc("animationstart"),qm=rc("transitionend"),Xm=new Map,Rd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ri(e,t){Xm.set(e,t),ji(t,[e])}for(var Vc=0;Vc<Rd.length;Vc++){var Gc=Rd[Vc],N2=Gc.toLowerCase(),C2=Gc[0].toUpperCase()+Gc.slice(1);ri(N2,"on"+C2)}ri(Vm,"onAnimationEnd");ri(Gm,"onAnimationIteration");ri(Km,"onAnimationStart");ri("dblclick","onDoubleClick");ri("focusin","onFocus");ri("focusout","onBlur");ri(qm,"onTransitionEnd");_s("onMouseEnter",["mouseout","mouseover"]);_s("onMouseLeave",["mouseout","mouseover"]);_s("onPointerEnter",["pointerout","pointerover"]);_s("onPointerLeave",["pointerout","pointerover"]);ji("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ji("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ji("onBeforeInput",["compositionend","keypress","textInput","paste"]);ji("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ji("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ji("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var sa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),b2=new Set("cancel close invalid load scroll toggle".split(" ").concat(sa));function Ld(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Ny(n,t,void 0,e),e.currentTarget=null}function Ym(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Ld(i,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Ld(i,o,c),s=l}}}if(ol)throw e=Lu,ol=!1,Lu=null,e}function Ye(e,t){var r=t[Ku];r===void 0&&(r=t[Ku]=new Set);var n=e+"__bubble";r.has(n)||(Jm(t,e,2,!1),r.add(n))}function Kc(e,t,r){var n=0;t&&(n|=4),Jm(r,e,n,t)}var To="_reactListening"+Math.random().toString(36).slice(2);function Da(e){if(!e[To]){e[To]=!0,im.forEach(function(r){r!=="selectionchange"&&(b2.has(r)||Kc(r,!1,e),Kc(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[To]||(t[To]=!0,Kc("selectionchange",!1,t))}}function Jm(e,t,r,n){switch(Dm(t)){case 1:var i=zy;break;case 4:i=Wy;break;default:i=G0}r=i.bind(null,t,r,e),i=void 0,!Ru||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function qc(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=vi(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}wm(function(){var c=s,u=z0(r),d=[];e:{var h=Xm.get(e);if(h!==void 0){var p=q0,v=e;switch(e){case"keypress":if(Jo(r)===0)break e;case"keydown":case"keyup":p=i2;break;case"focusin":v="focus",p=$c;break;case"focusout":v="blur",p=$c;break;case"beforeblur":case"afterblur":p=$c;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=kd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Gy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=o2;break;case Vm:case Gm:case Km:p=Xy;break;case qm:p=c2;break;case"scroll":p=Hy;break;case"wheel":p=f2;break;case"copy":case"cut":case"paste":p=Jy;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Cd}var m=(t&4)!==0,x=!m&&e==="scroll",w=m?h!==null?h+"Capture":null:h;m=[];for(var y=c,g;y!==null;){g=y;var k=g.stateNode;if(g.tag===5&&k!==null&&(g=k,w!==null&&(k=ba(y,w),k!=null&&m.push(Ia(y,k,g)))),x)break;y=y.return}0<m.length&&(h=new p(h,v,null,r,u),d.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Du&&(v=r.relatedTarget||r.fromElement)&&(vi(v)||v[wn]))break e;if((p||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,p?(v=r.relatedTarget||r.toElement,p=c,v=v?vi(v):null,v!==null&&(x=Pi(v),v!==x||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=c),p!==v)){if(m=kd,k="onMouseLeave",w="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=Cd,k="onPointerLeave",w="onPointerEnter",y="pointer"),x=p==null?h:rs(p),g=v==null?h:rs(v),h=new m(k,y+"leave",p,r,u),h.target=x,h.relatedTarget=g,k=null,vi(u)===c&&(m=new m(w,y+"enter",v,r,u),m.target=g,m.relatedTarget=x,k=m),x=k,p&&v)t:{for(m=p,w=v,y=0,g=m;g;g=$i(g))y++;for(g=0,k=w;k;k=$i(k))g++;for(;0<y-g;)m=$i(m),y--;for(;0<g-y;)w=$i(w),g--;for(;y--;){if(m===w||w!==null&&m===w.alternate)break t;m=$i(m),w=$i(w)}m=null}else m=null;p!==null&&Md(d,h,p,m,!1),v!==null&&x!==null&&Md(d,x,v,m,!0)}}e:{if(h=c?rs(c):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var j=v2;else if(Fd(h))if(Um)j=S2;else{j=w2;var O=y2}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(j=_2);if(j&&(j=j(e,c))){Bm(d,j,r,u);break e}O&&O(e,h,c),e==="focusout"&&(O=h._wrapperState)&&O.controlled&&h.type==="number"&&Au(h,"number",h.value)}switch(O=c?rs(c):window,e){case"focusin":(Fd(O)||O.contentEditable==="true")&&(es=O,$u=c,da=null);break;case"focusout":da=$u=es=null;break;case"mousedown":zu=!0;break;case"contextmenu":case"mouseup":case"dragend":zu=!1,Id(d,r,u);break;case"selectionchange":if(k2)break;case"keydown":case"keyup":Id(d,r,u)}var T;if(Y0)e:{switch(e){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Zi?Lm(e,r)&&(I="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(I="onCompositionStart");I&&(Rm&&r.locale!=="ko"&&(Zi||I!=="onCompositionStart"?I==="onCompositionEnd"&&Zi&&(T=Im()):(Ln=u,K0="value"in Ln?Ln.value:Ln.textContent,Zi=!0)),O=dl(c,I),0<O.length&&(I=new Nd(I,e,null,r,u),d.push({event:I,listeners:O}),T?I.data=T:(T=Mm(r),T!==null&&(I.data=T)))),(T=h2?p2(e,r):m2(e,r))&&(c=dl(c,"onBeforeInput"),0<c.length&&(u=new Nd("onBeforeInput","beforeinput",null,r,u),d.push({event:u,listeners:c}),u.data=T))}Ym(d,t)})}function Ia(e,t,r){return{instance:e,listener:t,currentTarget:r}}function dl(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ba(e,r),s!=null&&n.unshift(Ia(e,s,i)),s=ba(e,t),s!=null&&n.push(Ia(e,s,i))),e=e.return}return n}function $i(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Md(e,t,r,n,i){for(var s=t._reactName,a=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,i?(l=ba(r,s),l!=null&&a.unshift(Ia(r,l,o))):i||(l=ba(r,s),l!=null&&a.push(Ia(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var A2=/\r\n?/g,F2=/\u0000|\uFFFD/g;function Bd(e){return(typeof e=="string"?e:""+e).replace(A2,`
`).replace(F2,"")}function ko(e,t,r){if(t=Bd(t),Bd(e)!==t&&r)throw Error(te(425))}function hl(){}var Wu=null,Hu=null;function Vu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Gu=typeof setTimeout=="function"?setTimeout:void 0,O2=typeof clearTimeout=="function"?clearTimeout:void 0,Ud=typeof Promise=="function"?Promise:void 0,j2=typeof queueMicrotask=="function"?queueMicrotask:typeof Ud<"u"?function(e){return Ud.resolve(null).then(e).catch(P2)}:Gu;function P2(e){setTimeout(function(){throw e})}function Xc(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Oa(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Oa(t)}function Vn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function $d(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ps=Math.random().toString(36).slice(2),en="__reactFiber$"+Ps,Ra="__reactProps$"+Ps,wn="__reactContainer$"+Ps,Ku="__reactEvents$"+Ps,D2="__reactListeners$"+Ps,I2="__reactHandles$"+Ps;function vi(e){var t=e[en];if(t)return t;for(var r=e.parentNode;r;){if(t=r[wn]||r[en]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=$d(e);e!==null;){if(r=e[en])return r;e=$d(e)}return t}e=r,r=e.parentNode}return null}function ro(e){return e=e[en]||e[wn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function rs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(te(33))}function nc(e){return e[Ra]||null}var qu=[],ns=-1;function ni(e){return{current:e}}function Je(e){0>ns||(e.current=qu[ns],qu[ns]=null,ns--)}function Xe(e,t){ns++,qu[ns]=e.current,e.current=t}var Qn={},zt=ni(Qn),sr=ni(!1),Ti=Qn;function Ss(e,t){var r=e.type.contextTypes;if(!r)return Qn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function ar(e){return e=e.childContextTypes,e!=null}function pl(){Je(sr),Je(zt)}function zd(e,t,r){if(zt.current!==Qn)throw Error(te(168));Xe(zt,t),Xe(sr,r)}function Qm(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(te(108,yy(e)||"Unknown",i));return st({},r,n)}function ml(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Qn,Ti=zt.current,Xe(zt,e),Xe(sr,sr.current),!0}function Wd(e,t,r){var n=e.stateNode;if(!n)throw Error(te(169));r?(e=Qm(e,t,Ti),n.__reactInternalMemoizedMergedChildContext=e,Je(sr),Je(zt),Xe(zt,e)):Je(sr),Xe(sr,r)}var fn=null,ic=!1,Yc=!1;function Zm(e){fn===null?fn=[e]:fn.push(e)}function R2(e){ic=!0,Zm(e)}function ii(){if(!Yc&&fn!==null){Yc=!0;var e=0,t=He;try{var r=fn;for(He=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}fn=null,ic=!1}catch(i){throw fn!==null&&(fn=fn.slice(e+1)),Tm(W0,ii),i}finally{He=t,Yc=!1}}return null}var is=[],ss=0,xl=null,gl=0,Nr=[],Cr=0,ki=null,dn=1,hn="";function hi(e,t){is[ss++]=gl,is[ss++]=xl,xl=e,gl=t}function e1(e,t,r){Nr[Cr++]=dn,Nr[Cr++]=hn,Nr[Cr++]=ki,ki=e;var n=dn;e=hn;var i=32-Gr(n)-1;n&=~(1<<i),r+=1;var s=32-Gr(t)+i;if(30<s){var a=i-i%5;s=(n&(1<<a)-1).toString(32),n>>=a,i-=a,dn=1<<32-Gr(t)+i|r<<i|n,hn=s+e}else dn=1<<s|r<<i|n,hn=e}function Q0(e){e.return!==null&&(hi(e,1),e1(e,1,0))}function Z0(e){for(;e===xl;)xl=is[--ss],is[ss]=null,gl=is[--ss],is[ss]=null;for(;e===ki;)ki=Nr[--Cr],Nr[Cr]=null,hn=Nr[--Cr],Nr[Cr]=null,dn=Nr[--Cr],Nr[Cr]=null}var vr=null,gr=null,et=!1,Wr=null;function t1(e,t){var r=br(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Hd(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,vr=e,gr=Vn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,vr=e,gr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ki!==null?{id:dn,overflow:hn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=br(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,vr=e,gr=null,!0):!1;default:return!1}}function Xu(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Yu(e){if(et){var t=gr;if(t){var r=t;if(!Hd(e,t)){if(Xu(e))throw Error(te(418));t=Vn(r.nextSibling);var n=vr;t&&Hd(e,t)?t1(n,r):(e.flags=e.flags&-4097|2,et=!1,vr=e)}}else{if(Xu(e))throw Error(te(418));e.flags=e.flags&-4097|2,et=!1,vr=e}}}function Vd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;vr=e}function No(e){if(e!==vr)return!1;if(!et)return Vd(e),et=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Vu(e.type,e.memoizedProps)),t&&(t=gr)){if(Xu(e))throw r1(),Error(te(418));for(;t;)t1(e,t),t=Vn(t.nextSibling)}if(Vd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){gr=Vn(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}gr=null}}else gr=vr?Vn(e.stateNode.nextSibling):null;return!0}function r1(){for(var e=gr;e;)e=Vn(e.nextSibling)}function Es(){gr=vr=null,et=!1}function ef(e){Wr===null?Wr=[e]:Wr.push(e)}var L2=Nn.ReactCurrentBatchConfig;function Js(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(te(309));var n=r.stateNode}if(!n)throw Error(te(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(te(284));if(!r._owner)throw Error(te(290,e))}return e}function Co(e,t){throw e=Object.prototype.toString.call(t),Error(te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Gd(e){var t=e._init;return t(e._payload)}function n1(e){function t(w,y){if(e){var g=w.deletions;g===null?(w.deletions=[y],w.flags|=16):g.push(y)}}function r(w,y){if(!e)return null;for(;y!==null;)t(w,y),y=y.sibling;return null}function n(w,y){for(w=new Map;y!==null;)y.key!==null?w.set(y.key,y):w.set(y.index,y),y=y.sibling;return w}function i(w,y){return w=Xn(w,y),w.index=0,w.sibling=null,w}function s(w,y,g){return w.index=g,e?(g=w.alternate,g!==null?(g=g.index,g<y?(w.flags|=2,y):g):(w.flags|=2,y)):(w.flags|=1048576,y)}function a(w){return e&&w.alternate===null&&(w.flags|=2),w}function o(w,y,g,k){return y===null||y.tag!==6?(y=nu(g,w.mode,k),y.return=w,y):(y=i(y,g),y.return=w,y)}function l(w,y,g,k){var j=g.type;return j===Qi?u(w,y,g.props.children,k,g.key):y!==null&&(y.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===On&&Gd(j)===y.type)?(k=i(y,g.props),k.ref=Js(w,y,g),k.return=w,k):(k=il(g.type,g.key,g.props,null,w.mode,k),k.ref=Js(w,y,g),k.return=w,k)}function c(w,y,g,k){return y===null||y.tag!==4||y.stateNode.containerInfo!==g.containerInfo||y.stateNode.implementation!==g.implementation?(y=iu(g,w.mode,k),y.return=w,y):(y=i(y,g.children||[]),y.return=w,y)}function u(w,y,g,k,j){return y===null||y.tag!==7?(y=Si(g,w.mode,k,j),y.return=w,y):(y=i(y,g),y.return=w,y)}function d(w,y,g){if(typeof y=="string"&&y!==""||typeof y=="number")return y=nu(""+y,w.mode,g),y.return=w,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case xo:return g=il(y.type,y.key,y.props,null,w.mode,g),g.ref=Js(w,null,y),g.return=w,g;case Ji:return y=iu(y,w.mode,g),y.return=w,y;case On:var k=y._init;return d(w,k(y._payload),g)}if(na(y)||Gs(y))return y=Si(y,w.mode,g,null),y.return=w,y;Co(w,y)}return null}function h(w,y,g,k){var j=y!==null?y.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return j!==null?null:o(w,y,""+g,k);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case xo:return g.key===j?l(w,y,g,k):null;case Ji:return g.key===j?c(w,y,g,k):null;case On:return j=g._init,h(w,y,j(g._payload),k)}if(na(g)||Gs(g))return j!==null?null:u(w,y,g,k,null);Co(w,g)}return null}function p(w,y,g,k,j){if(typeof k=="string"&&k!==""||typeof k=="number")return w=w.get(g)||null,o(y,w,""+k,j);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case xo:return w=w.get(k.key===null?g:k.key)||null,l(y,w,k,j);case Ji:return w=w.get(k.key===null?g:k.key)||null,c(y,w,k,j);case On:var O=k._init;return p(w,y,g,O(k._payload),j)}if(na(k)||Gs(k))return w=w.get(g)||null,u(y,w,k,j,null);Co(y,k)}return null}function v(w,y,g,k){for(var j=null,O=null,T=y,I=y=0,A=null;T!==null&&I<g.length;I++){T.index>I?(A=T,T=null):A=T.sibling;var R=h(w,T,g[I],k);if(R===null){T===null&&(T=A);break}e&&T&&R.alternate===null&&t(w,T),y=s(R,y,I),O===null?j=R:O.sibling=R,O=R,T=A}if(I===g.length)return r(w,T),et&&hi(w,I),j;if(T===null){for(;I<g.length;I++)T=d(w,g[I],k),T!==null&&(y=s(T,y,I),O===null?j=T:O.sibling=T,O=T);return et&&hi(w,I),j}for(T=n(w,T);I<g.length;I++)A=p(T,w,I,g[I],k),A!==null&&(e&&A.alternate!==null&&T.delete(A.key===null?I:A.key),y=s(A,y,I),O===null?j=A:O.sibling=A,O=A);return e&&T.forEach(function(K){return t(w,K)}),et&&hi(w,I),j}function m(w,y,g,k){var j=Gs(g);if(typeof j!="function")throw Error(te(150));if(g=j.call(g),g==null)throw Error(te(151));for(var O=j=null,T=y,I=y=0,A=null,R=g.next();T!==null&&!R.done;I++,R=g.next()){T.index>I?(A=T,T=null):A=T.sibling;var K=h(w,T,R.value,k);if(K===null){T===null&&(T=A);break}e&&T&&K.alternate===null&&t(w,T),y=s(K,y,I),O===null?j=K:O.sibling=K,O=K,T=A}if(R.done)return r(w,T),et&&hi(w,I),j;if(T===null){for(;!R.done;I++,R=g.next())R=d(w,R.value,k),R!==null&&(y=s(R,y,I),O===null?j=R:O.sibling=R,O=R);return et&&hi(w,I),j}for(T=n(w,T);!R.done;I++,R=g.next())R=p(T,w,I,R.value,k),R!==null&&(e&&R.alternate!==null&&T.delete(R.key===null?I:R.key),y=s(R,y,I),O===null?j=R:O.sibling=R,O=R);return e&&T.forEach(function(G){return t(w,G)}),et&&hi(w,I),j}function x(w,y,g,k){if(typeof g=="object"&&g!==null&&g.type===Qi&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case xo:e:{for(var j=g.key,O=y;O!==null;){if(O.key===j){if(j=g.type,j===Qi){if(O.tag===7){r(w,O.sibling),y=i(O,g.props.children),y.return=w,w=y;break e}}else if(O.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===On&&Gd(j)===O.type){r(w,O.sibling),y=i(O,g.props),y.ref=Js(w,O,g),y.return=w,w=y;break e}r(w,O);break}else t(w,O);O=O.sibling}g.type===Qi?(y=Si(g.props.children,w.mode,k,g.key),y.return=w,w=y):(k=il(g.type,g.key,g.props,null,w.mode,k),k.ref=Js(w,y,g),k.return=w,w=k)}return a(w);case Ji:e:{for(O=g.key;y!==null;){if(y.key===O)if(y.tag===4&&y.stateNode.containerInfo===g.containerInfo&&y.stateNode.implementation===g.implementation){r(w,y.sibling),y=i(y,g.children||[]),y.return=w,w=y;break e}else{r(w,y);break}else t(w,y);y=y.sibling}y=iu(g,w.mode,k),y.return=w,w=y}return a(w);case On:return O=g._init,x(w,y,O(g._payload),k)}if(na(g))return v(w,y,g,k);if(Gs(g))return m(w,y,g,k);Co(w,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,y!==null&&y.tag===6?(r(w,y.sibling),y=i(y,g),y.return=w,w=y):(r(w,y),y=nu(g,w.mode,k),y.return=w,w=y),a(w)):r(w,y)}return x}var Ts=n1(!0),i1=n1(!1),vl=ni(null),yl=null,as=null,tf=null;function rf(){tf=as=yl=null}function nf(e){var t=vl.current;Je(vl),e._currentValue=t}function Ju(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ps(e,t){yl=e,tf=as=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ir=!0),e.firstContext=null)}function Fr(e){var t=e._currentValue;if(tf!==e)if(e={context:e,memoizedValue:t,next:null},as===null){if(yl===null)throw Error(te(308));as=e,yl.dependencies={lanes:0,firstContext:e}}else as=as.next=e;return t}var yi=null;function sf(e){yi===null?yi=[e]:yi.push(e)}function s1(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,sf(t)):(r.next=i.next,i.next=r),t.interleaved=r,_n(e,n)}function _n(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var jn=!1;function af(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function a1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function pn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Gn(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Pe&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,_n(e,r)}return i=n.interleaved,i===null?(t.next=t,sf(n)):(t.next=i.next,i.next=t),n.interleaved=t,_n(e,r)}function Qo(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,H0(e,r)}}function Kd(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function wl(e,t,r,n){var i=e.updateQueue;jn=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;a=0,u=c=l=null,o=s;do{var h=o.lane,p=o.eventTime;if((n&h)===h){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,m=o;switch(h=t,p=r,m.tag){case 1:if(v=m.payload,typeof v=="function"){d=v.call(p,d,h);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=m.payload,h=typeof v=="function"?v.call(p,d,h):v,h==null)break e;d=st({},d,h);break e;case 2:jn=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=d):u=u.next=p,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Ci|=a,e.lanes=a,e.memoizedState=d}}function qd(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(te(191,i));i.call(n)}}}var no={},rn=ni(no),La=ni(no),Ma=ni(no);function wi(e){if(e===no)throw Error(te(174));return e}function of(e,t){switch(Xe(Ma,t),Xe(La,e),Xe(rn,no),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Ou(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Ou(t,e)}Je(rn),Xe(rn,t)}function ks(){Je(rn),Je(La),Je(Ma)}function o1(e){wi(Ma.current);var t=wi(rn.current),r=Ou(t,e.type);t!==r&&(Xe(La,e),Xe(rn,r))}function lf(e){La.current===e&&(Je(rn),Je(La))}var nt=ni(0);function _l(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Jc=[];function cf(){for(var e=0;e<Jc.length;e++)Jc[e]._workInProgressVersionPrimary=null;Jc.length=0}var Zo=Nn.ReactCurrentDispatcher,Qc=Nn.ReactCurrentBatchConfig,Ni=0,it=null,xt=null,yt=null,Sl=!1,ha=!1,Ba=0,M2=0;function Lt(){throw Error(te(321))}function uf(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Xr(e[r],t[r]))return!1;return!0}function ff(e,t,r,n,i,s){if(Ni=s,it=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Zo.current=e===null||e.memoizedState===null?z2:W2,e=r(n,i),ha){s=0;do{if(ha=!1,Ba=0,25<=s)throw Error(te(301));s+=1,yt=xt=null,t.updateQueue=null,Zo.current=H2,e=r(n,i)}while(ha)}if(Zo.current=El,t=xt!==null&&xt.next!==null,Ni=0,yt=xt=it=null,Sl=!1,t)throw Error(te(300));return e}function df(){var e=Ba!==0;return Ba=0,e}function Zr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yt===null?it.memoizedState=yt=e:yt=yt.next=e,yt}function Or(){if(xt===null){var e=it.alternate;e=e!==null?e.memoizedState:null}else e=xt.next;var t=yt===null?it.memoizedState:yt.next;if(t!==null)yt=t,xt=e;else{if(e===null)throw Error(te(310));xt=e,e={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},yt===null?it.memoizedState=yt=e:yt=yt.next=e}return yt}function Ua(e,t){return typeof t=="function"?t(e):t}function Zc(e){var t=Or(),r=t.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var n=xt,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((Ni&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,a=n):l=l.next=d,it.lanes|=u,Ci|=u}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,Xr(n,t.memoizedState)||(ir=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,it.lanes|=s,Ci|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function eu(e){var t=Or(),r=t.queue;if(r===null)throw Error(te(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);Xr(s,t.memoizedState)||(ir=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function l1(){}function c1(e,t){var r=it,n=Or(),i=t(),s=!Xr(n.memoizedState,i);if(s&&(n.memoizedState=i,ir=!0),n=n.queue,hf(d1.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||yt!==null&&yt.memoizedState.tag&1){if(r.flags|=2048,$a(9,f1.bind(null,r,n,i,t),void 0,null),Et===null)throw Error(te(349));Ni&30||u1(r,t,i)}return i}function u1(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=it.updateQueue,t===null?(t={lastEffect:null,stores:null},it.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function f1(e,t,r,n){t.value=r,t.getSnapshot=n,h1(t)&&p1(e)}function d1(e,t,r){return r(function(){h1(t)&&p1(e)})}function h1(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Xr(e,r)}catch{return!0}}function p1(e){var t=_n(e,1);t!==null&&Kr(t,e,1,-1)}function Xd(e){var t=Zr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ua,lastRenderedState:e},t.queue=e,e=e.dispatch=$2.bind(null,it,e),[t.memoizedState,e]}function $a(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=it.updateQueue,t===null?(t={lastEffect:null,stores:null},it.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function m1(){return Or().memoizedState}function el(e,t,r,n){var i=Zr();it.flags|=e,i.memoizedState=$a(1|t,r,void 0,n===void 0?null:n)}function sc(e,t,r,n){var i=Or();n=n===void 0?null:n;var s=void 0;if(xt!==null){var a=xt.memoizedState;if(s=a.destroy,n!==null&&uf(n,a.deps)){i.memoizedState=$a(t,r,s,n);return}}it.flags|=e,i.memoizedState=$a(1|t,r,s,n)}function Yd(e,t){return el(8390656,8,e,t)}function hf(e,t){return sc(2048,8,e,t)}function x1(e,t){return sc(4,2,e,t)}function g1(e,t){return sc(4,4,e,t)}function v1(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function y1(e,t,r){return r=r!=null?r.concat([e]):null,sc(4,4,v1.bind(null,t,e),r)}function pf(){}function w1(e,t){var r=Or();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&uf(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function _1(e,t){var r=Or();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&uf(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function S1(e,t,r){return Ni&21?(Xr(r,t)||(r=Cm(),it.lanes|=r,Ci|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ir=!0),e.memoizedState=r)}function B2(e,t){var r=He;He=r!==0&&4>r?r:4,e(!0);var n=Qc.transition;Qc.transition={};try{e(!1),t()}finally{He=r,Qc.transition=n}}function E1(){return Or().memoizedState}function U2(e,t,r){var n=qn(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},T1(e))k1(t,r);else if(r=s1(e,t,r,n),r!==null){var i=Yt();Kr(r,e,n,i),N1(r,t,n)}}function $2(e,t,r){var n=qn(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(T1(e))k1(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(i.hasEagerState=!0,i.eagerState=o,Xr(o,a)){var l=t.interleaved;l===null?(i.next=i,sf(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=s1(e,t,i,n),r!==null&&(i=Yt(),Kr(r,e,n,i),N1(r,t,n))}}function T1(e){var t=e.alternate;return e===it||t!==null&&t===it}function k1(e,t){ha=Sl=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function N1(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,H0(e,r)}}var El={readContext:Fr,useCallback:Lt,useContext:Lt,useEffect:Lt,useImperativeHandle:Lt,useInsertionEffect:Lt,useLayoutEffect:Lt,useMemo:Lt,useReducer:Lt,useRef:Lt,useState:Lt,useDebugValue:Lt,useDeferredValue:Lt,useTransition:Lt,useMutableSource:Lt,useSyncExternalStore:Lt,useId:Lt,unstable_isNewReconciler:!1},z2={readContext:Fr,useCallback:function(e,t){return Zr().memoizedState=[e,t===void 0?null:t],e},useContext:Fr,useEffect:Yd,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,el(4194308,4,v1.bind(null,t,e),r)},useLayoutEffect:function(e,t){return el(4194308,4,e,t)},useInsertionEffect:function(e,t){return el(4,2,e,t)},useMemo:function(e,t){var r=Zr();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Zr();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=U2.bind(null,it,e),[n.memoizedState,e]},useRef:function(e){var t=Zr();return e={current:e},t.memoizedState=e},useState:Xd,useDebugValue:pf,useDeferredValue:function(e){return Zr().memoizedState=e},useTransition:function(){var e=Xd(!1),t=e[0];return e=B2.bind(null,e[1]),Zr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=it,i=Zr();if(et){if(r===void 0)throw Error(te(407));r=r()}else{if(r=t(),Et===null)throw Error(te(349));Ni&30||u1(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,Yd(d1.bind(null,n,s,e),[e]),n.flags|=2048,$a(9,f1.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Zr(),t=Et.identifierPrefix;if(et){var r=hn,n=dn;r=(n&~(1<<32-Gr(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ba++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=M2++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},W2={readContext:Fr,useCallback:w1,useContext:Fr,useEffect:hf,useImperativeHandle:y1,useInsertionEffect:x1,useLayoutEffect:g1,useMemo:_1,useReducer:Zc,useRef:m1,useState:function(){return Zc(Ua)},useDebugValue:pf,useDeferredValue:function(e){var t=Or();return S1(t,xt.memoizedState,e)},useTransition:function(){var e=Zc(Ua)[0],t=Or().memoizedState;return[e,t]},useMutableSource:l1,useSyncExternalStore:c1,useId:E1,unstable_isNewReconciler:!1},H2={readContext:Fr,useCallback:w1,useContext:Fr,useEffect:hf,useImperativeHandle:y1,useInsertionEffect:x1,useLayoutEffect:g1,useMemo:_1,useReducer:eu,useRef:m1,useState:function(){return eu(Ua)},useDebugValue:pf,useDeferredValue:function(e){var t=Or();return xt===null?t.memoizedState=e:S1(t,xt.memoizedState,e)},useTransition:function(){var e=eu(Ua)[0],t=Or().memoizedState;return[e,t]},useMutableSource:l1,useSyncExternalStore:c1,useId:E1,unstable_isNewReconciler:!1};function Ur(e,t){if(e&&e.defaultProps){t=st({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Qu(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:st({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ac={isMounted:function(e){return(e=e._reactInternals)?Pi(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Yt(),i=qn(e),s=pn(n,i);s.payload=t,r!=null&&(s.callback=r),t=Gn(e,s,i),t!==null&&(Kr(t,e,i,n),Qo(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Yt(),i=qn(e),s=pn(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Gn(e,s,i),t!==null&&(Kr(t,e,i,n),Qo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Yt(),n=qn(e),i=pn(r,n);i.tag=2,t!=null&&(i.callback=t),t=Gn(e,i,n),t!==null&&(Kr(t,e,n,r),Qo(t,e,n))}};function Jd(e,t,r,n,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!Pa(r,n)||!Pa(i,s):!0}function C1(e,t,r){var n=!1,i=Qn,s=t.contextType;return typeof s=="object"&&s!==null?s=Fr(s):(i=ar(t)?Ti:zt.current,n=t.contextTypes,s=(n=n!=null)?Ss(e,i):Qn),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ac,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Qd(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&ac.enqueueReplaceState(t,t.state,null)}function Zu(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},af(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Fr(s):(s=ar(t)?Ti:zt.current,i.context=Ss(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Qu(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&ac.enqueueReplaceState(i,i.state,null),wl(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Ns(e,t){try{var r="",n=t;do r+=vy(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function tu(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function e0(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var V2=typeof WeakMap=="function"?WeakMap:Map;function b1(e,t,r){r=pn(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){kl||(kl=!0,u0=n),e0(e,t)},r}function A1(e,t,r){r=pn(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){e0(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){e0(e,t),typeof n!="function"&&(Kn===null?Kn=new Set([this]):Kn.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function Zd(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new V2;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=sw.bind(null,e,t,r),t.then(e,e))}function eh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function th(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=pn(-1,1),t.tag=2,Gn(r,t,1))),r.lanes|=1),e)}var G2=Nn.ReactCurrentOwner,ir=!1;function Kt(e,t,r,n){t.child=e===null?i1(t,null,r,n):Ts(t,e.child,r,n)}function rh(e,t,r,n,i){r=r.render;var s=t.ref;return ps(t,i),n=ff(e,t,r,n,s,i),r=df(),e!==null&&!ir?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Sn(e,t,i)):(et&&r&&Q0(t),t.flags|=1,Kt(e,t,n,i),t.child)}function nh(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!Sf(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,F1(e,t,s,n,i)):(e=il(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:Pa,r(a,n)&&e.ref===t.ref)return Sn(e,t,i)}return t.flags|=1,e=Xn(s,n),e.ref=t.ref,e.return=t,t.child=e}function F1(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Pa(s,n)&&e.ref===t.ref)if(ir=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(ir=!0);else return t.lanes=e.lanes,Sn(e,t,i)}return t0(e,t,r,n,i)}function O1(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xe(ls,dr),dr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Xe(ls,dr),dr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Xe(ls,dr),dr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Xe(ls,dr),dr|=n;return Kt(e,t,i,r),t.child}function j1(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function t0(e,t,r,n,i){var s=ar(r)?Ti:zt.current;return s=Ss(t,s),ps(t,i),r=ff(e,t,r,n,s,i),n=df(),e!==null&&!ir?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Sn(e,t,i)):(et&&n&&Q0(t),t.flags|=1,Kt(e,t,r,i),t.child)}function ih(e,t,r,n,i){if(ar(r)){var s=!0;ml(t)}else s=!1;if(ps(t,i),t.stateNode===null)tl(e,t),C1(t,r,n),Zu(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=Fr(c):(c=ar(r)?Ti:zt.current,c=Ss(t,c));var u=r.getDerivedStateFromProps,d=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&Qd(t,a,n,c),jn=!1;var h=t.memoizedState;a.state=h,wl(t,n,a,i),l=t.memoizedState,o!==n||h!==l||sr.current||jn?(typeof u=="function"&&(Qu(t,r,u,n),l=t.memoizedState),(o=jn||Jd(t,r,o,n,h,l,c))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,a1(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Ur(t.type,o),a.props=c,d=t.pendingProps,h=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Fr(l):(l=ar(r)?Ti:zt.current,l=Ss(t,l));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||h!==l)&&Qd(t,a,n,l),jn=!1,h=t.memoizedState,a.state=h,wl(t,n,a,i);var v=t.memoizedState;o!==d||h!==v||sr.current||jn?(typeof p=="function"&&(Qu(t,r,p,n),v=t.memoizedState),(c=jn||Jd(t,r,c,n,h,v,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,v,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,v,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),a.props=n,a.state=v,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return r0(e,t,r,n,s,i)}function r0(e,t,r,n,i,s){j1(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&Wd(t,r,!1),Sn(e,t,s);n=t.stateNode,G2.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=Ts(t,e.child,null,s),t.child=Ts(t,null,o,s)):Kt(e,t,o,s),t.memoizedState=n.state,i&&Wd(t,r,!0),t.child}function P1(e){var t=e.stateNode;t.pendingContext?zd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&zd(e,t.context,!1),of(e,t.containerInfo)}function sh(e,t,r,n,i){return Es(),ef(i),t.flags|=256,Kt(e,t,r,n),t.child}var n0={dehydrated:null,treeContext:null,retryLane:0};function i0(e){return{baseLanes:e,cachePool:null,transitions:null}}function D1(e,t,r){var n=t.pendingProps,i=nt.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Xe(nt,i&1),e===null)return Yu(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=cc(a,n,0,null),e=Si(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=i0(r),t.memoizedState=n0,e):mf(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return K2(e,t,a,n,o,i,r);if(s){s=n.fallback,a=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Xn(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Xn(o,s):(s=Si(s,a,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?i0(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~r,t.memoizedState=n0,n}return s=e.child,e=s.sibling,n=Xn(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function mf(e,t){return t=cc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function bo(e,t,r,n){return n!==null&&ef(n),Ts(t,e.child,null,r),e=mf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function K2(e,t,r,n,i,s,a){if(r)return t.flags&256?(t.flags&=-257,n=tu(Error(te(422))),bo(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=cc({mode:"visible",children:n.children},i,0,null),s=Si(s,i,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Ts(t,e.child,null,a),t.child.memoizedState=i0(a),t.memoizedState=n0,s);if(!(t.mode&1))return bo(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(te(419)),n=tu(s,n,void 0),bo(e,t,a,n)}if(o=(a&e.childLanes)!==0,ir||o){if(n=Et,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,_n(e,i),Kr(n,e,i,-1))}return _f(),n=tu(Error(te(421))),bo(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=aw.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,gr=Vn(i.nextSibling),vr=t,et=!0,Wr=null,e!==null&&(Nr[Cr++]=dn,Nr[Cr++]=hn,Nr[Cr++]=ki,dn=e.id,hn=e.overflow,ki=t),t=mf(t,n.children),t.flags|=4096,t)}function ah(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Ju(e.return,t,r)}function ru(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function I1(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Kt(e,t,n.children,r),n=nt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ah(e,r,t);else if(e.tag===19)ah(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Xe(nt,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&_l(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),ru(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&_l(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}ru(t,!0,r,null,s);break;case"together":ru(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function tl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Sn(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Ci|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(te(153));if(t.child!==null){for(e=t.child,r=Xn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Xn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function q2(e,t,r){switch(t.tag){case 3:P1(t),Es();break;case 5:o1(t);break;case 1:ar(t.type)&&ml(t);break;case 4:of(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Xe(vl,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Xe(nt,nt.current&1),t.flags|=128,null):r&t.child.childLanes?D1(e,t,r):(Xe(nt,nt.current&1),e=Sn(e,t,r),e!==null?e.sibling:null);Xe(nt,nt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return I1(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Xe(nt,nt.current),n)break;return null;case 22:case 23:return t.lanes=0,O1(e,t,r)}return Sn(e,t,r)}var R1,s0,L1,M1;R1=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};s0=function(){};L1=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,wi(rn.current);var s=null;switch(r){case"input":i=Cu(e,i),n=Cu(e,n),s=[];break;case"select":i=st({},i,{value:void 0}),n=st({},n,{value:void 0}),s=[];break;case"textarea":i=Fu(e,i),n=Fu(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=hl)}ju(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Na.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Na.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ye("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};M1=function(e,t,r,n){r!==n&&(t.flags|=4)};function Qs(e,t){if(!et)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Mt(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function X2(e,t,r){var n=t.pendingProps;switch(Z0(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mt(t),null;case 1:return ar(t.type)&&pl(),Mt(t),null;case 3:return n=t.stateNode,ks(),Je(sr),Je(zt),cf(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(No(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Wr!==null&&(h0(Wr),Wr=null))),s0(e,t),Mt(t),null;case 5:lf(t);var i=wi(Ma.current);if(r=t.type,e!==null&&t.stateNode!=null)L1(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(te(166));return Mt(t),null}if(e=wi(rn.current),No(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[en]=t,n[Ra]=s,e=(t.mode&1)!==0,r){case"dialog":Ye("cancel",n),Ye("close",n);break;case"iframe":case"object":case"embed":Ye("load",n);break;case"video":case"audio":for(i=0;i<sa.length;i++)Ye(sa[i],n);break;case"source":Ye("error",n);break;case"img":case"image":case"link":Ye("error",n),Ye("load",n);break;case"details":Ye("toggle",n);break;case"input":md(n,s),Ye("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Ye("invalid",n);break;case"textarea":gd(n,s),Ye("invalid",n)}ju(r,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&ko(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&ko(n.textContent,o,e),i=["children",""+o]):Na.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Ye("scroll",n)}switch(r){case"input":go(n),xd(n,s,!0);break;case"textarea":go(n),vd(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=hl)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=dm(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[en]=t,e[Ra]=n,R1(e,t,!1,!1),t.stateNode=e;e:{switch(a=Pu(r,n),r){case"dialog":Ye("cancel",e),Ye("close",e),i=n;break;case"iframe":case"object":case"embed":Ye("load",e),i=n;break;case"video":case"audio":for(i=0;i<sa.length;i++)Ye(sa[i],e);i=n;break;case"source":Ye("error",e),i=n;break;case"img":case"image":case"link":Ye("error",e),Ye("load",e),i=n;break;case"details":Ye("toggle",e),i=n;break;case"input":md(e,n),i=Cu(e,n),Ye("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=st({},n,{value:void 0}),Ye("invalid",e);break;case"textarea":gd(e,n),i=Fu(e,n),Ye("invalid",e);break;default:i=n}ju(r,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?mm(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&hm(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Ca(e,l):typeof l=="number"&&Ca(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Na.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ye("scroll",e):l!=null&&M0(e,s,l,a))}switch(r){case"input":go(e),xd(e,n,!1);break;case"textarea":go(e),vd(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Jn(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?us(e,!!n.multiple,s,!1):n.defaultValue!=null&&us(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=hl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Mt(t),null;case 6:if(e&&t.stateNode!=null)M1(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(te(166));if(r=wi(Ma.current),wi(rn.current),No(t)){if(n=t.stateNode,r=t.memoizedProps,n[en]=t,(s=n.nodeValue!==r)&&(e=vr,e!==null))switch(e.tag){case 3:ko(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ko(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[en]=t,t.stateNode=n}return Mt(t),null;case 13:if(Je(nt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(et&&gr!==null&&t.mode&1&&!(t.flags&128))r1(),Es(),t.flags|=98560,s=!1;else if(s=No(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(te(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(te(317));s[en]=t}else Es(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Mt(t),s=!1}else Wr!==null&&(h0(Wr),Wr=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||nt.current&1?gt===0&&(gt=3):_f())),t.updateQueue!==null&&(t.flags|=4),Mt(t),null);case 4:return ks(),s0(e,t),e===null&&Da(t.stateNode.containerInfo),Mt(t),null;case 10:return nf(t.type._context),Mt(t),null;case 17:return ar(t.type)&&pl(),Mt(t),null;case 19:if(Je(nt),s=t.memoizedState,s===null)return Mt(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)Qs(s,!1);else{if(gt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=_l(e),a!==null){for(t.flags|=128,Qs(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Xe(nt,nt.current&1|2),t.child}e=e.sibling}s.tail!==null&&ct()>Cs&&(t.flags|=128,n=!0,Qs(s,!1),t.lanes=4194304)}else{if(!n)if(e=_l(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Qs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!et)return Mt(t),null}else 2*ct()-s.renderingStartTime>Cs&&r!==1073741824&&(t.flags|=128,n=!0,Qs(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ct(),t.sibling=null,r=nt.current,Xe(nt,n?r&1|2:r&1),t):(Mt(t),null);case 22:case 23:return wf(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?dr&1073741824&&(Mt(t),t.subtreeFlags&6&&(t.flags|=8192)):Mt(t),null;case 24:return null;case 25:return null}throw Error(te(156,t.tag))}function Y2(e,t){switch(Z0(t),t.tag){case 1:return ar(t.type)&&pl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ks(),Je(sr),Je(zt),cf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return lf(t),null;case 13:if(Je(nt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(te(340));Es()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Je(nt),null;case 4:return ks(),null;case 10:return nf(t.type._context),null;case 22:case 23:return wf(),null;case 24:return null;default:return null}}var Ao=!1,Bt=!1,J2=typeof WeakSet=="function"?WeakSet:Set,me=null;function os(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){at(e,t,n)}else r.current=null}function a0(e,t,r){try{r()}catch(n){at(e,t,n)}}var oh=!1;function Q2(e,t){if(Wu=ul,e=Wm(),J0(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,c=0,u=0,d=e,h=null;t:for(;;){for(var p;d!==r||i!==0&&d.nodeType!==3||(o=a+i),d!==s||n!==0&&d.nodeType!==3||(l=a+n),d.nodeType===3&&(a+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===e)break t;if(h===r&&++c===i&&(o=a),h===s&&++u===n&&(l=a),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Hu={focusedElem:e,selectionRange:r},ul=!1,me=t;me!==null;)if(t=me,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,me=e;else for(;me!==null;){t=me;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var m=v.memoizedProps,x=v.memoizedState,w=t.stateNode,y=w.getSnapshotBeforeUpdate(t.elementType===t.type?m:Ur(t.type,m),x);w.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(k){at(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,me=e;break}me=t.return}return v=oh,oh=!1,v}function pa(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&a0(t,r,s)}i=i.next}while(i!==n)}}function oc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function o0(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function B1(e){var t=e.alternate;t!==null&&(e.alternate=null,B1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[en],delete t[Ra],delete t[Ku],delete t[D2],delete t[I2])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function U1(e){return e.tag===5||e.tag===3||e.tag===4}function lh(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||U1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function l0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=hl));else if(n!==4&&(e=e.child,e!==null))for(l0(e,t,r),e=e.sibling;e!==null;)l0(e,t,r),e=e.sibling}function c0(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(c0(e,t,r),e=e.sibling;e!==null;)c0(e,t,r),e=e.sibling}var Ct=null,$r=!1;function bn(e,t,r){for(r=r.child;r!==null;)$1(e,t,r),r=r.sibling}function $1(e,t,r){if(tn&&typeof tn.onCommitFiberUnmount=="function")try{tn.onCommitFiberUnmount(Zl,r)}catch{}switch(r.tag){case 5:Bt||os(r,t);case 6:var n=Ct,i=$r;Ct=null,bn(e,t,r),Ct=n,$r=i,Ct!==null&&($r?(e=Ct,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Ct.removeChild(r.stateNode));break;case 18:Ct!==null&&($r?(e=Ct,r=r.stateNode,e.nodeType===8?Xc(e.parentNode,r):e.nodeType===1&&Xc(e,r),Oa(e)):Xc(Ct,r.stateNode));break;case 4:n=Ct,i=$r,Ct=r.stateNode.containerInfo,$r=!0,bn(e,t,r),Ct=n,$r=i;break;case 0:case 11:case 14:case 15:if(!Bt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&a0(r,t,a),i=i.next}while(i!==n)}bn(e,t,r);break;case 1:if(!Bt&&(os(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){at(r,t,o)}bn(e,t,r);break;case 21:bn(e,t,r);break;case 22:r.mode&1?(Bt=(n=Bt)||r.memoizedState!==null,bn(e,t,r),Bt=n):bn(e,t,r);break;default:bn(e,t,r)}}function ch(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new J2),t.forEach(function(n){var i=ow.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Rr(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:Ct=o.stateNode,$r=!1;break e;case 3:Ct=o.stateNode.containerInfo,$r=!0;break e;case 4:Ct=o.stateNode.containerInfo,$r=!0;break e}o=o.return}if(Ct===null)throw Error(te(160));$1(s,a,i),Ct=null,$r=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){at(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)z1(t,e),t=t.sibling}function z1(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Rr(t,e),Yr(e),n&4){try{pa(3,e,e.return),oc(3,e)}catch(m){at(e,e.return,m)}try{pa(5,e,e.return)}catch(m){at(e,e.return,m)}}break;case 1:Rr(t,e),Yr(e),n&512&&r!==null&&os(r,r.return);break;case 5:if(Rr(t,e),Yr(e),n&512&&r!==null&&os(r,r.return),e.flags&32){var i=e.stateNode;try{Ca(i,"")}catch(m){at(e,e.return,m)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&um(i,s),Pu(o,a);var c=Pu(o,s);for(a=0;a<l.length;a+=2){var u=l[a],d=l[a+1];u==="style"?mm(i,d):u==="dangerouslySetInnerHTML"?hm(i,d):u==="children"?Ca(i,d):M0(i,u,d,c)}switch(o){case"input":bu(i,s);break;case"textarea":fm(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?us(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?us(i,!!s.multiple,s.defaultValue,!0):us(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ra]=s}catch(m){at(e,e.return,m)}}break;case 6:if(Rr(t,e),Yr(e),n&4){if(e.stateNode===null)throw Error(te(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(m){at(e,e.return,m)}}break;case 3:if(Rr(t,e),Yr(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Oa(t.containerInfo)}catch(m){at(e,e.return,m)}break;case 4:Rr(t,e),Yr(e);break;case 13:Rr(t,e),Yr(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(vf=ct())),n&4&&ch(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(Bt=(c=Bt)||u,Rr(t,e),Bt=c):Rr(t,e),Yr(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(me=e,u=e.child;u!==null;){for(d=me=u;me!==null;){switch(h=me,p=h.child,h.tag){case 0:case 11:case 14:case 15:pa(4,h,h.return);break;case 1:os(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(m){at(n,r,m)}}break;case 5:os(h,h.return);break;case 22:if(h.memoizedState!==null){fh(d);continue}}p!==null?(p.return=h,me=p):fh(d)}u=u.sibling}e:for(u=null,d=e;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=pm("display",a))}catch(m){at(e,e.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){at(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Rr(t,e),Yr(e),n&4&&ch(e);break;case 21:break;default:Rr(t,e),Yr(e)}}function Yr(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(U1(r)){var n=r;break e}r=r.return}throw Error(te(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Ca(i,""),n.flags&=-33);var s=lh(e);c0(e,s,i);break;case 3:case 4:var a=n.stateNode.containerInfo,o=lh(e);l0(e,o,a);break;default:throw Error(te(161))}}catch(l){at(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Z2(e,t,r){me=e,W1(e)}function W1(e,t,r){for(var n=(e.mode&1)!==0;me!==null;){var i=me,s=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||Ao;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Bt;o=Ao;var c=Bt;if(Ao=a,(Bt=l)&&!c)for(me=i;me!==null;)a=me,l=a.child,a.tag===22&&a.memoizedState!==null?dh(i):l!==null?(l.return=a,me=l):dh(i);for(;s!==null;)me=s,W1(s),s=s.sibling;me=i,Ao=o,Bt=c}uh(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,me=s):uh(e)}}function uh(e){for(;me!==null;){var t=me;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Bt||oc(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Bt)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Ur(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&qd(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}qd(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Oa(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}Bt||t.flags&512&&o0(t)}catch(h){at(t,t.return,h)}}if(t===e){me=null;break}if(r=t.sibling,r!==null){r.return=t.return,me=r;break}me=t.return}}function fh(e){for(;me!==null;){var t=me;if(t===e){me=null;break}var r=t.sibling;if(r!==null){r.return=t.return,me=r;break}me=t.return}}function dh(e){for(;me!==null;){var t=me;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{oc(4,t)}catch(l){at(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){at(t,i,l)}}var s=t.return;try{o0(t)}catch(l){at(t,s,l)}break;case 5:var a=t.return;try{o0(t)}catch(l){at(t,a,l)}}}catch(l){at(t,t.return,l)}if(t===e){me=null;break}var o=t.sibling;if(o!==null){o.return=t.return,me=o;break}me=t.return}}var ew=Math.ceil,Tl=Nn.ReactCurrentDispatcher,xf=Nn.ReactCurrentOwner,Ar=Nn.ReactCurrentBatchConfig,Pe=0,Et=null,dt=null,jt=0,dr=0,ls=ni(0),gt=0,za=null,Ci=0,lc=0,gf=0,ma=null,rr=null,vf=0,Cs=1/0,cn=null,kl=!1,u0=null,Kn=null,Fo=!1,Mn=null,Nl=0,xa=0,f0=null,rl=-1,nl=0;function Yt(){return Pe&6?ct():rl!==-1?rl:rl=ct()}function qn(e){return e.mode&1?Pe&2&&jt!==0?jt&-jt:L2.transition!==null?(nl===0&&(nl=Cm()),nl):(e=He,e!==0||(e=window.event,e=e===void 0?16:Dm(e.type)),e):1}function Kr(e,t,r,n){if(50<xa)throw xa=0,f0=null,Error(te(185));eo(e,r,n),(!(Pe&2)||e!==Et)&&(e===Et&&(!(Pe&2)&&(lc|=r),gt===4&&In(e,jt)),or(e,n),r===1&&Pe===0&&!(t.mode&1)&&(Cs=ct()+500,ic&&ii()))}function or(e,t){var r=e.callbackNode;Ly(e,t);var n=cl(e,e===Et?jt:0);if(n===0)r!==null&&_d(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&_d(r),t===1)e.tag===0?R2(hh.bind(null,e)):Zm(hh.bind(null,e)),j2(function(){!(Pe&6)&&ii()}),r=null;else{switch(bm(n)){case 1:r=W0;break;case 4:r=km;break;case 16:r=ll;break;case 536870912:r=Nm;break;default:r=ll}r=J1(r,H1.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function H1(e,t){if(rl=-1,nl=0,Pe&6)throw Error(te(327));var r=e.callbackNode;if(ms()&&e.callbackNode!==r)return null;var n=cl(e,e===Et?jt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Cl(e,n);else{t=n;var i=Pe;Pe|=2;var s=G1();(Et!==e||jt!==t)&&(cn=null,Cs=ct()+500,_i(e,t));do try{nw();break}catch(o){V1(e,o)}while(!0);rf(),Tl.current=s,Pe=i,dt!==null?t=0:(Et=null,jt=0,t=gt)}if(t!==0){if(t===2&&(i=Mu(e),i!==0&&(n=i,t=d0(e,i))),t===1)throw r=za,_i(e,0),In(e,n),or(e,ct()),r;if(t===6)In(e,n);else{if(i=e.current.alternate,!(n&30)&&!tw(i)&&(t=Cl(e,n),t===2&&(s=Mu(e),s!==0&&(n=s,t=d0(e,s))),t===1))throw r=za,_i(e,0),In(e,n),or(e,ct()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(te(345));case 2:pi(e,rr,cn);break;case 3:if(In(e,n),(n&130023424)===n&&(t=vf+500-ct(),10<t)){if(cl(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Yt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Gu(pi.bind(null,e,rr,cn),t);break}pi(e,rr,cn);break;case 4:if(In(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-Gr(n);s=1<<a,a=t[a],a>i&&(i=a),n&=~s}if(n=i,n=ct()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ew(n/1960))-n,10<n){e.timeoutHandle=Gu(pi.bind(null,e,rr,cn),n);break}pi(e,rr,cn);break;case 5:pi(e,rr,cn);break;default:throw Error(te(329))}}}return or(e,ct()),e.callbackNode===r?H1.bind(null,e):null}function d0(e,t){var r=ma;return e.current.memoizedState.isDehydrated&&(_i(e,t).flags|=256),e=Cl(e,t),e!==2&&(t=rr,rr=r,t!==null&&h0(t)),e}function h0(e){rr===null?rr=e:rr.push.apply(rr,e)}function tw(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!Xr(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function In(e,t){for(t&=~gf,t&=~lc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Gr(t),n=1<<r;e[r]=-1,t&=~n}}function hh(e){if(Pe&6)throw Error(te(327));ms();var t=cl(e,0);if(!(t&1))return or(e,ct()),null;var r=Cl(e,t);if(e.tag!==0&&r===2){var n=Mu(e);n!==0&&(t=n,r=d0(e,n))}if(r===1)throw r=za,_i(e,0),In(e,t),or(e,ct()),r;if(r===6)throw Error(te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,pi(e,rr,cn),or(e,ct()),null}function yf(e,t){var r=Pe;Pe|=1;try{return e(t)}finally{Pe=r,Pe===0&&(Cs=ct()+500,ic&&ii())}}function bi(e){Mn!==null&&Mn.tag===0&&!(Pe&6)&&ms();var t=Pe;Pe|=1;var r=Ar.transition,n=He;try{if(Ar.transition=null,He=1,e)return e()}finally{He=n,Ar.transition=r,Pe=t,!(Pe&6)&&ii()}}function wf(){dr=ls.current,Je(ls)}function _i(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,O2(r)),dt!==null)for(r=dt.return;r!==null;){var n=r;switch(Z0(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&pl();break;case 3:ks(),Je(sr),Je(zt),cf();break;case 5:lf(n);break;case 4:ks();break;case 13:Je(nt);break;case 19:Je(nt);break;case 10:nf(n.type._context);break;case 22:case 23:wf()}r=r.return}if(Et=e,dt=e=Xn(e.current,null),jt=dr=t,gt=0,za=null,gf=lc=Ci=0,rr=ma=null,yi!==null){for(t=0;t<yi.length;t++)if(r=yi[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var a=s.next;s.next=i,n.next=a}r.pending=n}yi=null}return e}function V1(e,t){do{var r=dt;try{if(rf(),Zo.current=El,Sl){for(var n=it.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}Sl=!1}if(Ni=0,yt=xt=it=null,ha=!1,Ba=0,xf.current=null,r===null||r.return===null){gt=1,za=t,dt=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=jt,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=eh(a);if(p!==null){p.flags&=-257,th(p,a,o,s,t),p.mode&1&&Zd(s,c,t),t=p,l=c;var v=t.updateQueue;if(v===null){var m=new Set;m.add(l),t.updateQueue=m}else v.add(l);break e}else{if(!(t&1)){Zd(s,c,t),_f();break e}l=Error(te(426))}}else if(et&&o.mode&1){var x=eh(a);if(x!==null){!(x.flags&65536)&&(x.flags|=256),th(x,a,o,s,t),ef(Ns(l,o));break e}}s=l=Ns(l,o),gt!==4&&(gt=2),ma===null?ma=[s]:ma.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var w=b1(s,l,t);Kd(s,w);break e;case 1:o=l;var y=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Kn===null||!Kn.has(g)))){s.flags|=65536,t&=-t,s.lanes|=t;var k=A1(s,o,t);Kd(s,k);break e}}s=s.return}while(s!==null)}q1(r)}catch(j){t=j,dt===r&&r!==null&&(dt=r=r.return);continue}break}while(!0)}function G1(){var e=Tl.current;return Tl.current=El,e===null?El:e}function _f(){(gt===0||gt===3||gt===2)&&(gt=4),Et===null||!(Ci&268435455)&&!(lc&268435455)||In(Et,jt)}function Cl(e,t){var r=Pe;Pe|=2;var n=G1();(Et!==e||jt!==t)&&(cn=null,_i(e,t));do try{rw();break}catch(i){V1(e,i)}while(!0);if(rf(),Pe=r,Tl.current=n,dt!==null)throw Error(te(261));return Et=null,jt=0,gt}function rw(){for(;dt!==null;)K1(dt)}function nw(){for(;dt!==null&&!by();)K1(dt)}function K1(e){var t=Y1(e.alternate,e,dr);e.memoizedProps=e.pendingProps,t===null?q1(e):dt=t,xf.current=null}function q1(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Y2(r,t),r!==null){r.flags&=32767,dt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{gt=6,dt=null;return}}else if(r=X2(r,t,dr),r!==null){dt=r;return}if(t=t.sibling,t!==null){dt=t;return}dt=t=e}while(t!==null);gt===0&&(gt=5)}function pi(e,t,r){var n=He,i=Ar.transition;try{Ar.transition=null,He=1,iw(e,t,r,n)}finally{Ar.transition=i,He=n}return null}function iw(e,t,r,n){do ms();while(Mn!==null);if(Pe&6)throw Error(te(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(te(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(My(e,s),e===Et&&(dt=Et=null,jt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Fo||(Fo=!0,J1(ll,function(){return ms(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Ar.transition,Ar.transition=null;var a=He;He=1;var o=Pe;Pe|=4,xf.current=null,Q2(e,r),z1(r,e),T2(Hu),ul=!!Wu,Hu=Wu=null,e.current=r,Z2(r),Ay(),Pe=o,He=a,Ar.transition=s}else e.current=r;if(Fo&&(Fo=!1,Mn=e,Nl=i),s=e.pendingLanes,s===0&&(Kn=null),jy(r.stateNode),or(e,ct()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(kl)throw kl=!1,e=u0,u0=null,e;return Nl&1&&e.tag!==0&&ms(),s=e.pendingLanes,s&1?e===f0?xa++:(xa=0,f0=e):xa=0,ii(),null}function ms(){if(Mn!==null){var e=bm(Nl),t=Ar.transition,r=He;try{if(Ar.transition=null,He=16>e?16:e,Mn===null)var n=!1;else{if(e=Mn,Mn=null,Nl=0,Pe&6)throw Error(te(331));var i=Pe;for(Pe|=4,me=e.current;me!==null;){var s=me,a=s.child;if(me.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(me=c;me!==null;){var u=me;switch(u.tag){case 0:case 11:case 15:pa(8,u,s)}var d=u.child;if(d!==null)d.return=u,me=d;else for(;me!==null;){u=me;var h=u.sibling,p=u.return;if(B1(u),u===c){me=null;break}if(h!==null){h.return=p,me=h;break}me=p}}}var v=s.alternate;if(v!==null){var m=v.child;if(m!==null){v.child=null;do{var x=m.sibling;m.sibling=null,m=x}while(m!==null)}}me=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,me=a;else e:for(;me!==null;){if(s=me,s.flags&2048)switch(s.tag){case 0:case 11:case 15:pa(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,me=w;break e}me=s.return}}var y=e.current;for(me=y;me!==null;){a=me;var g=a.child;if(a.subtreeFlags&2064&&g!==null)g.return=a,me=g;else e:for(a=y;me!==null;){if(o=me,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:oc(9,o)}}catch(j){at(o,o.return,j)}if(o===a){me=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,me=k;break e}me=o.return}}if(Pe=i,ii(),tn&&typeof tn.onPostCommitFiberRoot=="function")try{tn.onPostCommitFiberRoot(Zl,e)}catch{}n=!0}return n}finally{He=r,Ar.transition=t}}return!1}function ph(e,t,r){t=Ns(r,t),t=b1(e,t,1),e=Gn(e,t,1),t=Yt(),e!==null&&(eo(e,1,t),or(e,t))}function at(e,t,r){if(e.tag===3)ph(e,e,r);else for(;t!==null;){if(t.tag===3){ph(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Kn===null||!Kn.has(n))){e=Ns(r,e),e=A1(t,e,1),t=Gn(t,e,1),e=Yt(),t!==null&&(eo(t,1,e),or(t,e));break}}t=t.return}}function sw(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Yt(),e.pingedLanes|=e.suspendedLanes&r,Et===e&&(jt&r)===r&&(gt===4||gt===3&&(jt&130023424)===jt&&500>ct()-vf?_i(e,0):gf|=r),or(e,t)}function X1(e,t){t===0&&(e.mode&1?(t=wo,wo<<=1,!(wo&130023424)&&(wo=4194304)):t=1);var r=Yt();e=_n(e,t),e!==null&&(eo(e,t,r),or(e,r))}function aw(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),X1(e,r)}function ow(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(te(314))}n!==null&&n.delete(t),X1(e,r)}var Y1;Y1=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||sr.current)ir=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ir=!1,q2(e,t,r);ir=!!(e.flags&131072)}else ir=!1,et&&t.flags&1048576&&e1(t,gl,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;tl(e,t),e=t.pendingProps;var i=Ss(t,zt.current);ps(t,r),i=ff(null,t,n,e,i,r);var s=df();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ar(n)?(s=!0,ml(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,af(t),i.updater=ac,t.stateNode=i,i._reactInternals=t,Zu(t,n,e,r),t=r0(null,t,n,!0,s,r)):(t.tag=0,et&&s&&Q0(t),Kt(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(tl(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=cw(n),e=Ur(n,e),i){case 0:t=t0(null,t,n,e,r);break e;case 1:t=ih(null,t,n,e,r);break e;case 11:t=rh(null,t,n,e,r);break e;case 14:t=nh(null,t,n,Ur(n.type,e),r);break e}throw Error(te(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ur(n,i),t0(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ur(n,i),ih(e,t,n,i,r);case 3:e:{if(P1(t),e===null)throw Error(te(387));n=t.pendingProps,s=t.memoizedState,i=s.element,a1(e,t),wl(t,n,null,r);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Ns(Error(te(423)),t),t=sh(e,t,n,r,i);break e}else if(n!==i){i=Ns(Error(te(424)),t),t=sh(e,t,n,r,i);break e}else for(gr=Vn(t.stateNode.containerInfo.firstChild),vr=t,et=!0,Wr=null,r=i1(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Es(),n===i){t=Sn(e,t,r);break e}Kt(e,t,n,r)}t=t.child}return t;case 5:return o1(t),e===null&&Yu(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,Vu(n,i)?a=null:s!==null&&Vu(n,s)&&(t.flags|=32),j1(e,t),Kt(e,t,a,r),t.child;case 6:return e===null&&Yu(t),null;case 13:return D1(e,t,r);case 4:return of(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Ts(t,null,n,r):Kt(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ur(n,i),rh(e,t,n,i,r);case 7:return Kt(e,t,t.pendingProps,r),t.child;case 8:return Kt(e,t,t.pendingProps.children,r),t.child;case 12:return Kt(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,Xe(vl,n._currentValue),n._currentValue=a,s!==null)if(Xr(s.value,a)){if(s.children===i.children&&!sr.current){t=Sn(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=pn(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),Ju(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(te(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),Ju(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Kt(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,ps(t,r),i=Fr(i),n=n(i),t.flags|=1,Kt(e,t,n,r),t.child;case 14:return n=t.type,i=Ur(n,t.pendingProps),i=Ur(n.type,i),nh(e,t,n,i,r);case 15:return F1(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Ur(n,i),tl(e,t),t.tag=1,ar(n)?(e=!0,ml(t)):e=!1,ps(t,r),C1(t,n,i),Zu(t,n,i,r),r0(null,t,n,!0,e,r);case 19:return I1(e,t,r);case 22:return O1(e,t,r)}throw Error(te(156,t.tag))};function J1(e,t){return Tm(e,t)}function lw(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function br(e,t,r,n){return new lw(e,t,r,n)}function Sf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function cw(e){if(typeof e=="function")return Sf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===U0)return 11;if(e===$0)return 14}return 2}function Xn(e,t){var r=e.alternate;return r===null?(r=br(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function il(e,t,r,n,i,s){var a=2;if(n=e,typeof e=="function")Sf(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Qi:return Si(r.children,i,s,t);case B0:a=8,i|=8;break;case Eu:return e=br(12,r,t,i|2),e.elementType=Eu,e.lanes=s,e;case Tu:return e=br(13,r,t,i),e.elementType=Tu,e.lanes=s,e;case ku:return e=br(19,r,t,i),e.elementType=ku,e.lanes=s,e;case om:return cc(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case sm:a=10;break e;case am:a=9;break e;case U0:a=11;break e;case $0:a=14;break e;case On:a=16,n=null;break e}throw Error(te(130,e==null?e:typeof e,""))}return t=br(a,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function Si(e,t,r,n){return e=br(7,e,n,t),e.lanes=r,e}function cc(e,t,r,n){return e=br(22,e,n,t),e.elementType=om,e.lanes=r,e.stateNode={isHidden:!1},e}function nu(e,t,r){return e=br(6,e,null,t),e.lanes=r,e}function iu(e,t,r){return t=br(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function uw(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Mc(0),this.expirationTimes=Mc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mc(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ef(e,t,r,n,i,s,a,o,l){return e=new uw(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=br(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},af(s),e}function fw(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ji,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Q1(e){if(!e)return Qn;e=e._reactInternals;e:{if(Pi(e)!==e||e.tag!==1)throw Error(te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ar(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(te(171))}if(e.tag===1){var r=e.type;if(ar(r))return Qm(e,r,t)}return t}function Z1(e,t,r,n,i,s,a,o,l){return e=Ef(r,n,!0,e,i,s,a,o,l),e.context=Q1(null),r=e.current,n=Yt(),i=qn(r),s=pn(n,i),s.callback=t??null,Gn(r,s,i),e.current.lanes=i,eo(e,i,n),or(e,n),e}function uc(e,t,r,n){var i=t.current,s=Yt(),a=qn(i);return r=Q1(r),t.context===null?t.context=r:t.pendingContext=r,t=pn(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Gn(i,t,a),e!==null&&(Kr(e,i,a,s),Qo(e,i,a)),a}function bl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function mh(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Tf(e,t){mh(e,t),(e=e.alternate)&&mh(e,t)}function dw(){return null}var ex=typeof reportError=="function"?reportError:function(e){console.error(e)};function kf(e){this._internalRoot=e}fc.prototype.render=kf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(te(409));uc(e,t,null,null)};fc.prototype.unmount=kf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;bi(function(){uc(null,e,null,null)}),t[wn]=null}};function fc(e){this._internalRoot=e}fc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Om();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Dn.length&&t!==0&&t<Dn[r].priority;r++);Dn.splice(r,0,e),r===0&&Pm(e)}};function Nf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function dc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function xh(){}function hw(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var c=bl(a);s.call(c)}}var a=Z1(t,n,e,0,null,!1,!1,"",xh);return e._reactRootContainer=a,e[wn]=a.current,Da(e.nodeType===8?e.parentNode:e),bi(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var c=bl(l);o.call(c)}}var l=Ef(e,0,!1,null,null,!1,!1,"",xh);return e._reactRootContainer=l,e[wn]=l.current,Da(e.nodeType===8?e.parentNode:e),bi(function(){uc(t,l,r,n)}),l}function hc(e,t,r,n,i){var s=r._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=bl(a);o.call(l)}}uc(t,a,e,i)}else a=hw(r,t,e,i,n);return bl(a)}Am=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ia(t.pendingLanes);r!==0&&(H0(t,r|1),or(t,ct()),!(Pe&6)&&(Cs=ct()+500,ii()))}break;case 13:bi(function(){var n=_n(e,1);if(n!==null){var i=Yt();Kr(n,e,1,i)}}),Tf(e,1)}};V0=function(e){if(e.tag===13){var t=_n(e,134217728);if(t!==null){var r=Yt();Kr(t,e,134217728,r)}Tf(e,134217728)}};Fm=function(e){if(e.tag===13){var t=qn(e),r=_n(e,t);if(r!==null){var n=Yt();Kr(r,e,t,n)}Tf(e,t)}};Om=function(){return He};jm=function(e,t){var r=He;try{return He=e,t()}finally{He=r}};Iu=function(e,t,r){switch(t){case"input":if(bu(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=nc(n);if(!i)throw Error(te(90));cm(n),bu(n,i)}}}break;case"textarea":fm(e,r);break;case"select":t=r.value,t!=null&&us(e,!!r.multiple,t,!1)}};vm=yf;ym=bi;var pw={usingClientEntryPoint:!1,Events:[ro,rs,nc,xm,gm,yf]},Zs={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mw={bundleType:Zs.bundleType,version:Zs.version,rendererPackageName:Zs.rendererPackageName,rendererConfig:Zs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Nn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Sm(e),e===null?null:e.stateNode},findFiberByHostInstance:Zs.findFiberByHostInstance||dw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oo.isDisabled&&Oo.supportsFiber)try{Zl=Oo.inject(mw),tn=Oo}catch{}}_r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pw;_r.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Nf(t))throw Error(te(200));return fw(e,t,null,r)};_r.createRoot=function(e,t){if(!Nf(e))throw Error(te(299));var r=!1,n="",i=ex;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Ef(e,1,!1,null,null,r,!1,n,i),e[wn]=t.current,Da(e.nodeType===8?e.parentNode:e),new kf(t)};_r.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(te(188)):(e=Object.keys(e).join(","),Error(te(268,e)));return e=Sm(t),e=e===null?null:e.stateNode,e};_r.flushSync=function(e){return bi(e)};_r.hydrate=function(e,t,r){if(!dc(t))throw Error(te(200));return hc(null,e,t,!0,r)};_r.hydrateRoot=function(e,t,r){if(!Nf(e))throw Error(te(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",a=ex;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=Z1(t,null,e,1,r??null,i,!1,s,a),e[wn]=t.current,Da(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new fc(t)};_r.render=function(e,t,r){if(!dc(t))throw Error(te(200));return hc(null,e,t,!1,r)};_r.unmountComponentAtNode=function(e){if(!dc(e))throw Error(te(40));return e._reactRootContainer?(bi(function(){hc(null,null,e,!1,function(){e._reactRootContainer=null,e[wn]=null})}),!0):!1};_r.unstable_batchedUpdates=yf;_r.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!dc(r))throw Error(te(200));if(e==null||e._reactInternals===void 0)throw Error(te(38));return hc(e,t,r,!1,n)};_r.version="18.3.1-next-f1338f8080-20240426";function tx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tx)}catch(e){console.error(e)}}tx(),tm.exports=_r;var xw=tm.exports,rx,gh=xw;rx=gh.createRoot,gh.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wa(){return Wa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wa.apply(this,arguments)}var Bn;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Bn||(Bn={}));const vh="popstate";function gw(e){e===void 0&&(e={});function t(n,i){let{pathname:s,search:a,hash:o}=n.location;return p0("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:Al(i)}return yw(t,r,null,e)}function ut(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function nx(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function vw(){return Math.random().toString(36).substr(2,8)}function yh(e,t){return{usr:e.state,key:e.key,idx:t}}function p0(e,t,r,n){return r===void 0&&(r=null),Wa({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Ds(t):t,{state:r,key:t&&t.key||n||vw()})}function Al(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ds(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function yw(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,a=i.history,o=Bn.Pop,l=null,c=u();c==null&&(c=0,a.replaceState(Wa({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function d(){o=Bn.Pop;let x=u(),w=x==null?null:x-c;c=x,l&&l({action:o,location:m.location,delta:w})}function h(x,w){o=Bn.Push;let y=p0(m.location,x,w);c=u()+1;let g=yh(y,c),k=m.createHref(y);try{a.pushState(g,"",k)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;i.location.assign(k)}s&&l&&l({action:o,location:m.location,delta:1})}function p(x,w){o=Bn.Replace;let y=p0(m.location,x,w);c=u();let g=yh(y,c),k=m.createHref(y);a.replaceState(g,"",k),s&&l&&l({action:o,location:m.location,delta:0})}function v(x){let w=i.location.origin!=="null"?i.location.origin:i.location.href,y=typeof x=="string"?x:Al(x);return y=y.replace(/ $/,"%20"),ut(w,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,w)}let m={get action(){return o},get location(){return e(i,a)},listen(x){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(vh,d),l=x,()=>{i.removeEventListener(vh,d),l=null}},createHref(x){return t(i,x)},createURL:v,encodeLocation(x){let w=v(x);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:h,replace:p,go(x){return a.go(x)}};return m}var wh;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(wh||(wh={}));function ww(e,t,r){return r===void 0&&(r="/"),_w(e,t,r)}function _w(e,t,r,n){let i=typeof t=="string"?Ds(t):t,s=Cf(i.pathname||"/",r);if(s==null)return null;let a=ix(e);Sw(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let c=Dw(s);o=Ow(a[l],c)}return o}function ix(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(ut(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Yn([n,l.relativePath]),u=r.concat(l);s.children&&s.children.length>0&&(ut(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),ix(s.children,t,u,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:Aw(c,s.index),routesMeta:u})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of sx(s.path))i(s,a,l)}),t}function sx(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let a=sx(n.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function Sw(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Fw(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Ew=/^:[\w-]+$/,Tw=3,kw=2,Nw=1,Cw=10,bw=-2,_h=e=>e==="*";function Aw(e,t){let r=e.split("/"),n=r.length;return r.some(_h)&&(n+=bw),t&&(n+=kw),r.filter(i=>!_h(i)).reduce((i,s)=>i+(Ew.test(s)?Tw:s===""?Nw:Cw),n)}function Fw(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function Ow(e,t,r){let{routesMeta:n}=e,i={},s="/",a=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,u=s==="/"?t:t.slice(s.length)||"/",d=jw({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},u),h=l.route;if(!d)return null;Object.assign(i,d.params),a.push({params:i,pathname:Yn([s,d.pathname]),pathnameBase:Mw(Yn([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=Yn([s,d.pathnameBase]))}return a}function jw(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Pw(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:n.reduce((c,u,d)=>{let{paramName:h,isOptional:p}=u;if(h==="*"){let m=o[d]||"";a=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const v=o[d];return p&&!v?c[h]=void 0:c[h]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:a,pattern:e}}function Pw(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),nx(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function Dw(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return nx(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Cf(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Iw(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?Ds(e):e;return{pathname:r?r.startsWith("/")?r:Rw(r,t):t,search:Bw(n),hash:Uw(i)}}function Rw(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function su(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Lw(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function bf(e,t){let r=Lw(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Af(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=Ds(e):(i=Wa({},e),ut(!i.pathname||!i.pathname.includes("?"),su("?","pathname","search",i)),ut(!i.pathname||!i.pathname.includes("#"),su("#","pathname","hash",i)),ut(!i.search||!i.search.includes("#"),su("#","search","hash",i)));let s=e===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=r;else{let d=t.length-1;if(!n&&a.startsWith("..")){let h=a.split("/");for(;h[0]==="..";)h.shift(),d-=1;i.pathname=h.join("/")}o=d>=0?t[d]:"/"}let l=Iw(i,o),c=a&&a!=="/"&&a.endsWith("/"),u=(s||a===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||u)&&(l.pathname+="/"),l}const Yn=e=>e.join("/").replace(/\/\/+/g,"/"),Mw=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Bw=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Uw=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function $w(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const ax=["post","put","patch","delete"];new Set(ax);const zw=["get",...ax];new Set(zw);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ha(){return Ha=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ha.apply(this,arguments)}const Ff=H.createContext(null),Ww=H.createContext(null),si=H.createContext(null),pc=H.createContext(null),ai=H.createContext({outlet:null,matches:[],isDataRoute:!1}),ox=H.createContext(null);function Hw(e,t){let{relative:r}=t===void 0?{}:t;Is()||ut(!1);let{basename:n,navigator:i}=H.useContext(si),{hash:s,pathname:a,search:o}=ux(e,{relative:r}),l=a;return n!=="/"&&(l=a==="/"?n:Yn([n,a])),i.createHref({pathname:l,search:o,hash:s})}function Is(){return H.useContext(pc)!=null}function Rs(){return Is()||ut(!1),H.useContext(pc).location}function lx(e){H.useContext(si).static||H.useLayoutEffect(e)}function cx(){let{isDataRoute:e}=H.useContext(ai);return e?n_():Vw()}function Vw(){Is()||ut(!1);let e=H.useContext(Ff),{basename:t,future:r,navigator:n}=H.useContext(si),{matches:i}=H.useContext(ai),{pathname:s}=Rs(),a=JSON.stringify(bf(i,r.v7_relativeSplatPath)),o=H.useRef(!1);return lx(()=>{o.current=!0}),H.useCallback(function(c,u){if(u===void 0&&(u={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=Af(c,JSON.parse(a),s,u.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Yn([t,d.pathname])),(u.replace?n.replace:n.push)(d,u.state,u)},[t,n,a,s,e])}function ux(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=H.useContext(si),{matches:i}=H.useContext(ai),{pathname:s}=Rs(),a=JSON.stringify(bf(i,n.v7_relativeSplatPath));return H.useMemo(()=>Af(e,JSON.parse(a),s,r==="path"),[e,a,s,r])}function Gw(e,t){return Kw(e,t)}function Kw(e,t,r,n){Is()||ut(!1);let{navigator:i}=H.useContext(si),{matches:s}=H.useContext(ai),a=s[s.length-1],o=a?a.params:{};a&&a.pathname;let l=a?a.pathnameBase:"/";a&&a.route;let c=Rs(),u;if(t){var d;let x=typeof t=="string"?Ds(t):t;l==="/"||(d=x.pathname)!=null&&d.startsWith(l)||ut(!1),u=x}else u=c;let h=u.pathname||"/",p=h;if(l!=="/"){let x=l.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(x.length).join("/")}let v=ww(e,{pathname:p}),m=Qw(v&&v.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:Yn([l,i.encodeLocation?i.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?l:Yn([l,i.encodeLocation?i.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),s,r,n);return t&&m?H.createElement(pc.Provider,{value:{location:Ha({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Bn.Pop}},m):m}function qw(){let e=r_(),t=$w(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return H.createElement(H.Fragment,null,H.createElement("h2",null,"Unexpected Application Error!"),H.createElement("h3",{style:{fontStyle:"italic"}},t),r?H.createElement("pre",{style:i},r):null,null)}const Xw=H.createElement(qw,null);class Yw extends H.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?H.createElement(ai.Provider,{value:this.props.routeContext},H.createElement(ox.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Jw(e){let{routeContext:t,match:r,children:n}=e,i=H.useContext(Ff);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),H.createElement(ai.Provider,{value:t},n)}function Qw(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let a=e,o=(i=r)==null?void 0:i.errors;if(o!=null){let u=a.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);u>=0||ut(!1),a=a.slice(0,Math.min(a.length,u+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<a.length;u++){let d=a[u];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=u),d.route.id){let{loaderData:h,errors:p}=r,v=d.route.loader&&h[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||v){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}return a.reduceRight((u,d,h)=>{let p,v=!1,m=null,x=null;r&&(p=o&&d.route.id?o[d.route.id]:void 0,m=d.route.errorElement||Xw,l&&(c<0&&h===0?(i_("route-fallback"),v=!0,x=null):c===h&&(v=!0,x=d.route.hydrateFallbackElement||null)));let w=t.concat(a.slice(0,h+1)),y=()=>{let g;return p?g=m:v?g=x:d.route.Component?g=H.createElement(d.route.Component,null):d.route.element?g=d.route.element:g=u,H.createElement(Jw,{match:d,routeContext:{outlet:u,matches:w,isDataRoute:r!=null},children:g})};return r&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?H.createElement(Yw,{location:r.location,revalidation:r.revalidation,component:m,error:p,children:y(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):y()},null)}var fx=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(fx||{}),dx=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(dx||{});function Zw(e){let t=H.useContext(Ff);return t||ut(!1),t}function e_(e){let t=H.useContext(Ww);return t||ut(!1),t}function t_(e){let t=H.useContext(ai);return t||ut(!1),t}function hx(e){let t=t_(),r=t.matches[t.matches.length-1];return r.route.id||ut(!1),r.route.id}function r_(){var e;let t=H.useContext(ox),r=e_(),n=hx();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function n_(){let{router:e}=Zw(fx.UseNavigateStable),t=hx(dx.UseNavigateStable),r=H.useRef(!1);return lx(()=>{r.current=!0}),H.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,Ha({fromRouteId:t},s)))},[e,t])}const Sh={};function i_(e,t,r){Sh[e]||(Sh[e]=!0)}function s_(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Eh(e){let{to:t,replace:r,state:n,relative:i}=e;Is()||ut(!1);let{future:s,static:a}=H.useContext(si),{matches:o}=H.useContext(ai),{pathname:l}=Rs(),c=cx(),u=Af(t,bf(o,s.v7_relativeSplatPath),l,i==="path"),d=JSON.stringify(u);return H.useEffect(()=>c(JSON.parse(d),{replace:r,state:n,relative:i}),[c,d,i,r,n]),null}function on(e){ut(!1)}function a_(e){let{basename:t="/",children:r=null,location:n,navigationType:i=Bn.Pop,navigator:s,static:a=!1,future:o}=e;Is()&&ut(!1);let l=t.replace(/^\/*/,"/"),c=H.useMemo(()=>({basename:l,navigator:s,static:a,future:Ha({v7_relativeSplatPath:!1},o)}),[l,o,s,a]);typeof n=="string"&&(n=Ds(n));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:v="default"}=n,m=H.useMemo(()=>{let x=Cf(u,l);return x==null?null:{location:{pathname:x,search:d,hash:h,state:p,key:v},navigationType:i}},[l,u,d,h,p,v,i]);return m==null?null:H.createElement(si.Provider,{value:c},H.createElement(pc.Provider,{children:r,value:m}))}function o_(e){let{children:t,location:r}=e;return Gw(m0(t),r)}new Promise(()=>{});function m0(e,t){t===void 0&&(t=[]);let r=[];return H.Children.forEach(e,(n,i)=>{if(!H.isValidElement(n))return;let s=[...t,i];if(n.type===H.Fragment){r.push.apply(r,m0(n.props.children,s));return}n.type!==on&&ut(!1),!n.props.index||!n.props.children||ut(!1);let a={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=m0(n.props.children,s)),r.push(a)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function x0(){return x0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},x0.apply(this,arguments)}function l_(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function c_(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function u_(e,t){return e.button===0&&(!t||t==="_self")&&!c_(e)}const f_=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],d_="6";try{window.__reactRouterVersion=d_}catch{}const h_="startTransition",Th=sy[h_];function p_(e){let{basename:t,children:r,future:n,window:i}=e,s=H.useRef();s.current==null&&(s.current=gw({window:i,v5Compat:!0}));let a=s.current,[o,l]=H.useState({action:a.action,location:a.location}),{v7_startTransition:c}=n||{},u=H.useCallback(d=>{c&&Th?Th(()=>l(d)):l(d)},[l,c]);return H.useLayoutEffect(()=>a.listen(u),[a,u]),H.useEffect(()=>s_(n),[n]),H.createElement(a_,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:a,future:n})}const m_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",x_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,au=H.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:s,replace:a,state:o,target:l,to:c,preventScrollReset:u,viewTransition:d}=t,h=l_(t,f_),{basename:p}=H.useContext(si),v,m=!1;if(typeof c=="string"&&x_.test(c)&&(v=c,m_))try{let g=new URL(window.location.href),k=c.startsWith("//")?new URL(g.protocol+c):new URL(c),j=Cf(k.pathname,p);k.origin===g.origin&&j!=null?c=j+k.search+k.hash:m=!0}catch{}let x=Hw(c,{relative:i}),w=g_(c,{replace:a,state:o,target:l,preventScrollReset:u,relative:i,viewTransition:d});function y(g){n&&n(g),g.defaultPrevented||w(g)}return H.createElement("a",x0({},h,{href:v||x,onClick:m||s?n:y,ref:r,target:l}))});var kh;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(kh||(kh={}));var Nh;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Nh||(Nh={}));function g_(e,t){let{target:r,replace:n,state:i,preventScrollReset:s,relative:a,viewTransition:o}=t===void 0?{}:t,l=cx(),c=Rs(),u=ux(e,{relative:a});return H.useCallback(d=>{if(u_(d,r)){d.preventDefault();let h=n!==void 0?n:Al(c)===Al(u);l(e,{replace:h,state:i,preventScrollReset:s,relative:a,viewTransition:o})}},[c,l,u,n,i,r,e,s,a,o])}let jo;const v_=new Uint8Array(16);function y_(){if(!jo&&(jo=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!jo))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return jo(v_)}const kt=[];for(let e=0;e<256;++e)kt.push((e+256).toString(16).slice(1));function w_(e,t=0){return kt[e[t+0]]+kt[e[t+1]]+kt[e[t+2]]+kt[e[t+3]]+"-"+kt[e[t+4]]+kt[e[t+5]]+"-"+kt[e[t+6]]+kt[e[t+7]]+"-"+kt[e[t+8]]+kt[e[t+9]]+"-"+kt[e[t+10]]+kt[e[t+11]]+kt[e[t+12]]+kt[e[t+13]]+kt[e[t+14]]+kt[e[t+15]]}const __=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ch={randomUUID:__};function qe(e,t,r){if(Ch.randomUUID&&!e)return Ch.randomUUID();e=e||{};const n=e.random||(e.rng||y_)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,w_(n)}const S_="modulepreload",E_=function(e){return"/roskukiManage/"+e},bh={},io=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(r.map(l=>{if(l=E_(l),l in bh)return;bh[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":S_,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((h,p)=>{d.addEventListener("load",h),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},T_=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>io(async()=>{const{default:n}=await Promise.resolve().then(()=>Ls);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Of extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class k_ extends Of{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class N_ extends Of{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class C_ extends Of{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var g0;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(g0||(g0={}));var b_=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class A_{constructor(t,{headers:r={},customFetch:n,region:i=g0.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=T_(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return b_(this,void 0,void 0,function*(){try{const{headers:i,method:s,body:a}=r;let o={},{region:l}=r;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=a):typeof a=="string"?(o["Content-Type"]="text/plain",c=a):typeof FormData<"u"&&a instanceof FormData?c=a:(o["Content-Type"]="application/json",c=JSON.stringify(a)));const u=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),i),body:c}).catch(v=>{throw new k_(v)}),d=u.headers.get("x-relay-error");if(d&&d==="true")throw new N_(u);if(!u.ok)throw new C_(u);let h=((n=u.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return h==="application/json"?p=yield u.json():h==="application/octet-stream"?p=yield u.blob():h==="text/event-stream"?p=u:h==="multipart/form-data"?p=yield u.formData():p=yield u.text(),{data:p,error:null}}catch(i){return{data:null,error:i}}})}}var nr={},jf={},mc={},so={},xc={},gc={},F_=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},bs=F_();const O_=bs.fetch,px=bs.fetch.bind(bs),mx=bs.Headers,j_=bs.Request,P_=bs.Response,Ls=Object.freeze(Object.defineProperty({__proto__:null,Headers:mx,Request:j_,Response:P_,default:px,fetch:O_},Symbol.toStringTag,{value:"Module"})),D_=Wv(Ls);var vc={};Object.defineProperty(vc,"__esModule",{value:!0});let I_=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};vc.default=I_;var xx=At&&At.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(gc,"__esModule",{value:!0});const R_=xx(D_),L_=xx(vc);let M_=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=R_.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var a,o,l;let c=null,u=null,d=null,h=s.status,p=s.statusText;if(s.ok){if(this.method!=="HEAD"){const w=await s.text();w===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?u=w:u=JSON.parse(w))}const m=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),x=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");m&&x&&x.length>1&&(d=parseInt(x[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(u)&&(u.length>1?(c={code:"PGRST116",details:`Results contain ${u.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},u=null,d=null,h=406,p="Not Acceptable"):u.length===1?u=u[0]:u=null)}else{const m=await s.text();try{c=JSON.parse(m),Array.isArray(c)&&s.status===404&&(u=[],c=null,h=200,p="OK")}catch{s.status===404&&m===""?(h=204,p="No Content"):c={message:m}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,h=200,p="OK"),c&&this.shouldThrowOnError)throw new L_.default(c)}return{error:c,data:u,count:d,status:h,statusText:p}});return this.shouldThrowOnError||(i=i.catch(s=>{var a,o,l;return{error:{message:`${(a=s==null?void 0:s.name)!==null&&a!==void 0?a:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),i.then(t,r)}returns(){return this}overrideTypes(){return this}};gc.default=M_;var B_=At&&At.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(xc,"__esModule",{value:!0});const U_=B_(gc);let $_=class extends U_.default{select(t){let r=!1;const n=(t??"*").split("").map(i=>/\s/.test(i)&&!r?"":(i==='"'&&(r=!r),i)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:i,referencedTable:s=i}={}){const a=s?`${s}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:i=n}={}){const s=typeof i>"u"?"offset":`${i}.offset`,a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(a,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:i=!1,wal:s=!1,format:a="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,i?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`,a==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};xc.default=$_;var z_=At&&At.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(so,"__esModule",{value:!0});const W_=z_(xc);let H_=class extends W_.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(i=>typeof i=="string"&&new RegExp("[,()]").test(i)?`"${i}"`:`${i}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:i}={}){let s="";i==="plain"?s="pl":i==="phrase"?s="ph":i==="websearch"&&(s="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${a}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.or`:"or";return this.url.searchParams.append(i,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};so.default=H_;var V_=At&&At.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(mc,"__esModule",{value:!0});const ea=V_(so);let G_=class{constructor(t,{headers:r={},schema:n,fetch:i}){this.url=t,this.headers=r,this.schema=n,this.fetch=i}select(t,{head:r=!1,count:n}={}){const i=r?"HEAD":"GET";let s=!1;const a=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",a),n&&(this.headers.Prefer=`count=${n}`),new ea.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const i="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const a=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(a.length>0){const o=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new ea.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:i,defaultToNull:s=!0}={}){const a="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new ea.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",i=[];return this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),this.headers.Prefer=i.join(","),new ea.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new ea.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};mc.default=G_;var yc={},wc={};Object.defineProperty(wc,"__esModule",{value:!0});wc.version=void 0;wc.version="0.0.0-automated";Object.defineProperty(yc,"__esModule",{value:!0});yc.DEFAULT_HEADERS=void 0;const K_=wc;yc.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${K_.version}`};var gx=At&&At.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(jf,"__esModule",{value:!0});const q_=gx(mc),X_=gx(so),Y_=yc;let J_=class vx{constructor(t,{headers:r={},schema:n,fetch:i}={}){this.url=t,this.headers=Object.assign(Object.assign({},Y_.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=i}from(t){const r=new URL(`${this.url}/${t}`);return new q_.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new vx(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:i=!1,count:s}={}){let a;const o=new URL(`${this.url}/rpc/${t}`);let l;n||i?(a=n?"HEAD":"GET",Object.entries(r).filter(([u,d])=>d!==void 0).map(([u,d])=>[u,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([u,d])=>{o.searchParams.append(u,d)})):(a="POST",l=r);const c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new X_.default({method:a,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};jf.default=J_;var Ms=At&&At.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(nr,"__esModule",{value:!0});nr.PostgrestError=nr.PostgrestBuilder=nr.PostgrestTransformBuilder=nr.PostgrestFilterBuilder=nr.PostgrestQueryBuilder=nr.PostgrestClient=void 0;const yx=Ms(jf);nr.PostgrestClient=yx.default;const wx=Ms(mc);nr.PostgrestQueryBuilder=wx.default;const _x=Ms(so);nr.PostgrestFilterBuilder=_x.default;const Sx=Ms(xc);nr.PostgrestTransformBuilder=Sx.default;const Ex=Ms(gc);nr.PostgrestBuilder=Ex.default;const Tx=Ms(vc);nr.PostgrestError=Tx.default;var Q_=nr.default={PostgrestClient:yx.default,PostgrestQueryBuilder:wx.default,PostgrestFilterBuilder:_x.default,PostgrestTransformBuilder:Sx.default,PostgrestBuilder:Ex.default,PostgrestError:Tx.default};const{PostgrestClient:Z_,PostgrestQueryBuilder:_F,PostgrestFilterBuilder:SF,PostgrestTransformBuilder:EF,PostgrestBuilder:TF,PostgrestError:kF}=Q_;let v0;typeof window>"u"?v0=require("ws"):v0=window.WebSocket;const eS="2.11.10",tS={"X-Client-Info":`realtime-js/${eS}`},rS="1.0.0",kx=1e4,nS=1e3;var xs;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(xs||(xs={}));var Gt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Gt||(Gt={}));var zr;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(zr||(zr={}));var y0;(function(e){e.websocket="websocket"})(y0||(y0={}));var xi;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(xi||(xi={}));class iS{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2);let a=this.HEADER_LENGTH+2;const o=n.decode(t.slice(a,a+i));a=a+i;const l=n.decode(t.slice(a,a+s));a=a+s;const c=JSON.parse(n.decode(t.slice(a,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class Nx{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ke;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Ke||(Ke={}));const Ah=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,a)=>(s[a]=sS(a,e,t,i),s),{})},sS=(e,t,r,n)=>{const i=t.find(o=>o.name===e),s=i==null?void 0:i.type,a=r[e];return s&&!n.includes(s)?Cx(s,a):w0(a)},Cx=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return cS(t,r)}switch(e){case Ke.bool:return aS(t);case Ke.float4:case Ke.float8:case Ke.int2:case Ke.int4:case Ke.int8:case Ke.numeric:case Ke.oid:return oS(t);case Ke.json:case Ke.jsonb:return lS(t);case Ke.timestamp:return uS(t);case Ke.abstime:case Ke.date:case Ke.daterange:case Ke.int4range:case Ke.int8range:case Ke.money:case Ke.reltime:case Ke.text:case Ke.time:case Ke.timestamptz:case Ke.timetz:case Ke.tsrange:case Ke.tstzrange:return w0(t);default:return w0(t)}},w0=e=>e,aS=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},oS=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},lS=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},cS=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const a=e.slice(1,r);try{s=JSON.parse("["+a+"]")}catch{s=a?a.split(","):[]}return s.map(o=>Cx(t,o))}return e},uS=e=>typeof e=="string"?e.replace(" ","T"):e,bx=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class ou{constructor(t,r,n={},i=kx){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Fh;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Fh||(Fh={}));class ga{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ga.syncState(this.state,i,s,a),this.pendingDiffs.forEach(l=>{this.state=ga.syncDiff(this.state,l,s,a)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=ga.syncDiff(this.state,i,s,a),o())}),this.onJoin((i,s,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:a})}),this.onLeave((i,s,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),a=this.transformState(r),o={},l={};return this.map(s,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const d=s[c];if(d){const h=u.map(x=>x.presence_ref),p=d.map(x=>x.presence_ref),v=u.filter(x=>p.indexOf(x.presence_ref)<0),m=d.filter(x=>h.indexOf(x.presence_ref)<0);v.length>0&&(o[c]=v),m.length>0&&(l[c]=m)}else o[c]=u}),this.syncDiff(s,{joins:o,leaves:l},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:a}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(o,l)=>{var c;const u=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),u.length>0){const d=t[o].map(p=>p.presence_ref),h=u.filter(p=>d.indexOf(p.presence_ref)<0);t[o].unshift(...h)}n(o,u,l)}),this.map(a,(o,l)=>{let c=t[o];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),t[o]=c,i(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Oh;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Oh||(Oh={}));var jh;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(jh||(jh={}));var un;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(un||(un={}));class Pf{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Gt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new ou(this,zr.join,this.params,this.timeout),this.rejoinTimer=new Nx(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Gt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Gt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Gt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Gt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(zr.reply,{},(i,s)=>{this._trigger(this._replyEventName(s),i)}),this.presence=new ga(this),this.broadcastEndpointURL=bx(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:a,private:o}}=this.params;this._onError(u=>t==null?void 0:t(un.CHANNEL_ERROR,u)),this._onClose(()=>t==null?void 0:t(un.CLOSED));const l={},c={broadcast:s,presence:a,postgres_changes:(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(u=>u.filter))!==null&&i!==void 0?i:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:u})=>{var d;if(this.socket.setAuth(),u===void 0){t==null||t(un.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,p=(d=h==null?void 0:h.length)!==null&&d!==void 0?d:0,v=[];for(let m=0;m<p;m++){const x=h[m],{filter:{event:w,schema:y,table:g,filter:k}}=x,j=u&&u[m];if(j&&j.event===w&&j.schema===y&&j.table===g&&j.filter===k)v.push(Object.assign(Object.assign({},x),{id:j.id}));else{this.unsubscribe(),this.state=Gt.errored,t==null||t(un.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(un.SUBSCRIBED);return}}).receive("error",u=>{this.state=Gt.errored,t==null||t(un.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(un.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:a}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Gt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(zr.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(n=>{const i=new ou(this,zr.leave,{},t);i.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),a}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new ou(this,t,r,n);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const a=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=zr;if(n&&[o,l,c,u].indexOf(a)>=0&&n!==this._joinRef())return;let h=this._onMessage(a,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(p=>{var v,m,x;return((v=p.filter)===null||v===void 0?void 0:v.event)==="*"||((x=(m=p.filter)===null||m===void 0?void 0:m.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===a}).map(p=>p.callback(h,n)):(s=this.bindings[a])===null||s===void 0||s.filter(p=>{var v,m,x,w,y,g;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in p){const k=p.id,j=(v=p.filter)===null||v===void 0?void 0:v.event;return k&&((m=r.ids)===null||m===void 0?void 0:m.includes(k))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const k=(y=(w=p==null?void 0:p.filter)===null||w===void 0?void 0:w.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return k==="*"||k===((g=r==null?void 0:r.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===a}).map(p=>{if(typeof h=="object"&&"ids"in h){const v=h.data,{schema:m,table:x,commit_timestamp:w,type:y,errors:g}=v;h=Object.assign(Object.assign({},{schema:m,table:x,commit_timestamp:w,eventType:y,new:{},old:{},errors:g}),this._getPayloadRecords(v))}p.callback(h,n)})}_isClosed(){return this.state===Gt.closed}_isJoined(){return this.state===Gt.joined}_isJoining(){return this.state===Gt.joining}_isLeaving(){return this.state===Gt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Pf.isEqual(i.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(zr.close,{},t)}_onError(t){this._on(zr.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Gt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Ah(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Ah(t.columns,t.old_record)),r}}const Ph=()=>{},fS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class dS{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=tS,this.params={},this.timeout=kx,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ph,this.ref=0,this.logger=Ph,this.conn=null,this.sendBuffer=[],this.serializer=new iS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...o)=>io(async()=>{const{default:l}=await Promise.resolve().then(()=>Ls);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${t}/${y0.websocket}`,this.httpEndpoint=bx(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),(r!=null&&r.logLevel||r!=null&&r.log_level)&&(this.logLevel=r.logLevel||r.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const i=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(s,a)=>a(JSON.stringify(s)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Nx(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=v0),this.transport){typeof window<"u"&&this.transport===window.WebSocket?this.conn=new this.transport(this.endpointURL()):this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection();return}this.conn=new hS(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:rS}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(n=>n.teardown()))}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels=this.channels.filter(n=>n._joinRef!==t._joinRef),this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case xs.connecting:return xi.Connecting;case xs.open:return xi.Open;case xs.closing:return xi.Closing;default:return xi.Closed}}isConnected(){return this.connectionState()===xi.Open}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new Pf(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,a=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{r&&n.updateJoinPayload({access_token:r,version:this.headers&&this.headers["X-Client-Info"]}),n.joinedOnce&&n._isJoined()&&n._push(zr.access_token,{access_token:r})}))}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),(t=this.conn)===null||t===void 0||t.close(nS,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),await this.setAuth()}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:i,payload:s,ref:a}=r;n==="phoenix"&&i==="phx_reply"&&this.heartbeatCallback(r.payload.status=="ok"?"ok":"error"),a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${i} ${a&&"("+a+")"||""}`,s),Array.from(this.channels).filter(o=>o._isMember(n)).forEach(o=>o._trigger(i,s,a)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(zr.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([fS],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class hS{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=xs.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class Df extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function vt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class pS extends Df{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class _0 extends Df{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var mS=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const Ax=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>io(async()=>{const{default:n}=await Promise.resolve().then(()=>Ls);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},xS=()=>mS(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield io(()=>Promise.resolve().then(()=>Ls),void 0)).Response:Response}),S0=e=>{if(Array.isArray(e))return e.map(r=>S0(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=S0(n)}),t};var Di=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const lu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),gS=(e,t,r)=>Di(void 0,void 0,void 0,function*(){const n=yield xS();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(i=>{t(new pS(lu(i),e.status||500))}).catch(i=>{t(new _0(lu(i),i))}):t(new _0(lu(e),e))}),vS=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(i.body=JSON.stringify(n)),Object.assign(Object.assign({},i),r))};function ao(e,t,r,n,i,s){return Di(this,void 0,void 0,function*(){return new Promise((a,o)=>{e(r,vS(t,n,i,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>gS(l,o,n))})})}function Fl(e,t,r,n){return Di(this,void 0,void 0,function*(){return ao(e,"GET",t,r,n)})}function Pn(e,t,r,n,i){return Di(this,void 0,void 0,function*(){return ao(e,"POST",t,n,i,r)})}function yS(e,t,r,n,i){return Di(this,void 0,void 0,function*(){return ao(e,"PUT",t,n,i,r)})}function wS(e,t,r,n){return Di(this,void 0,void 0,function*(){return ao(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Fx(e,t,r,n,i){return Di(this,void 0,void 0,function*(){return ao(e,"DELETE",t,n,i,r)})}var tr=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const _S={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Dh={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class SS{constructor(t,r={},n,i){this.url=t,this.headers=r,this.bucketId=n,this.fetch=Ax(i)}uploadOrUpdate(t,r,n,i){return tr(this,void 0,void 0,function*(){try{let s;const a=Object.assign(Object.assign({},Dh),i);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",a.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),i!=null&&i.headers&&(o=Object.assign(Object.assign({},o),i.headers));const c=this._removeEmptyFolders(r),u=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:t,body:s,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),h=yield d.json();return d.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(vt(s))return{data:null,error:s};throw s}})}upload(t,r,n){return tr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,i){return tr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),a=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:Dh.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),h=yield d.json();return d.ok?{data:{path:s,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(vt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return tr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const i=Object.assign({},this.headers);r!=null&&r.upsert&&(i["x-upsert"]="true");const s=yield Pn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+s.url),o=a.searchParams.get("token");if(!o)throw new Df("No token returned by API");return{data:{signedUrl:a.toString(),path:t,token:o},error:null}}catch(n){if(vt(n))return{data:null,error:n};throw n}})}update(t,r,n){return tr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return tr(this,void 0,void 0,function*(){try{return{data:yield Pn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(vt(i))return{data:null,error:i};throw i}})}copy(t,r,n){return tr(this,void 0,void 0,function*(){try{return{data:{path:(yield Pn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(vt(i))return{data:null,error:i};throw i}})}createSignedUrl(t,r,n){return tr(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),s=yield Pn(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${a}`)},{data:s,error:null}}catch(i){if(vt(i))return{data:null,error:i};throw i}})}createSignedUrls(t,r,n){return tr(this,void 0,void 0,function*(){try{const i=yield Pn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${s}`):null})),error:null}}catch(i){if(vt(i))return{data:null,error:i};throw i}})}download(t,r){return tr(this,void 0,void 0,function*(){const i=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),a=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield Fl(this.fetch,`${this.url}/${i}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(vt(o))return{data:null,error:o};throw o}})}info(t){return tr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield Fl(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:S0(n),error:null}}catch(n){if(vt(n))return{data:null,error:n};throw n}})}exists(t){return tr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield wS(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(vt(n)&&n instanceof _0){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),i=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&i.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&i.push(l);let c=i.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return tr(this,void 0,void 0,function*(){try{return{data:yield Fx(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(vt(r))return{data:null,error:r};throw r}})}list(t,r,n){return tr(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},_S),r),{prefix:t||""});return{data:yield Pn(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(vt(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const ES="2.7.1",TS={"X-Client-Info":`storage-js/${ES}`};var zi=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class kS{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},TS),r),this.fetch=Ax(n)}listBuckets(){return zi(this,void 0,void 0,function*(){try{return{data:yield Fl(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(vt(t))return{data:null,error:t};throw t}})}getBucket(t){return zi(this,void 0,void 0,function*(){try{return{data:yield Fl(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(vt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return zi(this,void 0,void 0,function*(){try{return{data:yield Pn(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(vt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return zi(this,void 0,void 0,function*(){try{return{data:yield yS(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(vt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return zi(this,void 0,void 0,function*(){try{return{data:yield Pn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(vt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return zi(this,void 0,void 0,function*(){try{return{data:yield Fx(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(vt(r))return{data:null,error:r};throw r}})}}class NS extends kS{constructor(t,r={},n){super(t,r,n)}from(t){return new SS(this.url,this.headers,t,this.fetch)}}const CS="2.50.0";let aa="";typeof Deno<"u"?aa="deno":typeof document<"u"?aa="web":typeof navigator<"u"&&navigator.product==="ReactNative"?aa="react-native":aa="node";const bS={"X-Client-Info":`supabase-js-${aa}/${CS}`},AS={headers:bS},FS={schema:"public"},OS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},jS={};var PS=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const DS=e=>{let t;return e?t=e:typeof fetch>"u"?t=px:t=fetch,(...r)=>t(...r)},IS=()=>typeof Headers>"u"?mx:Headers,RS=(e,t,r)=>{const n=DS(r),i=IS();return(s,a)=>PS(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new i(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},a),{headers:c}))})};var LS=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function MS(e){return e.endsWith("/")?e:e+"/"}function BS(e,t){var r,n;const{db:i,auth:s,realtime:a,global:o}=e,{db:l,auth:c,realtime:u,global:d}=t,h={db:Object.assign(Object.assign({},l),i),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},u),a),global:Object.assign(Object.assign(Object.assign({},d),o),{headers:Object.assign(Object.assign({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>LS(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}const Ox="2.70.0",Xi=30*1e3,E0=3,cu=E0*Xi,US="http://localhost:9999",$S="supabase.auth.token",zS={"X-Client-Info":`gotrue-js/${Ox}`},T0="X-Supabase-Api-Version",jx={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},WS=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,HS=6e5;class If extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function ke(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class VS extends If{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function GS(e){return ke(e)&&e.name==="AuthApiError"}class Px extends If{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class oi extends If{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Fn extends oi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function KS(e){return ke(e)&&e.name==="AuthSessionMissingError"}class Po extends oi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Do extends oi{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Io extends oi{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function qS(e){return ke(e)&&e.name==="AuthImplicitGrantRedirectError"}class Ih extends oi{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class k0 extends oi{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function uu(e){return ke(e)&&e.name==="AuthRetryableFetchError"}class Rh extends oi{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class va extends oi{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ol="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Lh=` 	
\r=`.split(""),XS=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Lh.length;t+=1)e[Lh[t].charCodeAt(0)]=-2;for(let t=0;t<Ol.length;t+=1)e[Ol[t].charCodeAt(0)]=t;return e})();function Mh(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ol[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Ol[n]),t.queuedBits-=6}}function Dx(e,t,r){const n=XS[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Bh(e){const t=[],r=a=>{t.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=a=>{QS(a,n,r)};for(let a=0;a<e.length;a+=1)Dx(e.charCodeAt(a),i,s);return t.join("")}function YS(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function JS(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}YS(n,t)}}function QS(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function ZS(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Dx(e.charCodeAt(i),r,n);return new Uint8Array(t)}function eE(e){const t=[];return JS(e,r=>t.push(r)),new Uint8Array(t)}function tE(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>Mh(i,r,n)),Mh(null,r,n),t.join("")}function rE(e){return Math.round(Date.now()/1e3)+e}function nE(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Br=()=>typeof window<"u"&&typeof document<"u",di={tested:!1,writable:!1},ya=()=>{if(!Br())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(di.tested)return di.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),di.tested=!0,di.writable=!0}catch{di.tested=!0,di.writable=!1}return di.writable};function iE(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const Ix=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>io(async()=>{const{default:n}=await Promise.resolve().then(()=>Ls);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},sE=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Rx=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Ro=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Lo=async(e,t)=>{await e.removeItem(t)};class _c{constructor(){this.promise=new _c.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}_c.promiseConstructor=Promise;function fu(e){const t=e.split(".");if(t.length!==3)throw new va("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!WS.test(t[n]))throw new va("JWT not in base64url format");return{header:JSON.parse(Bh(t[0])),payload:JSON.parse(Bh(t[1])),signature:ZS(t[2]),raw:{header:t[0],payload:t[1]}}}async function aE(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function oE(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const a=await e(s);if(!t(s,null,a)){n(a);return}}catch(a){if(!t(s,a)){i(a);return}}})()})}function lE(e){return("0"+e.toString(16)).substr(-2)}function cE(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,lE).join("")}async function uE(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function fE(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await uE(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Wi(e,t,r=!1){const n=cE();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Rx(e,`${t}-code-verifier`,i);const s=await fE(n);return[s,n===s?"plain":"s256"]}const dE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function hE(e){const t=e.headers.get(T0);if(!t||!t.match(dE))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function pE(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function mE(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const xE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Hi(e){if(!xE.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}var gE=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};const mi=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),vE=[502,503,504];async function Uh(e){var t;if(!sE(e))throw new k0(mi(e),0);if(vE.includes(e.status))throw new k0(mi(e),e.status);let r;try{r=await e.json()}catch(s){throw new Px(mi(s),s)}let n;const i=hE(e);if(i&&i.getTime()>=jx["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Rh(mi(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Fn}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,a)=>s&&typeof a=="string",!0))throw new Rh(mi(r),e.status,r.weak_password.reasons);throw new VS(mi(r),e.status||500,n)}const yE=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Ae(e,t,r,n){var i;const s=Object.assign({},n==null?void 0:n.headers);s[T0]||(s[T0]=jx["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const a=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(a.redirect_to=n.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await wE(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function wE(e,t,r,n,i,s){const a=yE(t,n,i,s);let o;try{o=await e(r,Object.assign({},a))}catch(l){throw console.error(l),new k0(mi(l),0)}if(o.ok||await Uh(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await Uh(l)}}function ln(e){var t;let r=null;TE(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=rE(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function $h(e){const t=ln(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Rn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function _E(e){return{data:e,error:null}}function SE(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,a=gE(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function EE(e){return e}function TE(e){return e.access_token&&e.refresh_token&&e.expires_in}const du=["global","local","others"];var kE=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r};class NE{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Ix(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=du[0]){if(du.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${du.join(", ")}`);try{return await Ae(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ke(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ae(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Rn})}catch(n){if(ke(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=kE(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await Ae(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:SE,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ke(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ae(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Rn})}catch(r){if(ke(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Ae(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:EE});if(u.error)throw u.error;const d=await u.json(),h=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,p=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(v=>{const m=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(v.split(";")[1].split("=")[1]);c[`${x}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(ke(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Hi(t);try{return await Ae(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Rn})}catch(r){if(ke(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Hi(t);try{return await Ae(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Rn})}catch(n){if(ke(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Hi(t);try{return await Ae(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Rn})}catch(n){if(ke(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Hi(t.userId);try{const{data:r,error:n}=await Ae(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(ke(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Hi(t.userId),Hi(t.id);try{return{data:await Ae(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(ke(r))return{data:null,error:r};throw r}}}const CE={getItem:e=>ya()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{ya()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{ya()&&globalThis.localStorage.removeItem(e)}};function zh(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function bE(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Vi={debug:!!(globalThis&&ya()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Lx extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class AE extends Lx{}async function FE(e,t,r){Vi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Vi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Vi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{Vi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw Vi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new AE(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Vi.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}bE();const OE={url:US,storageKey:$S,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:zS,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Wh(e,t,r){return await r()}class Va{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Va.nextInstanceID,Va.nextInstanceID+=1,this.instanceID>0&&Br()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},OE),t);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new NE({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=Ix(i.fetch),this.lock=i.lock||Wh,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:Br()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=FE:this.lock=Wh,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:ya()?this.storage=CE:(this.memoryStorage={},this.storage=zh(this.memoryStorage)):(this.memoryStorage={},this.storage=zh(this.memoryStorage)),Br()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Ox}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=iE(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Br()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),qS(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ke(r)?{error:r}:{error:new Px("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await Ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:ln}),{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(ke(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:u,password:d,options:h}=t;let p=null,v=null;this.flowType==="pkce"&&([p,v]=await Wi(this.storage,this.storageKey)),s=await Ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:v},xform:ln})}else if("phone"in t){const{phone:u,password:d,options:h}=t;s=await Ae(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(i=h==null?void 0:h.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:ln})}else throw new Do("You must provide either an email or phone number and a password");const{data:a,error:o}=s;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(ke(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:a,options:o}=t;r=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:$h})}else if("phone"in t){const{phone:s,password:a,options:o}=t;r=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:$h})}else throw new Do("You must provide either an email or phone number and a password");const{data:n,error:i}=r;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Po}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(ke(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,i,s,a,o,l,c,u,d,h,p;let v,m;if("message"in t)v=t.message,m=t.signature;else{const{chain:x,wallet:w,statement:y,options:g}=t;let k;if(Br())if(typeof w=="object")k=w;else{const O=window;if("solana"in O&&typeof O.solana=="object"&&("signIn"in O.solana&&typeof O.solana.signIn=="function"||"signMessage"in O.solana&&typeof O.solana.signMessage=="function"))k=O.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=w}const j=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in k&&k.signIn){const O=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),y?{statement:y}:null));let T;if(Array.isArray(O)&&O[0]&&typeof O[0]=="object")T=O[0];else if(O&&typeof O=="object"&&"signedMessage"in O&&"signature"in O)T=O;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)v=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),m=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${j.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(i=(n=g==null?void 0:g.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=g==null?void 0:g.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((a=g==null?void 0:g.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((o=g==null?void 0:g.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((c=g==null?void 0:g.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((d=(u=g==null?void 0:g.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||d===void 0)&&d.length?["Resources",...g.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const O=await k.signMessage(new TextEncoder().encode(v),"utf8");if(!O||!(O instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=O}}try{const{data:x,error:w}=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:tE(m)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:ln});if(w)throw w;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new Po}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:w})}catch(x){if(ke(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(t){const r=await Ro(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{const{data:s,error:a}=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:ln});if(await Lo(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Po}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:a})}catch(s){if(ke(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:a}=t,o=await Ae(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:ln}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Po}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(ke(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,i,s,a;try{if("email"in t){const{email:o,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Wi(this.storage,this.storageKey));const{error:d}=await Ae(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:u}=await Ae(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Do("You must provide either an email or phone number.")}catch(o){if(ke(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:o}=await Ae(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:ln});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(ke(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(t){var r,n,i;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=await Wi(this.storage,this.storageKey)),await Ae(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:_E})}catch(s){if(ke(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Fn;const{error:i}=await Ae(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:i}})}catch(t){if(ke(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:a}=await Ae(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:a,error:o}=await Ae(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new Do("You must provide either an email or phone number and a type")}catch(r){if(ke(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Ro(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<cu:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let a=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,u)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:t},error:null}}const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ae(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Rn}):await this._useSession(async r=>{var n,i,s;const{data:a,error:o}=r;if(o)throw o;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Fn}:await Ae(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:Rn})})}catch(r){if(ke(r))return KS(r)&&(await this._removeSession(),await Lo(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Fn;const a=i.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Wi(this.storage,this.storageKey));const{data:c,error:u}=await Ae(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:Rn});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(ke(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Fn;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:a}=fu(t.access_token);if(a.exp&&(n=a.exp,i=n<=r),i){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(ke(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:a,error:o}=r;if(o)throw o;t=(n=a.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Fn;const{session:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(ke(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Br())throw new Io("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Io(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Ih("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Io("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Ih("No code detected.");const{data:y,error:g}=await this._exchangeCodeForSession(t.code);if(g)throw g;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!a||!c)throw new Io("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(o);let h=u+d;l&&(h=parseInt(l));const p=h-u;p*1e3<=Xi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const v=h-d;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,h,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,h,u);const{data:m,error:x}=await this._getUser(s);if(x)throw x;const w={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:d,expires_at:h,refresh_token:a,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:t.type},error:null}}catch(n){if(ke(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Ro(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{error:s};const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:o}=await this.admin.signOut(a,t);if(o&&!(GS(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await Lo(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=nE(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:a}=r;if(a)throw a;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Wi(this.storage,this.storageKey,!0));try{return await Ae(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(ke(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(ke(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var a,o,l,c,u;const{data:d,error:h}=s;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(a=t.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Ae(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return Br()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(ke(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)throw a;return await Ae(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(ke(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await oE(async i=>(i>0&&await aE(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Ae(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ln})),(i,s)=>{const a=200*Math.pow(2,i);return s&&uu(s)&&Date.now()+a-n<Xi})}catch(n){if(this._debug(r,"error",n),ke(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Br()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await Ro(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const i=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<cu;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${cu}s`),i){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),uu(s)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Fn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new _c;const{data:s,error:a}=await this._refreshAccessToken(t);if(a)throw a;if(!s.session)throw new Fn;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(i,"error",s),ke(s)){const a={session:null,error:s};return uu(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(a),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Rx(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await Lo(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Br()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Xi);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Xi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Xi}ms, refresh threshold is ${E0} ticks`),i<=E0&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Lx)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Br()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,a]=await Wi(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await Ae(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ke(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:a}=r;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await Ae(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(ke(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return{data:null,error:s};const{data:a,error:o}=await Ae(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(r){if(ke(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?{data:null,error:s}:await Ae(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ke(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],i=n.filter(a=>a.factor_type==="totp"&&a.status==="verified"),s=n.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:n,totp:i,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:i},error:s}=t;if(s)return{data:null,error:s};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=fu(i.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((n=(r=i.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(a=>a.kid===t);if(n||(n=this.jwks.keys.find(a=>a.kid===t),n&&this.jwks_cached_at+HS>Date.now()))return n;const{data:i,error:s}=await Ae(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!i.keys||i.keys.length===0)throw new va("JWKS is empty");if(this.jwks=i,this.jwks_cached_at=Date.now(),n=i.keys.find(a=>a.kid===t),!n)throw new va("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:p,error:v}=await this.getSession();if(v||!p.session)return{data:null,error:v};n=p.session.access_token}const{header:i,payload:s,signature:a,raw:{header:o,payload:l}}=fu(n);if(pE(s.exp),!i.kid||i.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:i,signature:a},error:null}}const c=mE(i.alg),u=await this.fetchJwk(i.kid,r),d=await crypto.subtle.importKey("jwk",u,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,a,eE(`${o}.${l}`)))throw new va("Invalid JWT signature");return{data:{claims:s,header:i,signature:a},error:null}}catch(n){if(ke(n))return{data:null,error:n};throw n}}}Va.nextInstanceID=0;const jE=Va;class PE extends jE{constructor(t){super(t)}}var DE=function(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{c(n.next(u))}catch(d){a(d)}}function l(u){try{c(n.throw(u))}catch(d){a(d)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class IE{constructor(t,r,n){var i,s,a;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=MS(t),l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:FS,realtime:jS,auth:Object.assign(Object.assign({},OS),{storageKey:c}),global:AS},d=BS(n??{},u);this.storageKey=(i=d.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=d.auth)!==null&&a!==void 0?a:{},this.headers,d.global.fetch),this.fetch=RS(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new Z_(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new A_(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new NS(this.storageUrl.href,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return DE(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,storageKey:s,flowType:a,lock:o,debug:l},c,u){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new PE({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),c),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:i,flowType:a,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new dS(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const RE=(e,t,r)=>new IE(e,t,r),LE="https://gwxlpjvwuobpuvyklrjw.supabase.co",ME="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd3eGxwanZ3dW9icHV2eWtscmp3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk0ODc5MzgsImV4cCI6MjA2NTA2MzkzOH0.Iu4eh71QRDJJ6-75my0T7SszJ61-loKXt2m9fdojFNY",Me=RE(LE,ME),Mx=()=>{const[e,t]=H.useState(!1),[r,n]=H.useState(!0);return H.useEffect(()=>{const i=async()=>{try{n(!0);const{data:a,error:o}=await Me.from("users").select("count").limit(1);o?(console.error("Error de conexión a Supabase:",o),t(!1)):(console.log("Conectado a Supabase exitosamente"),t(!0))}catch(a){console.error("Error al verificar conexión:",a),t(!1)}finally{n(!1)}};i();const s=setInterval(i,3e4);return()=>clearInterval(s)},[]),{supabase:Me,isConnected:e,isLoading:r}};class Ue{static async getUsers(){const{data:t,error:r}=await Me.from("users").select("*").order("created_at",{ascending:!1});if(r)throw r;return(t==null?void 0:t.map(this.mapUserFromDB))||[]}static async createUser(t){const{data:r,error:n}=await Me.from("users").insert([{name:t.name,email:t.email,phone:t.phone,address:t.address,order_count:t.orderCount,total_cookies:t.totalCookies,box4_count:t.box4Count,box6_count:t.box6Count}]).select().single();if(n)throw n;return this.mapUserFromDB(r)}static async updateUser(t,r){const n={};r.name!==void 0&&(n.name=r.name),r.email!==void 0&&(n.email=r.email),r.phone!==void 0&&(n.phone=r.phone),r.address!==void 0&&(n.address=r.address),r.orderCount!==void 0&&(n.order_count=r.orderCount),r.totalCookies!==void 0&&(n.total_cookies=r.totalCookies),r.box4Count!==void 0&&(n.box4_count=r.box4Count),r.box6Count!==void 0&&(n.box6_count=r.box6Count);const{data:i,error:s}=await Me.from("users").update(n).eq("id",t).select().single();if(s)throw s;return this.mapUserFromDB(i)}static async getFlavors(){const{data:t,error:r}=await Me.from("flavors").select("*").order("name");if(r)throw r;return(t==null?void 0:t.map(this.mapFlavorFromDB))||[]}static async createFlavor(t){const{data:r,error:n}=await Me.from("flavors").insert([{name:t.name,available:t.available}]).select().single();if(n)throw n;return this.mapFlavorFromDB(r)}static async updateFlavor(t,r){const{data:n,error:i}=await Me.from("flavors").update({name:r.name,available:r.available}).eq("id",t).select().single();if(i)throw i;return this.mapFlavorFromDB(n)}static async getInventory(){const{data:t,error:r}=await Me.from("inventory").select("*").order("created_at",{ascending:!1});if(r)throw r;return(t==null?void 0:t.map(this.mapInventoryFromDB))||[]}static async createInventoryItem(t){const{data:r,error:n}=await Me.from("flavors").select("id").eq("name",t.flavor).single();if(n)throw n;const{data:i}=await Me.from("inventory").select("*").eq("flavor_id",r.id).eq("size",t.size).maybeSingle();if(i){const o=i.quantity+t.quantity;return this.updateInventoryItem(i.id,o)}const{data:s,error:a}=await Me.from("inventory").insert([{flavor_id:r.id,flavor_name:t.flavor,size:t.size,quantity:t.quantity}]).select().single();if(a)throw a;return this.mapInventoryFromDB(s)}static async updateInventoryItem(t,r){const{data:n,error:i}=await Me.from("inventory").update({quantity:r,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(i)throw i;return this.mapInventoryFromDB(n)}static async deleteInventoryItem(t){const{error:r}=await Me.from("inventory").delete().eq("id",t);if(r)throw r}static async getInventoryMovements(){const{data:t,error:r}=await Me.from("inventory_movements").select("*").order("created_at",{ascending:!1});if(r)throw r;return(t==null?void 0:t.map(this.mapInventoryMovementFromDB))||[]}static async createInventoryMovement(t){let r=t.flavorId;if(!r){const{data:s,error:a}=await Me.from("flavors").select("id").eq("name",t.flavor).single();if(a)throw a;r=s.id}const{data:n,error:i}=await Me.from("inventory_movements").insert([{flavor_id:r,flavor_name:t.flavor,size:t.size,quantity:t.quantity,movement_type:t.type,reason:t.reason,order_id:t.orderId}]).select().single();if(i)throw i;return this.mapInventoryMovementFromDB(n)}static async getSales(){const{data:t,error:r}=await Me.from("sales").select(`
        *,
        sale_items (*)
      `).order("created_at",{ascending:!1});if(r)throw r;return(t==null?void 0:t.map(this.mapSaleFromDB))||[]}static async createSale(t){const{data:r,error:n}=await Me.from("sales").insert([{user_id:t.userId,user_name:t.userName,total:t.total}]).select().single();if(n)throw n;const i=await Promise.all(t.items.map(async l=>{const{data:c}=await Me.from("flavors").select("id").eq("name",l.flavor).single();return{sale_id:r.id,cookie_id:l.cookieId,flavor_id:c==null?void 0:c.id,flavor_name:l.flavor,size:l.size,quantity:l.quantity,price:l.price,total:l.total,sale_type:l.saleType,box_quantity:l.boxQuantity}})),{error:s}=await Me.from("sale_items").insert(i);if(s)throw s;const{data:a,error:o}=await Me.from("sales").select(`
        *,
        sale_items (*)
      `).eq("id",r.id).single();if(o)throw o;return this.mapSaleFromDB(a)}static async getOrders(){const{data:t,error:r}=await Me.from("orders").select(`
        *,
        order_items (*)
      `).order("created_at",{ascending:!1});if(r)throw r;return(t==null?void 0:t.map(this.mapOrderFromDB))||[]}static async createOrder(t){const{data:r,error:n}=await Me.from("orders").insert([{sale_id:t.saleId,user_id:t.userId,user_name:t.userName,total:t.total,is_prepared:t.isPrepared,is_delivered:t.isDelivered,is_paid:t.isPaid}]).select().single();if(n)throw n;const{data:i,error:s}=await Me.from("orders").select(`
        *,
        order_items (*)
      `).eq("id",r.id).single();if(s)throw s;return this.mapOrderFromDB(i)}static async updateOrder(t,r){const n={};r.isPrepared!==void 0&&(n.is_prepared=r.isPrepared,r.isPrepared&&(n.prepared_date=new Date().toISOString())),r.isDelivered!==void 0&&(n.is_delivered=r.isDelivered,r.isDelivered&&(n.delivered_date=new Date().toISOString())),r.isPaid!==void 0&&(n.is_paid=r.isPaid,r.isPaid&&(n.paid_date=new Date().toISOString()));const{data:i,error:s}=await Me.from("orders").update(n).eq("id",t).select(`
        *,
        order_items (*)
      `).single();if(s)throw s;return this.mapOrderFromDB(i)}static async deleteOrder(t){const{error:r}=await Me.from("orders").delete().eq("id",t);if(r)throw r}static async getFinancialRecords(){const{data:t,error:r}=await Me.from("financial_records").select("*").order("created_at",{ascending:!1});if(r)throw r;return(t==null?void 0:t.map(this.mapFinancialFromDB))||[]}static async createFinancialRecord(t){const{data:r,error:n}=await Me.from("financial_records").insert([{type:t.type,description:t.description,amount:t.amount,category:t.category,order_id:t.orderId}]).select().single();if(n)throw n;return this.mapFinancialFromDB(r)}static async updateFinancialRecord(t,r){const{data:n,error:i}=await Me.from("financial_records").update({type:r.type,description:r.description,amount:r.amount,category:r.category}).eq("id",t).select().single();if(i)throw i;return this.mapFinancialFromDB(n)}static async deleteFinancialRecord(t){const{error:r}=await Me.from("financial_records").delete().eq("id",t);if(r)throw r}static mapUserFromDB(t){return{id:t.id,name:t.name,email:t.email,phone:t.phone,address:t.address,createdAt:new Date(t.created_at),updatedAt:t.updated_at?new Date(t.updated_at):void 0,orderCount:t.order_count||0,totalCookies:t.total_cookies||0,box4Count:t.box4_count||0,box6Count:t.box6_count||0}}static mapFlavorFromDB(t){return{id:t.id,name:t.name,available:t.available,createdAt:t.created_at?new Date(t.created_at):void 0,updatedAt:t.updated_at?new Date(t.updated_at):void 0}}static mapInventoryFromDB(t){return{id:t.id,flavorId:t.flavor_id,flavor:t.flavor_name,size:t.size,quantity:t.quantity,createdAt:new Date(t.created_at),updatedAt:t.updated_at?new Date(t.updated_at):void 0}}static mapInventoryMovementFromDB(t){return{id:t.id,flavorId:t.flavor_id,flavor:t.flavor_name,size:t.size,quantity:t.quantity,type:t.movement_type,reason:t.reason,date:new Date(t.created_at),orderId:t.order_id}}static mapSaleFromDB(t){var r;return{id:t.id,userId:t.user_id,userName:t.user_name,total:parseFloat(t.total),date:new Date(t.created_at),items:((r=t.sale_items)==null?void 0:r.map(n=>({id:n.id,cookieId:n.cookie_id,flavorId:n.flavor_id,flavor:n.flavor_name,size:n.size,quantity:n.quantity,price:parseFloat(n.price),total:parseFloat(n.total),saleType:n.sale_type,boxQuantity:n.box_quantity})))||[]}}static mapOrderFromDB(t){var r;return{id:t.id,saleId:t.sale_id,userId:t.user_id,userName:t.user_name,total:parseFloat(t.total),date:new Date(t.created_at),isPrepared:t.is_prepared||!1,preparedDate:t.prepared_date?new Date(t.prepared_date):void 0,isDelivered:t.is_delivered||!1,deliveredDate:t.delivered_date?new Date(t.delivered_date):void 0,isPaid:t.is_paid||!1,paidDate:t.paid_date?new Date(t.paid_date):void 0,updatedAt:t.updated_at?new Date(t.updated_at):void 0,items:((r=t.order_items)==null?void 0:r.map(n=>({id:n.id,orderId:n.order_id,saleItemId:n.sale_item_id,flavorId:n.flavor_id,flavor:n.flavor_name,size:n.size,quantity:n.quantity,price:parseFloat(n.price),total:parseFloat(n.total),saleType:n.sale_type,boxQuantity:n.box_quantity,createdAt:n.created_at?new Date(n.created_at):void 0})))||[]}}static mapFinancialFromDB(t){return{id:t.id,type:t.type,description:t.description,amount:parseFloat(t.amount),category:t.category,date:new Date(t.created_at),orderId:t.order_id}}}const Hh=[{id:qe(),name:"Chips Chocolate Relleno Nutela",available:!0},{id:qe(),name:"Red Velvet Relleno Nutella",available:!0},{id:qe(),name:"M&m's Relleno Nutella",available:!0},{id:qe(),name:"Oreo Relleno Oreo",available:!0},{id:qe(),name:"Oreo Relleno Nutella",available:!0},{id:qe(),name:"Galleta Galak",available:!0},{id:qe(),name:"Galleta Nucita",available:!0},{id:qe(),name:"Chocolatina Jet",available:!0}],Bx=H.createContext(void 0),BE=({children:e})=>{const{isConnected:t,isLoading:r}=Mx(),[n,i]=H.useState(!1),[s,a]=H.useState(!1),[o,l]=H.useState(()=>{const M=localStorage.getItem("cookie-app-users");return M?JSON.parse(M):[]}),[c,u]=H.useState(null),[d,h]=H.useState(()=>{const M=localStorage.getItem("cookie-app-flavors");return M?JSON.parse(M):Hh}),[p,v]=H.useState(()=>{const M=localStorage.getItem("cookie-app-inventory");return M?JSON.parse(M):[]}),[m,x]=H.useState(()=>{const M=localStorage.getItem("cookie-app-inventory-movements");return M?JSON.parse(M):[]}),[w,y]=H.useState([]),[g,k]=H.useState(()=>{const M=localStorage.getItem("cookie-app-sales");return M?JSON.parse(M):[]}),[j,O]=H.useState(()=>{const M=localStorage.getItem("cookie-app-orders");return M?JSON.parse(M):[]}),[T,I]=H.useState(()=>{const M=localStorage.getItem("cookie-app-financial");return M?JSON.parse(M):[]}),A=M=>{l(M),localStorage.setItem("cookie-app-users",JSON.stringify(M))},R=M=>{h(M),localStorage.setItem("cookie-app-flavors",JSON.stringify(M))},K=M=>{v(M),localStorage.setItem("cookie-app-inventory",JSON.stringify(M))},G=M=>{k(M),localStorage.setItem("cookie-app-sales",JSON.stringify(M))},Q=M=>{O(M),localStorage.setItem("cookie-app-orders",JSON.stringify(M))},ye=M=>{I(M),localStorage.setItem("cookie-app-financial",JSON.stringify(M))};H.useEffect(()=>{localStorage.setItem("cookie-app-users",JSON.stringify(o))},[o]),H.useEffect(()=>{localStorage.setItem("cookie-app-flavors",JSON.stringify(d))},[d]),H.useEffect(()=>{localStorage.setItem("cookie-app-inventory",JSON.stringify(p))},[p]),H.useEffect(()=>{localStorage.setItem("cookie-app-inventory-movements",JSON.stringify(m))},[m]),H.useEffect(()=>{localStorage.setItem("cookie-app-sales",JSON.stringify(g))},[g]),H.useEffect(()=>{localStorage.setItem("cookie-app-orders",JSON.stringify(j))},[j]),H.useEffect(()=>{localStorage.setItem("cookie-app-financial",JSON.stringify(T))},[T]),H.useEffect(()=>{t&&!r&&(console.log("Cargando datos desde Supabase..."),re())},[t,r]),H.useEffect(()=>{Ee()},[p]);const Ee=()=>{const M=d.map(V=>{const q=p.filter(oe=>oe.flavor===V.name).reduce((oe,_e)=>oe+_e.quantity,0);return{...V,available:q>0}});M.some((V,q)=>V.available!==d[q].available)&&R(M)},re=async()=>{if(!t){console.log("No conectado a Supabase, usando datos locales");return}i(!0);try{console.log("Iniciando carga de datos...");const[M,ie,V,q,oe,_e,Re]=await Promise.all([Ue.getUsers(),Ue.getFlavors(),Ue.getInventory(),Ue.getInventoryMovements(),Ue.getSales(),Ue.getOrders(),Ue.getFinancialRecords()]);console.log("Datos cargados:",{users:M.length,flavors:ie.length,inventory:V.length,movements:q.length,sales:oe.length,orders:_e.length,financial:Re.length}),A(M),R(ie.length>0?ie:Hh),K(V),x(q),G(oe),Q(_e),ye(Re)}catch(M){console.error("Error loading data from Supabase:",M)}finally{i(!1)}},Se=async()=>{t&&await re()},le=M=>{let ie=0,V=0,q=0;return M.forEach(oe=>{oe.saleType==="unit"?ie+=oe.quantity:oe.saleType==="box4"?(V+=oe.quantity,ie+=oe.quantity):oe.saleType==="box6"&&(q+=oe.quantity,ie+=oe.quantity)}),{totalCookies:ie,box4Count:V,box6Count:q}},xe=async(M,ie)=>{const V=o.find(_e=>_e.id===M);if(!V)return;const q=le(ie),oe={...V,orderCount:V.orderCount+1,totalCookies:V.totalCookies+q.totalCookies,box4Count:V.box4Count+q.box4Count,box6Count:V.box6Count+q.box6Count};console.log("📊 Actualizando estadísticas del usuario:",{usuario:V.name,antes:{pedidos:V.orderCount,galletas:V.totalCookies,cajas4:V.box4Count,cajas6:V.box6Count},despues:{pedidos:oe.orderCount,galletas:oe.totalCookies,cajas4:oe.box4Count,cajas6:oe.box6Count},incremento:q});try{await U(M,{orderCount:oe.orderCount,totalCookies:oe.totalCookies,box4Count:oe.box4Count,box6Count:oe.box6Count}),c&&c.id===M&&u(oe)}catch(_e){console.error("Error actualizando estadísticas del usuario:",_e)}},we=async(M,ie,V,q,oe,_e)=>{const Re={flavor:M,size:ie,quantity:V,type:q,reason:oe,orderId:_e};if(t)try{const je=await Ue.createInventoryMovement(Re);x(Er=>[je,...Er])}catch(je){console.error("Error creating inventory movement:",je)}else{const je={...Re,id:qe(),date:new Date};x(Er=>[je,...Er])}},be=async M=>{const ie=j.find(q=>q.id===M);if(!ie){console.error("❌ Pedido no encontrado:",M);return}console.log("🔄 Iniciando deducción de inventario para pedido:",ie.userName);let V=[...p];for(const q of ie.items){const oe=q.quantity;console.log(`📦 Procesando: ${oe}x ${q.flavor} (${q.size})`);const _e=V.filter(Ht=>Ht.flavor===q.flavor&&Ht.size===q.size&&Ht.quantity>0);if(_e.length===0){console.warn(`⚠️ No hay inventario disponible para ${q.flavor} ${q.size}`);continue}const Re=_e.reduce((Ht,Ir)=>Ht+Ir.quantity,0);Re<oe&&console.warn(`⚠️ Inventario insuficiente para ${q.flavor} ${q.size}. Disponible: ${Re}, Necesario: ${oe}`);let je=oe;const Er=_e.sort((Ht,Ir)=>new Date(Ht.createdAt).getTime()-new Date(Ir.createdAt).getTime());for(const Ht of Er){if(je<=0)break;const Ir=V.findIndex(ui=>ui.id===Ht.id);if(Ir===-1)continue;const Ui=V[Ir].quantity,ci=Math.min(je,Ui);if(ci>0){const ui=Ui-ci;console.log(`✅ Deduciendo ${ci} de lote ${Ht.id.substring(0,8)}... (${Ui} → ${ui})`),V[Ir]={...V[Ir],quantity:ui,updatedAt:new Date},je-=ci}}V=V.filter(Ht=>Ht.quantity>0),console.log(`📝 Registrando movimiento: -${oe} ${q.flavor} ${q.size}`),await we(q.flavor,q.size,oe,"deduction",`Entrega de pedido - ${ie.userName}`,M)}console.log("💾 Actualizando inventario..."),K(V),console.log("✅ Deducción de inventario completada")},F=async(M,ie,V,q)=>{const oe={name:M,email:ie,phone:V,address:q,orderCount:0,totalCookies:0,box4Count:0,box6Count:0};if(t)try{console.log("Creando usuario en Supabase:",oe);const _e=await Ue.createUser(oe);return console.log("Usuario creado:",_e),A([_e,...o]),u(_e),_e}catch(_e){console.error("Error creating user:",_e);const Re={...oe,id:qe(),createdAt:new Date};return A([Re,...o]),u(Re),Re}else{const _e={...oe,id:qe(),createdAt:new Date};return A([_e,...o]),u(_e),_e}},U=async(M,ie)=>{if(t)try{console.log("Actualizando usuario en Supabase:",{id:M,updates:ie});const V=await Ue.updateUser(M,ie);console.log("Usuario actualizado:",V),A(o.map(q=>q.id===M?V:q)),c&&c.id===M&&u(V)}catch(V){console.error("Error updating user:",V);const q=o.map(oe=>oe.id===M?{...oe,...ie,updatedAt:new Date}:oe);throw A(q),c&&c.id===M&&u({...c,...ie,updatedAt:new Date}),V}else{const V=o.map(q=>q.id===M?{...q,...ie,updatedAt:new Date}:q);A(V),c&&c.id===M&&u({...c,...ie,updatedAt:new Date})}},D=M=>{const ie=o.find(V=>V.id===M)||null;u(ie)},P=async M=>{const ie={name:M,available:!0};if(t)try{console.log("Creando sabor en Supabase:",ie);const V=await Ue.createFlavor(ie);console.log("Sabor creado:",V),R([...d,V])}catch(V){console.error("Error creating flavor:",V);const q={...ie,id:qe()};R([...d,q])}else{const V={...ie,id:qe()};R([...d,V])}},J=async M=>{const ie=d.find(q=>q.id===M);if(!ie)return;const V={...ie,available:!ie.available};if(t)try{await Ue.updateFlavor(M,V),R(d.map(q=>q.id===M?V:q))}catch(q){console.error("Error updating flavor:",q),R(d.map(oe=>oe.id===M?V:oe))}else R(d.map(q=>q.id===M?V:q))},pe=async(M,ie,V)=>{const q=ie,oe={flavor:M,size:q,quantity:V};if(t)try{console.log("Añadiendo al inventario en Supabase:",oe);const _e=await Ue.createInventoryItem(oe);console.log("Item de inventario creado:",_e),K([_e,...p]),await we(M,q,V,"addition","Añadido al inventario")}catch(_e){console.error("Error adding to inventory:",_e);const Re={...oe,id:qe(),createdAt:new Date};K([Re,...p]),await we(M,q,V,"addition","Añadido al inventario")}else{const _e={...oe,id:qe(),createdAt:new Date};K([_e,...p]),await we(M,q,V,"addition","Añadido al inventario")}},ve=(M,ie,V,q,oe,_e)=>{const Re=w.findIndex(je=>je.flavor===M&&je.size===ie&&je.saleType===oe);if(Re>=0){const je=[...w],Er=je[Re];je[Re]={...Er,quantity:Er.quantity+V,total:(Er.quantity+V)*Er.price},y(je)}else y(je=>[...je,{id:qe(),cookieId:qe(),flavor:M,size:ie,quantity:V,price:q,total:V*q,saleType:oe,boxQuantity:_e}])},ge=M=>{y(ie=>ie.filter(V=>V.id!==M))},ue=(M,ie)=>{y(V=>V.map(q=>q.id===M?{...q,quantity:ie,total:ie*q.price}:q))},De=async M=>{const ie={saleId:M.id,userId:M.userId,userName:M.userName,items:M.items.map(V=>({id:qe(),orderId:"",flavor:V.flavor,size:V.size,quantity:V.quantity,price:V.price,total:V.total,saleType:V.saleType,boxQuantity:V.boxQuantity})),total:M.total,isPrepared:!1,isDelivered:!1,isPaid:!1};if(t)try{console.log("Creando pedido en Supabase:",ie);const V=await Ue.createOrder(ie);console.log("Pedido creado:",V),Q([V,...j])}catch(V){console.error("Error creating order:",V);const q={...ie,id:qe(),date:new Date,items:ie.items.map(oe=>({...oe,orderId:qe()}))};Q([q,...j])}else{const V={...ie,id:qe(),date:new Date,items:ie.items.map(q=>({...q,orderId:qe()}))};Q([V,...j])}},Oe=async M=>{const ie=j.find(V=>V.id===M);if(!(!ie||ie.isPrepared))if(t)try{const V=await Ue.updateOrder(M,{isPrepared:!0,preparedDate:new Date});Q(j.map(q=>q.id===M?V:q))}catch(V){console.error("Error updating order:",V),Q(j.map(q=>q.id===M?{...q,isPrepared:!0,preparedDate:new Date}:q))}else Q(j.map(V=>V.id===M?{...V,isPrepared:!0,preparedDate:new Date}:V))},Tt=async M=>{const ie=j.find(V=>V.id===M);if(!(!ie||ie.isDelivered))if(console.log("🚚 Marcando pedido como entregado:",M),t)try{console.log("☁️ Actualizando en Supabase...");const V=await Ue.updateOrder(M,{isDelivered:!0,deliveredDate:new Date});Q(j.map(q=>q.id===M?V:q)),console.log("🔄 Recargando datos desde Supabase..."),await re(),console.log("✅ Datos recargados exitosamente")}catch(V){console.error("❌ Error updating order in Supabase:",V),console.log("⚠️ Error en Supabase, usando modo local"),Q(j.map(q=>q.id===M?{...q,isDelivered:!0,deliveredDate:new Date}:q)),await be(M)}else console.log("💻 Modo local: actualizando pedido y deduciendo inventario"),Q(j.map(V=>V.id===M?{...V,isDelivered:!0,deliveredDate:new Date}:V)),await be(M)},Ie=async M=>{const ie=j.find(q=>q.id===M);if(!ie||ie.isPaid)return;const V=ie.items.reduce((q,oe)=>{const _e=(oe.saleType==="unit",oe.quantity);return q+_e},0);if(await Wt("income",`Venta ${ie.userName} (${V} galletas)`,ie.total,"Ventas"),t)try{const q=await Ue.updateOrder(M,{isPaid:!0,paidDate:new Date});Q(j.map(oe=>oe.id===M?q:oe))}catch(q){console.error("Error updating order:",q),Q(j.map(oe=>oe.id===M?{...oe,isPaid:!0,paidDate:new Date}:oe))}else Q(j.map(q=>q.id===M?{...q,isPaid:!0,paidDate:new Date}:q))},Pr=async M=>{if(j.find(V=>V.id===M))if(console.log("🗑️ Eliminando pedido:",M),t)try{console.log("☁️ Eliminando en Supabase..."),await Ue.deleteOrder(M),Q(j.filter(q=>q.id!==M));const V=T.filter(q=>q.orderId===M);for(const q of V)await Ue.deleteFinancialRecord(q.id);ye(T.filter(q=>q.orderId!==M)),console.log("✅ Pedido eliminado exitosamente")}catch(V){console.error("❌ Error eliminando pedido en Supabase:",V),Q(j.filter(q=>q.id!==M)),ye(T.filter(q=>q.orderId!==M))}else console.log("💻 Modo local: eliminando pedido"),Q(j.filter(V=>V.id!==M)),ye(T.filter(V=>V.orderId!==M))},Ze=async()=>{if(!(!c||w.length===0||s)){a(!0);try{const M=w.reduce((V,q)=>V+q.total,0),ie={userId:c.id,userName:c.name,items:[...w],total:M};if(t)try{console.log("Completando venta en Supabase:",ie);const V=await Ue.createSale(ie);console.log("Venta completada:",V),G([V,...g]),await xe(c.id,w),await De(V),de()}catch(V){console.error("Error completing sale:",V);const q={...ie,id:qe(),date:new Date};G([q,...g]),await xe(c.id,w),await De(q),de()}else{const V={...ie,id:qe(),date:new Date};G([V,...g]),await xe(c.id,w),await De(V),de()}}catch(M){console.error("Error completing sale:",M)}finally{a(!1)}}},de=()=>{y([])},Wt=async(M,ie,V,q)=>{const oe={type:M,description:ie,amount:V,category:q};if(t)try{console.log("Creando registro financiero en Supabase:",oe);const _e=await Ue.createFinancialRecord(oe);console.log("Registro financiero creado:",_e),ye([_e,...T])}catch(_e){console.error("Error creating financial record:",_e);const Re={...oe,id:qe(),date:new Date};ye([Re,...T])}else{const _e={...oe,id:qe(),date:new Date};ye([_e,...T])}},Dr=async(M,ie,V,q,oe)=>{const _e={type:ie,description:V,amount:q,category:oe};if(t)try{const Re=await Ue.updateFinancialRecord(M,_e);ye(T.map(je=>je.id===M?Re:je))}catch(Re){console.error("Error updating financial record:",Re),ye(T.map(je=>je.id===M?{...je,..._e}:je))}else ye(T.map(Re=>Re.id===M?{...Re,..._e}:Re))},sn=async M=>{if(t)try{await Ue.deleteFinancialRecord(M),ye(T.filter(ie=>ie.id!==M))}catch(ie){console.error("Error deleting financial record:",ie),ye(T.filter(V=>V.id!==M))}else ye(T.filter(ie=>ie.id!==M))};return f.jsx(Bx.Provider,{value:{isConnected:t,isLoading:n||r,users:o,currentUser:c,addUser:F,updateUser:U,selectUser:D,setUsers:A,flavors:d,addFlavor:P,toggleFlavorAvailability:J,setFlavors:R,inventory:p,inventoryMovements:m,addToInventory:pe,setInventory:K,currentSale:w,isCompletingSale:s,addToSale:ve,removeFromSale:ge,updateSaleItemQuantity:ue,completeSale:Ze,clearSale:de,sales:g,setSales:G,orders:j,addOrder:De,markOrderPrepared:Oe,markOrderDelivered:Tt,markOrderPaid:Ie,deleteOrder:Pr,setOrders:Q,financialRecords:T,addFinancialRecord:Wt,updateFinancialRecord:Dr,deleteFinancialRecord:sn,setFinancialRecords:ye,syncData:Se,loadData:re},children:e})},er=()=>{const e=H.useContext(Bx);if(e===void 0)throw new Error("useAppContext must be used within an AppProvider");return e},Ux=H.createContext(void 0),Vh=30*60*1e3,hu="roskuki_session",Mo="roskuki_session_timestamp",UE=({children:e})=>{const[t,r]=H.useState(!1),[n,i]=H.useState(!0),[s,a]=H.useState(null);H.useEffect(()=>{o()},[]),H.useEffect(()=>{if(t){const h=setInterval(()=>{const p=localStorage.getItem(Mo);if(p){const v=parseInt(p);Date.now()-v>Vh&&(console.log("🕐 Sesión expirada, cerrando automáticamente..."),c())}},6e4);return()=>clearInterval(h)}},[t]);const o=()=>{try{const d=localStorage.getItem(hu),h=localStorage.getItem(Mo);if(d&&h){const p=parseInt(h);if(Date.now()-p<Vh){const m=JSON.parse(d);a(m),r(!0),console.log("✅ Sesión válida encontrada, usuario autenticado")}else console.log("⏰ Sesión expirada, limpiando..."),u()}}catch(d){console.error("❌ Error al verificar sesión:",d),u()}finally{i(!1)}},l=async(d,h)=>{i(!0);try{await new Promise(m=>setTimeout(m,1e3));const p="admin",v="roskuki2025";if(console.log("🔐 Verificando credenciales..."),d===p&&h===v){const m={username:d},x=Date.now();return localStorage.setItem(hu,JSON.stringify(m)),localStorage.setItem(Mo,x.toString()),a(m),r(!0),console.log("✅ Login exitoso, sesión iniciada"),!0}else return console.log("❌ Credenciales incorrectas"),!1}catch(p){return console.error("❌ Error durante el login:",p),!1}finally{i(!1)}},c=()=>{console.log("🚪 Cerrando sesión..."),u(),r(!1),a(null)},u=()=>{localStorage.removeItem(hu),localStorage.removeItem(Mo)};return f.jsx(Ux.Provider,{value:{isAuthenticated:t,isLoading:n,login:l,logout:c,user:s},children:e})},$x=()=>{const e=H.useContext(Ux);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $E={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zE=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ne=(e,t)=>{const r=H.forwardRef(({color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,...c},u)=>H.createElement("svg",{ref:u,...$E,width:i,height:i,stroke:n,strokeWidth:a?Number(s)*24/Number(i):s,className:["lucide",`lucide-${zE(e)}`,o].join(" "),...c},[...t.map(([d,h])=>H.createElement(d,h)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WE=Ne("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gh=Ne("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kh=Ne("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qh=Ne("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xh=Ne("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jl=Ne("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HE=Ne("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VE=Ne("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GE=Ne("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KE=Ne("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qE=Ne("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XE=Ne("CloudOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5.782 5.782A7 7 0 0 0 9 19h8.5a4.5 4.5 0 0 0 1.307-.193",key:"yfwify"}],["path",{d:"M21.532 16.5A4.5 4.5 0 0 0 17.5 10h-1.79A7.008 7.008 0 0 0 10 5.07",key:"jlfiyv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YE=Ne("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const En=Ne("Cookie",[["path",{d:"M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5",key:"laymnq"}],["path",{d:"M8.5 8.5v.01",key:"ue8clq"}],["path",{d:"M16 15.5v.01",key:"14dtrp"}],["path",{d:"M12 12v.01",key:"u5ubse"}],["path",{d:"M11 17v.01",key:"1hyl5a"}],["path",{d:"M7 14v.01",key:"uct60s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yh=Ne("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N0=Ne("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=Ne("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JE=Ne("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QE=Ne("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jh=Ne("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zx=Ne("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=Ne("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZE=Ne("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eT=Ne("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qh=Ne("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tT=Ne("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rT=Ne("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nT=Ne("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=Ne("Package2",[["path",{d:"M3 9h18v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9Z",key:"1ront0"}],["path",{d:"m3 9 2.45-4.9A2 2 0 0 1 7.24 3h9.52a2 2 0 0 1 1.8 1.1L21 9",key:"19h2x1"}],["path",{d:"M12 3v6",key:"1holv5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=Ne("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wx=Ne("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iT=Ne("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=Ne("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sT=Ne("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rf=Ne("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=Ne("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lf=Ne("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zh=Ne("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rl=Ne("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hx=Ne("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C0=Ne("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sc=Ne("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ep=()=>{const{isConnected:e}=Mx();return f.jsx("div",{className:`flex items-center px-3 py-1 rounded-full text-xs ${e?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:e?f.jsxs(f.Fragment,{children:[f.jsx(YE,{className:"h-3 w-3 mr-1"}),"Sincronizado"]}):f.jsxs(f.Fragment,{children:[f.jsx(XE,{className:"h-3 w-3 mr-1"}),"Solo local"]})})},tp=()=>{const[e,t]=H.useState(!1),{users:r,setUsers:n,sales:i,setSales:s,orders:a,setOrders:o,inventory:l,setInventory:c,financialRecords:u,setFinancialRecords:d,flavors:h,setFlavors:p}=er(),v=async()=>{t(!0);try{const m=await Ue.getUsers(),x=await Ue.getSales(),w=await Ue.getOrders(),y=await Ue.getInventory(),g=await Ue.getFinancialRecords(),k=await Ue.getFlavors();n(m),s(x),o(w),c(y),d(g),p(k),alert("Datos descargados exitosamente")}catch(m){console.error("Error al descargar:",m),alert("Error al descargar datos")}finally{t(!1)}};return f.jsxs("div",{className:"flex space-x-2",children:[f.jsxs("button",{onClick:v,disabled:e,className:"flex items-center px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 text-sm",children:[f.jsx(Pl,{className:"h-4 w-4 mr-1"}),"Descargar"]}),e&&f.jsx(sT,{className:"h-5 w-5 animate-spin text-amber-600"})]})},aT=({children:e})=>{const[t,r]=Zp.useState(!1),n=Rs(),{isConnected:i,isLoading:s}=er(),{logout:a,user:o}=$x(),l=[{path:"/ventas",label:"Ventas",icon:f.jsx(Il,{className:"w-5 h-5"})},{path:"/orders",label:"Pedidos",icon:f.jsx(KE,{className:"w-5 h-5"})},{path:"/inventory",label:"Inventario",icon:f.jsx(hr,{className:"w-5 h-5"})},{path:"/financial",label:"Finanzas",icon:f.jsx(jl,{className:"w-5 h-5"})},{path:"/customers",label:"Clientes",icon:f.jsx(C0,{className:"w-5 h-5"})},{path:"/backup",label:"Exportar",icon:f.jsx(Pl,{className:"w-5 h-5"})}],c=()=>r(!t),u=()=>{window.confirm("¿Estás seguro de que quieres cerrar sesión?")&&a()};return f.jsxs("div",{className:"min-h-screen bg-amber-50 flex flex-col",children:[f.jsx("header",{className:"bg-gradient-to-r from-amber-700 to-amber-600 text-white shadow-md",children:f.jsxs("div",{className:"container mx-auto px-4 py-3 flex justify-between items-center",children:[f.jsxs(au,{to:"/ventas",className:"flex items-center space-x-2 font-bold text-xl hover:text-amber-100 transition-colors",children:[f.jsx(En,{className:"h-8 w-8"}),f.jsx("span",{children:"Controlador Roskuki"})]}),f.jsxs("div",{className:"hidden md:flex items-center space-x-4",children:[f.jsxs("div",{className:"flex items-center space-x-2 bg-amber-800/30 rounded-lg px-3 py-1",children:[f.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),f.jsx("span",{className:"text-sm font-medium",children:o==null?void 0:o.username})]}),f.jsx(ep,{}),i&&f.jsx(tp,{}),s&&f.jsx("div",{className:"text-amber-100 text-sm",children:"Sincronizando..."}),f.jsxs("button",{onClick:u,className:"flex items-center px-3 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors text-sm",title:"Cerrar sesión",children:[f.jsx(Qh,{className:"h-4 w-4 mr-1"}),"Salir"]})]}),f.jsx("button",{onClick:c,className:"md:hidden p-2 rounded-full hover:bg-amber-800 focus:outline-none focus:ring-2 focus:ring-amber-300",children:t?f.jsx(Sc,{className:"h-6 w-6"}):f.jsx(nT,{className:"h-6 w-6"})}),f.jsx("nav",{className:"hidden md:flex space-x-1",children:l.map(d=>f.jsxs(au,{to:d.path,className:`px-4 py-2 rounded-lg flex items-center space-x-1 transition-all ${n.pathname===d.path?"bg-amber-800 text-white font-medium":"text-amber-100 hover:bg-amber-800/50"}`,children:[d.icon,f.jsx("span",{children:d.label})]},d.path))})]})}),t&&f.jsx("div",{className:"md:hidden bg-amber-700 text-white",children:f.jsxs("div",{className:"container mx-auto px-4 py-2",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4 pb-2 border-b border-amber-600",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"}),f.jsx("span",{className:"text-sm font-medium",children:o==null?void 0:o.username})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ep,{}),i&&f.jsx(tp,{}),f.jsxs("button",{onClick:u,className:"flex items-center px-2 py-1 bg-red-600 hover:bg-red-700 rounded text-xs",children:[f.jsx(Qh,{className:"h-3 w-3 mr-1"}),"Salir"]})]})]}),f.jsx("nav",{className:"flex flex-col",children:l.map(d=>f.jsxs(au,{to:d.path,onClick:()=>r(!1),className:`px-4 py-3 rounded-lg flex items-center space-x-2 transition-all ${n.pathname===d.path?"bg-amber-800 font-medium":"hover:bg-amber-800/50"}`,children:[d.icon,f.jsx("span",{children:d.label})]},d.path))})]})}),!i&&f.jsx("div",{className:"bg-yellow-100 border-b border-yellow-200 px-4 py-2",children:f.jsx("div",{className:"container mx-auto",children:f.jsxs("p",{className:"text-yellow-800 text-sm text-center",children:["⚠️ Trabajando en modo local. Los datos no se sincronizan entre dispositivos.",s&&" Intentando conectar..."]})})}),s&&f.jsx("div",{className:"bg-blue-100 border-b border-blue-200 px-4 py-2",children:f.jsx("div",{className:"container mx-auto",children:f.jsx("p",{className:"text-blue-800 text-sm text-center",children:"🔄 Cargando datos..."})})}),f.jsx("main",{className:"flex-grow container mx-auto px-4 py-6",children:e}),f.jsx("footer",{className:"bg-amber-800 text-amber-100 py-4",children:f.jsx("div",{className:"container mx-auto px-4 text-center",children:f.jsxs("p",{children:["© ",new Date().getFullYear()," Controlador Roskuki"]})})})]})},oT=({onLogin:e,isLoading:t})=>{const[r,n]=H.useState(""),[i,s]=H.useState(""),[a,o]=H.useState(!1),[l,c]=H.useState(""),u=async d=>{if(d.preventDefault(),c(""),!r.trim()||!i.trim()){c("Por favor ingresa usuario y contraseña");return}try{await e(r,i)||(c("Usuario o contraseña incorrectos"),n(""),s(""))}catch(h){c("Error al iniciar sesión. Intenta de nuevo."),console.error("Login error:",h)}};return f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-amber-50 via-orange-50 to-amber-100 flex items-center justify-center p-4",children:f.jsxs("div",{className:"w-full max-w-md",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-amber-600 to-amber-700 rounded-full mb-4 shadow-lg",children:f.jsx(En,{className:"w-10 h-10 text-white"})}),f.jsx("h1",{className:"text-3xl font-bold text-amber-900 mb-2",children:"Controlador Roskuki"}),f.jsx("p",{className:"text-amber-700",children:"Sistema de Gestión de Inventario"})]}),f.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-amber-100",children:[f.jsxs("div",{className:"text-center mb-6",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:"Iniciar Sesión"}),f.jsx("p",{className:"text-gray-600",children:"Ingresa tus credenciales para acceder"})]}),f.jsxs("form",{onSubmit:u,className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Usuario"}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(Hx,{className:"h-5 w-5 text-gray-400"})}),f.jsx("input",{type:"text",id:"username",value:r,onChange:d=>n(d.target.value),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors",placeholder:"Ingresa tu usuario",disabled:t,autoComplete:"username"})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Contraseña"}),f.jsxs("div",{className:"relative",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx(eT,{className:"h-5 w-5 text-gray-400"})}),f.jsx("input",{type:a?"text":"password",id:"password",value:i,onChange:d=>s(d.target.value),className:"block w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500 transition-colors",placeholder:"Ingresa tu contraseña",disabled:t,autoComplete:"current-password"}),f.jsx("button",{type:"button",onClick:()=>o(!a),className:"absolute inset-y-0 right-0 pr-3 flex items-center",disabled:t,children:a?f.jsx(JE,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):f.jsx(QE,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]})]}),l&&f.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:f.jsx("p",{className:"text-red-700 text-sm text-center",children:l})}),f.jsx("button",{type:"submit",disabled:t,className:`w-full py-3 px-4 rounded-lg font-medium transition-all duration-200 ${t?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-amber-600 to-amber-700 hover:from-amber-700 hover:to-amber-800 text-white shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"}`,children:t?f.jsxs("div",{className:"flex items-center justify-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-500 mr-2"}),"Verificando..."]}):"Iniciar Sesión"})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsx("p",{className:"text-xs text-gray-500",children:"La sesión se mantendrá activa por 30 minutos"})})]}),f.jsx("div",{className:"text-center mt-8",children:f.jsxs("p",{className:"text-sm text-amber-700",children:["© ",new Date().getFullYear()," Controlador Roskuki - Sistema Seguro"]})})]})})},lT=()=>{const{users:e,currentUser:t,addUser:r,selectUser:n}=er(),[i,s]=H.useState(!1),[a,o]=H.useState(""),[l,c]=H.useState(""),[u,d]=H.useState(""),h=p=>{p.preventDefault(),a.trim()&&(r(a,l,u),o(""),c(""),d(""),s(!1))};return f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5 mb-6",children:[f.jsxs("h2",{className:"text-xl font-semibold text-amber-800 mb-4 flex items-center",children:[f.jsx(Hx,{className:"mr-2 h-5 w-5"})," Cliente"]}),i?f.jsxs("form",{onSubmit:h,className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700",children:"Nombre *"}),f.jsx("input",{type:"text",id:"name",value:a,onChange:p=>o(p.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50",placeholder:"Nombre del cliente",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),f.jsx("input",{type:"email",id:"email",value:l,onChange:p=>c(p.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50",placeholder:"Email (opcional)"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Teléfono"}),f.jsx("input",{type:"tel",id:"phone",value:u,onChange:p=>d(p.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50",placeholder:"Teléfono (opcional)"})]}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("button",{type:"submit",className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-opacity-50 transition-colors",children:"Guardar"}),f.jsx("button",{type:"button",onClick:()=>s(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-opacity-50 transition-colors",children:"Cancelar"})]})]}):f.jsx("div",{children:t?f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-gray-800",children:t.name}),t.email&&f.jsx("p",{className:"text-sm text-gray-500",children:t.email}),t.phone&&f.jsx("p",{className:"text-sm text-gray-500",children:t.phone})]}),f.jsx("button",{onClick:()=>n(""),className:"p-1 text-gray-400 hover:text-gray-600","aria-label":"Cambiar cliente",children:f.jsx(Sc,{className:"h-5 w-5"})})]}):f.jsx("div",{children:e.length>0?f.jsxs("div",{className:"space-y-3",children:[f.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Selecciona un cliente existente:"}),f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 mb-4",children:e.map(p=>f.jsxs("button",{onClick:()=>n(p.id),className:"text-left px-3 py-2 border border-gray-200 rounded-md hover:bg-amber-50 hover:border-amber-200 transition-colors",children:[f.jsx("p",{className:"font-medium",children:p.name}),p.email&&f.jsx("p",{className:"text-xs text-gray-500",children:p.email})]},p.id))}),f.jsx("div",{className:"flex justify-center",children:f.jsxs("button",{onClick:()=>s(!0),className:"flex items-center px-4 py-2 text-amber-700 border border-amber-300 rounded-md bg-amber-50 hover:bg-amber-100 transition-colors",children:[f.jsx(Rl,{className:"h-4 w-4 mr-1"}),"Crear nuevo cliente"]})})]}):f.jsxs("div",{className:"text-center py-4",children:[f.jsx("p",{className:"text-gray-600 mb-4",children:"No hay clientes registrados"}),f.jsxs("button",{onClick:()=>s(!0),className:"flex items-center mx-auto px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 transition-colors",children:[f.jsx(Rl,{className:"h-4 w-4 mr-2"}),"Crear primer cliente"]})]})})})]})},cT=()=>{const{flavors:e,addToSale:t}=er(),[r,n]=H.useState("medium"),[i,s]=H.useState("unit"),[a,o]=H.useState(1),[l,c]=H.useState({}),u=e.filter(x=>x.available),d=Object.values(l).reduce((x,w)=>x+w,0),h=()=>i==="box4"?4:i==="box6"?6:1/0,p=(x=r)=>{if(x==="medium")switch(i){case"box4":return 16e3/4;case"box6":return 25e3/6;default:return 4500}else switch(i){case"box4":return 22e3/4;case"box6":return 35e3/6;default:return 6e3}},v=(x,w)=>{const y=l[x]||0,g=Math.max(0,y+w),k=h();Object.entries(l).reduce((O,[T,I])=>T===x?O:O+I,0)+g<=k&&c(O=>({...O,[x]:g}))},m=()=>{if(Object.keys(l).length>0){const x=p(),w=i==="unit"?void 0:i==="box4"?4:6;Object.entries(l).forEach(([y,g])=>{if(g>0){const k=i==="unit"?g:g*a;t(y,r,k,x,i,w)}}),c({})}};return f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5 mb-6",children:[f.jsxs("h2",{className:"text-xl font-semibold text-amber-800 mb-4 flex items-center",children:[f.jsx(En,{className:"mr-2 h-5 w-5"})," Seleccionar Galletas"]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tamaño"}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsxs("button",{type:"button",onClick:()=>n("medium"),className:`flex-1 py-2 px-4 rounded-md text-center ${r==="medium"?"bg-amber-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:["Mediana ($",p("medium").toFixed(2),")"]}),f.jsxs("button",{type:"button",onClick:()=>n("large"),className:`flex-1 py-2 px-4 rounded-md text-center ${r==="large"?"bg-amber-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:["Grande ($",p("large").toFixed(2),")"]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Venta"}),f.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[f.jsxs("button",{type:"button",onClick:()=>{s("unit"),c({})},className:`py-2 px-3 rounded-md text-center flex items-center justify-center ${i==="unit"?"bg-amber-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:[f.jsx(En,{className:"h-4 w-4 mr-1"}),"Unidades"]}),f.jsxs("button",{type:"button",onClick:()=>{s("box4"),c({})},className:`py-2 px-3 rounded-md text-center flex items-center justify-center ${i==="box4"?"bg-amber-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:[f.jsx(mn,{className:"h-4 w-4 mr-1"}),"Caja x4"]}),f.jsxs("button",{type:"button",onClick:()=>{s("box6"),c({})},className:`py-2 px-3 rounded-md text-center flex items-center justify-center ${i==="box6"?"bg-amber-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:[f.jsx(mn,{className:"h-4 w-4 mr-1"}),"Caja x6"]})]})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Sabores ",i!=="unit"&&`(${d}/${h()} galletas)`]}),f.jsx("div",{className:"space-y-2",children:u.map(x=>f.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-lg",children:[f.jsx("span",{className:"text-gray-700",children:x.name}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("button",{type:"button",onClick:()=>v(x.name,-1),className:"px-2 py-1 bg-gray-200 rounded-l hover:bg-gray-300 transition-colors",disabled:!l[x.name],children:"-"}),f.jsx("span",{className:"w-8 text-center",children:l[x.name]||0}),f.jsx("button",{type:"button",onClick:()=>v(x.name,1),className:"px-2 py-1 bg-gray-200 rounded-r hover:bg-gray-300 transition-colors",disabled:d>=h(),children:"+"})]})]},x.id))})]}),i!=="unit"&&f.jsxs("div",{children:[f.jsx("label",{htmlFor:"quantity",className:"block text-sm font-medium text-gray-700 mb-1",children:"Cantidad de Cajas"}),f.jsxs("div",{className:"flex rounded-md shadow-sm",children:[f.jsx("button",{type:"button",onClick:()=>o(Math.max(1,a-1)),className:"px-3 py-2 bg-gray-100 border border-gray-300 rounded-l-md hover:bg-gray-200 transition-colors",children:"-"}),f.jsx("input",{type:"number",id:"quantity",min:"1",value:a,onChange:x=>o(Math.max(1,parseInt(x.target.value)||1)),className:"flex-1 border-y border-gray-300 text-center focus:ring focus:ring-amber-200 focus:ring-opacity-50 focus:border-amber-500"}),f.jsx("button",{type:"button",onClick:()=>o(a+1),className:"px-3 py-2 bg-gray-100 border border-gray-300 rounded-r-md hover:bg-gray-200 transition-colors",children:"+"})]})]}),f.jsxs("button",{type:"button",onClick:m,disabled:d===0||i!=="unit"&&d!==h(),className:`w-full py-2 px-4 rounded-md flex items-center justify-center space-x-2 ${d>0&&(i==="unit"||d===h())?"bg-amber-600 hover:bg-amber-700 text-white":"bg-gray-200 text-gray-500 cursor-not-allowed"} transition-colors`,children:[f.jsx(Dl,{className:"h-4 w-4"}),f.jsx("span",{children:"Añadir al Carrito"})]}),i!=="unit"&&d!==h()&&f.jsxs("p",{className:"text-sm text-red-500 text-center",children:["Debes seleccionar exactamente ",h()," galletas para completar la caja"]})]})]})},uT=()=>{const{currentSale:e,currentUser:t,removeFromSale:r,updateSaleItemQuantity:n,completeSale:i,isCompletingSale:s}=er(),a=e.reduce((h,p)=>h+p.total,0),o=(h,p)=>{s||(p>0?n(h,p):r(h))},l=h=>{s||r(h)},c=async()=>{s||await i()},u=(h,p)=>{switch(h){case"box4":return`Caja x4 (${p} galletas)`;case"box6":return`Caja x6 (${p} galletas)`;default:return"Unidades"}},d=!t||e.length===0||s;return f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5",children:[f.jsxs("h2",{className:"text-xl font-semibold text-amber-800 mb-4 flex items-center",children:[f.jsx(Il,{className:"mr-2 h-5 w-5"})," Carrito de Compra"]}),e.length===0?f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(Il,{className:"h-12 w-12 mx-auto mb-2 opacity-30"}),f.jsx("p",{children:"El carrito está vacío"}),f.jsx("p",{className:"text-sm",children:"Añade galletas para comenzar una venta"})]}):f.jsxs("div",{children:[f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Galleta"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tamaño"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Precio"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cant."}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(h=>f.jsxs("tr",{className:`hover:bg-gray-50 ${s?"opacity-60":""}`,children:[f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:h.flavor}),f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:h.size==="medium"?"Mediana":"Grande"}),f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:f.jsxs("span",{className:"flex items-center",children:[h.saleType!=="unit"&&f.jsx(mn,{className:"h-4 w-4 mr-1"}),u(h.saleType,h.boxQuantity)]})}),f.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500 text-right",children:["$",h.price.toFixed(2)]}),f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:f.jsxs("div",{className:"flex items-center justify-center",children:[f.jsx("button",{type:"button",onClick:()=>o(h.id,h.quantity-1),disabled:s,className:`px-2 py-1 rounded-l border border-gray-300 transition-colors ${s?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-100 hover:bg-gray-200 text-gray-700"}`,children:"-"}),f.jsx("span",{className:"w-10 py-1 text-center border-t border-b border-gray-300 bg-white",children:h.quantity}),f.jsx("button",{type:"button",onClick:()=>o(h.id,h.quantity+1),disabled:s,className:`px-2 py-1 rounded-r border border-gray-300 transition-colors ${s?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-100 hover:bg-gray-200 text-gray-700"}`,children:"+"})]})}),f.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-right",children:["$",h.total.toFixed(2)]}),f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-right text-sm font-medium",children:f.jsx("button",{onClick:()=>l(h.id),disabled:s,className:`transition-colors ${s?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-800"}`,title:s?"Procesando venta...":"Eliminar item",children:f.jsx(Lf,{className:"h-4 w-4"})})})]},h.id))}),f.jsx("tfoot",{children:f.jsxs("tr",{className:"bg-amber-50",children:[f.jsx("td",{colSpan:5,className:"px-3 py-3 text-right text-sm font-bold text-gray-900",children:"Total:"}),f.jsxs("td",{className:"px-3 py-3 text-right text-sm font-bold text-gray-900",children:["$",a.toFixed(2)]}),f.jsx("td",{})]})})]})}),f.jsxs("div",{className:"mt-6 flex flex-col items-center space-y-3",children:[f.jsx("button",{type:"button",onClick:c,disabled:d,className:`py-3 px-8 rounded-lg flex items-center space-x-3 transition-all duration-200 font-medium text-lg ${d?"bg-gray-300 text-gray-500 cursor-not-allowed shadow-none":"bg-amber-600 hover:bg-amber-700 text-white shadow-lg hover:shadow-xl transform hover:-translate-y-1"}`,children:s?f.jsxs(f.Fragment,{children:[f.jsx(ZE,{className:"h-6 w-6 animate-spin"}),f.jsx("span",{children:"Procesando Venta..."})]}):f.jsxs(f.Fragment,{children:[f.jsx(Rf,{className:"h-6 w-6"}),f.jsx("span",{children:"Completar Venta"})]})}),!t&&!s&&f.jsx("p",{className:"text-center text-sm text-red-500 bg-red-50 px-4 py-2 rounded-lg border border-red-200",children:"⚠️ Debes seleccionar un cliente para completar la venta"}),s&&f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-sm text-blue-600 bg-blue-50 px-4 py-2 rounded-lg border border-blue-200 mb-2",children:"🔄 Procesando venta, por favor espera..."}),f.jsx("p",{className:"text-xs text-gray-500",children:"No cierres esta ventana ni hagas clic nuevamente"})]})]})]})]})},fT=()=>{const{sales:e}=er(),t=(r,n)=>{switch(r){case"box4":return`Caja x4 (${n} galletas)`;case"box6":return`Caja x6 (${n} galletas)`;default:return"Unidades"}};return f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5",children:[f.jsxs("h2",{className:"text-xl font-semibold text-amber-800 mb-4 flex items-center",children:[f.jsx(As,{className:"mr-2 h-5 w-5"})," Historial de Ventas"]}),e.length===0?f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(As,{className:"h-12 w-12 mx-auto mb-2 opacity-30"}),f.jsx("p",{children:"No hay ventas registradas"}),f.jsx("p",{className:"text-sm",children:"Las ventas completadas aparecerán aquí"})]}):f.jsx("div",{className:"space-y-4",children:e.map(r=>f.jsxs("div",{className:"border border-amber-100 rounded-lg p-4 bg-amber-50",children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-amber-900",children:r.userName}),f.jsxs("p",{className:"text-sm text-gray-600",children:[new Date(r.date).toLocaleDateString()," ",new Date(r.date).toLocaleTimeString()]})]}),f.jsxs("span",{className:"text-lg font-bold text-amber-900",children:["$",r.total.toFixed(2)]})]}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full divide-y divide-amber-200",children:[f.jsx("thead",{className:"bg-amber-50",children:f.jsxs("tr",{children:[f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-amber-800 uppercase tracking-wider",children:"Galleta"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-amber-800 uppercase tracking-wider",children:"Tamaño"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-amber-800 uppercase tracking-wider",children:"Tipo"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-right text-xs font-medium text-amber-800 uppercase tracking-wider",children:"Precio"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-center text-xs font-medium text-amber-800 uppercase tracking-wider",children:"Cant."}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-right text-xs font-medium text-amber-800 uppercase tracking-wider",children:"Total"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-amber-100",children:r.items.map(n=>f.jsxs("tr",{children:[f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:n.flavor}),f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:n.size==="medium"?"Mediana":"Grande"}),f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:f.jsxs("span",{className:"flex items-center",children:[n.saleType!=="unit"&&f.jsx(mn,{className:"h-4 w-4 mr-1"}),t(n.saleType,n.boxQuantity)]})}),f.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500 text-right",children:["$",n.price.toFixed(2)]}),f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500 text-center",children:n.quantity}),f.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-medium text-amber-900 text-right",children:["$",n.total.toFixed(2)]})]},n.id))})]})})]},r.id))})]})},dT=()=>{const[e,t]=H.useState("current");return f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-amber-900 mb-6",children:"Gestión de Ventas"}),f.jsxs("div",{className:"flex space-x-2 mb-6",children:[f.jsxs("button",{onClick:()=>t("current"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${e==="current"?"bg-amber-600 text-white":"bg-amber-100 text-amber-800 hover:bg-amber-200"}`,children:[f.jsx(Il,{className:"h-5 w-5 mr-2"}),"Venta Actual"]}),f.jsxs("button",{onClick:()=>t("history"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${e==="history"?"bg-amber-600 text-white":"bg-amber-100 text-amber-800 hover:bg-amber-200"}`,children:[f.jsx(As,{className:"h-5 w-5 mr-2"}),"Historial"]})]}),e==="current"?f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[f.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[f.jsx(lT,{}),f.jsx(cT,{})]}),f.jsx("div",{className:"lg:col-span-2",children:f.jsx(uT,{})})]}):f.jsx(fT,{})]})},hT=()=>{const{orders:e,markOrderPrepared:t,markOrderDelivered:r,markOrderPaid:n,deleteOrder:i}=er(),[s,a]=H.useState(0),[o,l]=H.useState(null),c=10,u=(A,R)=>{switch(A){case"box4":return`Caja x4 (${R} galletas)`;case"box6":return`Caja x6 (${R} galletas)`;default:return"Unidades"}},d=A=>A.reduce((R,K)=>{const G=(K.saleType==="unit",K.quantity);return R+G},0),h=A=>{let R=0,K=0,G=0;return A.forEach(Q=>{Q.saleType==="box4"?R+=Q.quantity:Q.saleType==="box6"?K+=Q.quantity:G+=Q.quantity}),{box4:R/4,box6:K/6,unit:G}},p=A=>A.isPaid?"paid":A.isDelivered?"delivered":A.isPrepared?"prepared":"pending",v=A=>{switch(A){case"delivered":return"bg-blue-50 border-blue-200 text-blue-800";case"prepared":return"bg-green-50 border-green-200 text-green-800";case"paid":return"bg-purple-50 border-purple-200 text-purple-800";default:return"bg-amber-50 border-amber-200 text-amber-800"}},m=A=>{switch(A){case"delivered":return"Entregado";case"prepared":return"Preparado";case"paid":return"Pagado";default:return"Pendiente"}},x=async A=>{const R=e.find(G=>G.id===A);if(!R)return;const K=`¿Estás seguro de que quieres eliminar el pedido de ${R.userName}?

Esta acción eliminará:
- El pedido y todos sus items
- Los registros financieros relacionados

Esta acción NO se puede deshacer.`;if(window.confirm(K)){l(A);try{await i(A),console.log("✅ Pedido eliminado exitosamente")}catch(G){console.error("❌ Error eliminando pedido:",G),alert("Error al eliminar el pedido. Por favor intenta de nuevo.")}finally{l(null)}}},w=[...e].sort((A,R)=>{const K=p(A),G=p(R);return K==="pending"&&G!=="pending"?-1:K!=="pending"&&G==="pending"?1:new Date(R.date).getTime()-new Date(A.date).getTime()}),y=Math.ceil(w.length/c),g=s*c,k=g+c,j=w.slice(g,k),O=()=>{s<y-1&&a(s+1)},T=()=>{s>0&&a(s-1)},I=A=>{a(A)};return f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsxs("h2",{className:"text-xl font-semibold text-amber-800 flex items-center",children:[f.jsx(mn,{className:"mr-2 h-5 w-5"})," Lista de Pedidos"]}),e.length>0&&f.jsxs("div",{className:"text-sm text-gray-600",children:["Mostrando ",g+1,"-",Math.min(k,w.length)," de ",w.length," pedidos"]})]}),e.length===0?f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(mn,{className:"h-12 w-12 mx-auto mb-2 opacity-30"}),f.jsx("p",{children:"No hay pedidos registrados"}),f.jsx("p",{className:"text-sm",children:"Los pedidos aparecerán aquí cuando se completen ventas"})]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"space-y-4 mb-6",children:j.map(A=>{const R=p(A),K=d(A.items),G=h(A.items),Q=o===A.id;return f.jsxs("div",{className:`border rounded-lg p-4 ${v(R)} ${Q?"opacity-50":""}`,children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h3",{className:"font-semibold text-lg",children:A.userName}),f.jsx("button",{onClick:()=>x(A.id),disabled:Q,className:`p-2 rounded-full transition-colors ${Q?"bg-gray-200 text-gray-400 cursor-not-allowed":"bg-red-100 text-red-600 hover:bg-red-200 hover:text-red-800"}`,title:Q?"Eliminando...":"Eliminar pedido",children:f.jsx(Lf,{className:`h-4 w-4 ${Q?"animate-pulse":""}`})})]}),f.jsxs("p",{className:"text-sm opacity-75",children:["Pedido: ",new Date(A.date).toLocaleDateString()," ",new Date(A.date).toLocaleTimeString()]}),A.preparedDate&&f.jsxs("p",{className:"text-sm opacity-75",children:["Preparado: ",new Date(A.preparedDate).toLocaleDateString()," ",new Date(A.preparedDate).toLocaleTimeString()]}),A.deliveredDate&&f.jsxs("p",{className:"text-sm opacity-75",children:["Entregado: ",new Date(A.deliveredDate).toLocaleDateString()," ",new Date(A.deliveredDate).toLocaleTimeString()]}),A.paidDate&&f.jsxs("p",{className:"text-sm opacity-75",children:["Pagado: ",new Date(A.paidDate).toLocaleDateString()," ",new Date(A.paidDate).toLocaleTimeString()]})]}),f.jsxs("div",{className:"text-right ml-4",children:[f.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${v(R)}`,children:m(R)}),f.jsxs("p",{className:"text-lg font-bold mt-1",children:["$",A.total.toFixed(2)]}),f.jsxs("p",{className:"text-sm opacity-75 flex items-center",children:[f.jsx(En,{className:"h-4 w-4 mr-1"}),K," galletas"]}),f.jsxs("p",{className:"text-xs opacity-75 mt-1",children:[G.box4>0&&`${G.box4} caja(s) x4`,G.box4>0&&(G.box6>0||G.unit>0)&&" - ",G.box6>0&&`${G.box6} caja(s) x6`,G.box6>0&&G.unit>0&&" - ",G.unit>0&&`${G.unit} individual(es)`]})]})]}),f.jsxs("div",{className:"mb-4",children:[f.jsx("h4",{className:"text-sm font-medium mb-2",children:"Detalles del pedido:"}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Galleta"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tamaño"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cant."}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.items.map(ye=>f.jsxs("tr",{children:[f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-900",children:ye.flavor}),f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:ye.size==="medium"?"Mediana":"Grande"}),f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:f.jsxs("span",{className:"flex items-center",children:[ye.saleType!=="unit"&&f.jsx(mn,{className:"h-4 w-4 mr-1"}),u(ye.saleType,ye.boxQuantity)]})}),f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500 text-center",children:ye.quantity}),f.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-sm font-medium text-gray-900 text-right",children:["$",ye.total.toFixed(2)]})]},ye.id))})]})})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs("div",{className:`flex items-center px-3 py-1 rounded-full text-xs ${A.isPrepared?"bg-green-100 text-green-800":"bg-gray-100 text-gray-500"}`,children:[f.jsx(HE,{className:"h-4 w-4 mr-1"}),"Preparado ",A.isPrepared?"✓":""]}),f.jsxs("div",{className:`flex items-center px-3 py-1 rounded-full text-xs ${A.isDelivered?"bg-green-100 text-green-800":"bg-gray-100 text-gray-500"}`,children:[f.jsx(Zh,{className:"h-4 w-4 mr-1"}),"Entregado ",A.isDelivered?"✓":""]}),f.jsxs("div",{className:`flex items-center px-3 py-1 rounded-full text-xs ${A.isPaid?"bg-green-100 text-green-800":"bg-gray-100 text-gray-500"}`,children:[f.jsx(N0,{className:"h-4 w-4 mr-1"}),"Pagado ",A.isPaid?"✓":""]})]}),f.jsxs("div",{className:"flex flex-wrap gap-2",children:[!A.isPrepared&&!Q&&f.jsxs("button",{onClick:()=>t(A.id),className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm",children:[f.jsx(qE,{className:"h-4 w-4 mr-1"}),"Marcar como Preparado"]}),!A.isDelivered&&!Q&&f.jsxs("button",{onClick:()=>r(A.id),className:"flex items-center px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm",children:[f.jsx(Zh,{className:"h-4 w-4 mr-1"}),"Marcar como Entregado"]}),!A.isPaid&&!Q&&f.jsxs("button",{onClick:()=>n(A.id),className:"flex items-center px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors text-sm",children:[f.jsx(N0,{className:"h-4 w-4 mr-1"}),"Marcar como Pagado"]}),Q&&f.jsxs("div",{className:"flex items-center px-3 py-2 bg-gray-200 text-gray-500 rounded-md text-sm",children:[f.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-500 mr-2"}),"Eliminando pedido..."]})]})]})]},A.id)})}),y>1&&f.jsxs("div",{className:"flex items-center justify-between border-t border-gray-200 pt-4",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsxs("button",{onClick:T,disabled:s===0,className:`flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors ${s===0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[f.jsx(VE,{className:"h-4 w-4 mr-1"}),"Anterior"]}),f.jsxs("button",{onClick:O,disabled:s===y-1,className:`flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors ${s===y-1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:["Siguiente",f.jsx(GE,{className:"h-4 w-4 ml-1"})]})]}),f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx("span",{className:"text-sm text-gray-700 mr-2",children:"Página:"}),Array.from({length:y},(A,R)=>f.jsx("button",{onClick:()=>I(R),className:`px-3 py-1 rounded-md text-sm font-medium transition-colors ${s===R?"bg-amber-600 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:R+1},R))]}),f.jsxs("div",{className:"text-sm text-gray-700",children:["Página ",s+1," de ",y]})]})]})]})},pT=()=>f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-amber-900 mb-6",children:"Gestión de Pedidos"}),f.jsx("div",{className:"space-y-6",children:f.jsx(hT,{})})]}),mT=()=>{const{flavors:e,addToInventory:t,addFlavor:r}=er(),[n,i]=H.useState(""),[s,a]=H.useState("medium"),[o,l]=H.useState(1),[c,u]=H.useState(!1),[d,h]=H.useState(""),p=m=>{m.preventDefault(),n&&o>0&&(t(n,s,o),l(1))},v=m=>{m.preventDefault(),d.trim()&&(r(d),h(""),u(!1),i(d))};return f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5 mb-6",children:[f.jsxs("h2",{className:"text-xl font-semibold text-amber-800 mb-4 flex items-center",children:[f.jsx(hr,{className:"mr-2 h-5 w-5"})," Añadir al Inventario"]}),c?f.jsxs("form",{onSubmit:v,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"newFlavor",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nuevo Sabor"}),f.jsx("input",{type:"text",id:"newFlavor",value:d,onChange:m=>h(m.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50",placeholder:"Nombre del nuevo sabor",required:!0})]}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("button",{type:"submit",className:"px-4 py-2 bg-amber-600 text-white rounded-md hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-opacity-50 transition-colors",children:"Guardar"}),f.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-opacity-50 transition-colors",children:"Cancelar"})]})]}):f.jsxs("form",{onSubmit:p,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"flavor",className:"block text-sm font-medium text-gray-700 mb-1",children:"Sabor"}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsxs("select",{id:"flavor",value:n,onChange:m=>i(m.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50",required:!0,children:[f.jsx("option",{value:"",children:"Selecciona un sabor"}),e.map(m=>f.jsx("option",{value:m.name,children:m.name},m.id))]}),f.jsx("button",{type:"button",onClick:()=>u(!0),className:"px-3 py-2 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 transition-colors",title:"Añadir nuevo sabor",children:f.jsx(Dl,{className:"h-5 w-5"})})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tamaño"}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("button",{type:"button",onClick:()=>a("medium"),className:`flex-1 py-2 px-4 rounded-md text-center ${s==="medium"?"bg-amber-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"Mediana"}),f.jsx("button",{type:"button",onClick:()=>a("large"),className:`flex-1 py-2 px-4 rounded-md text-center ${s==="large"?"bg-amber-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} transition-colors`,children:"Grande"})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"inventoryQuantity",className:"block text-sm font-medium text-gray-700 mb-1",children:"Cantidad"}),f.jsxs("div",{className:"flex rounded-md shadow-sm",children:[f.jsx("button",{type:"button",onClick:()=>l(Math.max(1,o-1)),className:"px-3 py-2 bg-gray-100 border border-gray-300 rounded-l-md hover:bg-gray-200 transition-colors",children:"-"}),f.jsx("input",{type:"number",id:"inventoryQuantity",min:"1",value:o,onChange:m=>l(Math.max(1,parseInt(m.target.value)||1)),className:"flex-1 border-y border-gray-300 text-center focus:ring focus:ring-amber-200 focus:ring-opacity-50 focus:border-amber-500"}),f.jsx("button",{type:"button",onClick:()=>l(o+1),className:"px-3 py-2 bg-gray-100 border border-gray-300 rounded-r-md hover:bg-gray-200 transition-colors",children:"+"})]})]}),f.jsxs("button",{type:"submit",className:"w-full py-2 px-4 rounded-md bg-amber-600 hover:bg-amber-700 text-white transition-colors flex items-center justify-center",children:[f.jsx(Dl,{className:"h-4 w-4 mr-2"}),"Añadir al Inventario"]})]})]})},xT=()=>{const{inventory:e}=er(),t=e.reduce((s,a)=>{const o=`${a.flavor}-${a.size}`;return s[o]||(s[o]={flavor:a.flavor,size:a.size,totalQuantity:0,items:[]}),s[o].totalQuantity+=a.quantity,s[o].items.push(a),s},{}),r=Object.values(t).filter(s=>s.size==="large").sort((s,a)=>s.flavor.localeCompare(a.flavor)),n=Object.values(t).filter(s=>s.size==="medium").sort((s,a)=>s.flavor.localeCompare(a.flavor)),i=({title:s,items:a,bgColor:o,borderColor:l,textColor:c})=>f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5",children:[f.jsxs("h3",{className:`text-lg font-semibold ${c} mb-4 flex items-center`,children:[f.jsx(hr,{className:"mr-2 h-5 w-5"}),s,f.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",a.length," sabores)"]})]}),a.length===0?f.jsxs("div",{className:"text-center py-6 text-gray-500",children:[f.jsx(hr,{className:"h-8 w-8 mx-auto mb-2 opacity-30"}),f.jsxs("p",{className:"text-sm",children:["No hay galletas ",s.toLowerCase()," en inventario"]})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.map((u,d)=>f.jsxs("div",{className:`border ${l} rounded-lg p-4 ${o} hover:shadow-md transition-shadow`,children:[f.jsxs("div",{className:"flex justify-between items-start mb-2",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h4",{className:`font-medium ${c} text-sm leading-tight`,children:u.flavor}),f.jsx("p",{className:"text-xs text-gray-600 mt-1",children:u.size==="medium"?"Mediana":"Grande"})]}),f.jsx("div",{className:`${o==="bg-blue-50"?"bg-blue-100":"bg-green-100"} rounded-full p-2`,children:f.jsx(En,{className:`h-4 w-4 ${c}`})})]}),f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Cantidad:"}),f.jsx("span",{className:`font-semibold ${c}`,children:u.totalQuantity})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-500",children:"Lotes:"}),f.jsx("span",{className:`font-semibold ${c}`,children:u.items.length})]})]}),f.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Último: ",new Date(u.items[u.items.length-1].createdAt).toLocaleDateString()]})]},d))})]});return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5",children:[f.jsxs("h2",{className:"text-xl font-semibold text-amber-800 mb-4 flex items-center",children:[f.jsx(hr,{className:"mr-2 h-5 w-5"})," Inventario Actual"]}),Object.keys(t).length===0?f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(hr,{className:"h-12 w-12 mx-auto mb-2 opacity-30"}),f.jsx("p",{children:"No hay galletas en el inventario"}),f.jsx("p",{className:"text-sm",children:"Añade galletas para iniciar el inventario"})]}):f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[f.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-100",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Grandes"}),f.jsx(hr,{className:"h-4 w-4 text-blue-600"})]}),f.jsx("p",{className:"text-2xl font-bold text-blue-700 mt-2",children:r.reduce((s,a)=>s+a.totalQuantity,0)}),f.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[r.length," sabores"]})]}),f.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-100",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Medianas"}),f.jsx(hr,{className:"h-4 w-4 text-green-600"})]}),f.jsx("p",{className:"text-2xl font-bold text-green-700 mt-2",children:n.reduce((s,a)=>s+a.totalQuantity,0)}),f.jsxs("p",{className:"text-xs text-green-600 mt-1",children:[n.length," sabores"]})]}),f.jsxs("div",{className:"bg-amber-50 rounded-lg p-4 border border-amber-100",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-amber-800",children:"Total Galletas"}),f.jsx(En,{className:"h-4 w-4 text-amber-600"})]}),f.jsx("p",{className:"text-2xl font-bold text-amber-700 mt-2",children:Object.values(t).reduce((s,a)=>s+a.totalQuantity,0)}),f.jsx("p",{className:"text-xs text-amber-600 mt-1",children:"En inventario"})]}),f.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-100",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-purple-800",children:"Sabores Únicos"}),f.jsx(hr,{className:"h-4 w-4 text-purple-600"})]}),f.jsx("p",{className:"text-2xl font-bold text-purple-700 mt-2",children:Object.keys(t).length}),f.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"Diferentes"})]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsx(i,{title:"Grandes",items:r,bgColor:"bg-blue-50",borderColor:"border-blue-100",textColor:"text-blue-800"}),f.jsx(i,{title:"Medianas",items:n,bgColor:"bg-green-50",borderColor:"border-green-100",textColor:"text-green-800"})]})]})},gT=()=>{const{inventoryMovements:e,inventory:t}=er(),[r,n]=H.useState("all"),[i,s]=H.useState("all"),[a,o]=H.useState("all"),l=(m,x)=>{const w=new Date(m),y=new Date;switch(x){case"today":return w.getDate()===y.getDate()&&w.getMonth()===y.getMonth()&&w.getFullYear()===y.getFullYear();case"week":{const g=new Date;return g.setDate(y.getDate()-7),w>=g}case"month":{const g=new Date;return g.setMonth(y.getMonth()-1),w>=g}default:return!0}},c=e.filter(m=>r==="all"||m.type===r).filter(m=>i==="all"||l(m.date,i)).filter(m=>a==="all"||m.flavor===a).sort((m,x)=>new Date(x.date).getTime()-new Date(m.date).getTime()),u=Array.from(new Set(e.map(m=>m.flavor))),d=c.filter(m=>m.type==="addition").reduce((m,x)=>m+x.quantity,0),h=c.filter(m=>m.type==="deduction").reduce((m,x)=>m+x.quantity,0),p=t.reduce((m,x)=>{const w=`${x.flavor}-${x.size}`;return m[w]||(m[w]={flavor:x.flavor,size:x.size,total:0}),m[w].total+=x.quantity,m},{}),v=Object.values(p).reduce((m,x)=>m+x.total,0);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5",children:[f.jsxs("h2",{className:"text-xl font-semibold text-amber-800 mb-4 flex items-center",children:[f.jsx(hr,{className:"mr-2 h-5 w-5"})," Resumen de Inventario Actual"]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[f.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-100",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Total Galletas"}),f.jsx(hr,{className:"h-4 w-4 text-blue-600"})]}),f.jsx("p",{className:"text-2xl font-bold text-blue-700 mt-2",children:v})]}),f.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-100",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Total Añadidas"}),f.jsx(Xh,{className:"h-4 w-4 text-green-600"})]}),f.jsx("p",{className:"text-2xl font-bold text-green-700 mt-2",children:d})]}),f.jsxs("div",{className:"bg-red-50 rounded-lg p-4 border border-red-100",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Total Deducidas"}),f.jsx(Kh,{className:"h-4 w-4 text-red-600"})]}),f.jsx("p",{className:"text-2xl font-bold text-red-700 mt-2",children:h})]}),f.jsxs("div",{className:"bg-amber-50 rounded-lg p-4 border border-amber-100",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-amber-800",children:"Sabores Únicos"}),f.jsx(hr,{className:"h-4 w-4 text-amber-600"})]}),f.jsx("p",{className:"text-2xl font-bold text-amber-700 mt-2",children:Object.keys(p).length})]})]}),Object.keys(p).length>0&&f.jsxs("div",{className:"overflow-x-auto",children:[f.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Inventario por Sabor y Tamaño"}),f.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sabor"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tamaño"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cantidad"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Object.values(p).map((m,x)=>f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsx("td",{className:"px-3 py-2 text-sm font-medium text-gray-900",children:m.flavor}),f.jsx("td",{className:"px-3 py-2 text-sm text-gray-500",children:m.size==="medium"?"Mediana":"Grande"}),f.jsx("td",{className:"px-3 py-2 text-sm font-medium text-gray-900 text-right",children:m.total})]},x))})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5",children:[f.jsxs("h2",{className:"text-xl font-semibold text-amber-800 mb-4 flex items-center",children:[f.jsx(As,{className:"mr-2 h-5 w-5"})," Historial de Movimientos"]}),f.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-6 gap-2",children:[f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs("select",{value:r,onChange:m=>n(m.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50 text-sm",children:[f.jsx("option",{value:"all",children:"Todos los movimientos"}),f.jsx("option",{value:"addition",children:"Solo añadidas"}),f.jsx("option",{value:"deduction",children:"Solo deducidas"})]}),f.jsxs("select",{value:i,onChange:m=>s(m.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50 text-sm",children:[f.jsx("option",{value:"all",children:"Todos los periodos"}),f.jsx("option",{value:"today",children:"Hoy"}),f.jsx("option",{value:"week",children:"Última semana"}),f.jsx("option",{value:"month",children:"Último mes"})]}),f.jsxs("select",{value:a,onChange:m=>o(m.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50 text-sm",children:[f.jsx("option",{value:"all",children:"Todos los sabores"}),u.map(m=>f.jsx("option",{value:m,children:m},m))]})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx(zx,{className:"h-4 w-4 mr-1 text-gray-500"}),f.jsxs("span",{className:"text-sm text-gray-500",children:["Mostrando ",c.length," movimientos"]})]})]}),c.length>0?f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sabor"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tamaño"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cantidad"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Motivo"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(m=>f.jsxs("tr",{className:"hover:bg-gray-50",children:[f.jsxs("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:[new Date(m.date).toLocaleDateString()," ",new Date(m.date).toLocaleTimeString()]}),f.jsx("td",{className:"px-3 py-2 text-sm font-medium text-gray-900",children:m.flavor}),f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:m.size==="medium"?"Mediana":"Grande"}),f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:f.jsxs("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${m.type==="addition"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[m.type==="addition"?f.jsx(Xh,{className:"h-3 w-3 mr-1"}):f.jsx(Kh,{className:"h-3 w-3 mr-1"}),m.type==="addition"?"Añadida":"Deducida"]})}),f.jsxs("td",{className:`px-3 py-2 whitespace-nowrap text-sm font-medium text-center ${m.type==="addition"?"text-green-600":"text-red-600"}`,children:[m.type==="addition"?"+":"-",m.quantity]}),f.jsx("td",{className:"px-3 py-2 text-sm text-gray-500",children:m.reason})]},m.id))})]})}):f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(As,{className:"h-12 w-12 mx-auto mb-2 opacity-30"}),f.jsx("p",{children:"No hay movimientos para mostrar"}),f.jsx("p",{className:"text-sm",children:"Ajusta los filtros o añade galletas al inventario"})]})]})]})},vT=()=>{const[e,t]=H.useState("management");return f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-amber-900 mb-6",children:"Gestión de Inventario"}),f.jsxs("div",{className:"flex space-x-2 mb-6",children:[f.jsxs("button",{onClick:()=>t("management"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${e==="management"?"bg-amber-600 text-white":"bg-amber-100 text-amber-800 hover:bg-amber-200"}`,children:[f.jsx(hr,{className:"h-5 w-5 mr-2"}),"Gestión de Inventario"]}),f.jsxs("button",{onClick:()=>t("movements"),className:`flex items-center px-4 py-2 rounded-lg transition-colors ${e==="movements"?"bg-amber-600 text-white":"bg-amber-100 text-amber-800 hover:bg-amber-200"}`,children:[f.jsx(As,{className:"h-5 w-5 mr-2"}),"Movimientos de Inventario"]})]}),e==="management"?f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[f.jsx("div",{className:"lg:col-span-1",children:f.jsx(mT,{})}),f.jsx("div",{className:"lg:col-span-2",children:f.jsx(xT,{})})]}):f.jsx(gT,{})]})},yT=()=>{const{addFinancialRecord:e}=er(),[t,r]=H.useState("expense"),[n,i]=H.useState(""),[s,a]=H.useState(""),[o,l]=H.useState(""),c={income:["Ventas","Inversión","Reembolso","Otro"],expense:["Ingredientes","Equipo","Empaque","Marketing","Salarios","Servicios","Otro"]},u=d=>{d.preventDefault(),n&&s&&o&&(e(t,n,parseFloat(s),o),i(""),a(""),l(""))};return f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5 mb-6",children:[f.jsxs("h2",{className:"text-xl font-semibold text-amber-800 mb-4 flex items-center",children:[f.jsx(N0,{className:"mr-2 h-5 w-5"})," Registrar Transacción"]}),f.jsxs("form",{onSubmit:u,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Transacción"}),f.jsxs("div",{className:"flex space-x-2",children:[f.jsx("button",{type:"button",onClick:()=>r("income"),className:`flex-1 py-2 px-4 rounded-md text-center transition-colors ${t==="income"?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Ingreso"}),f.jsx("button",{type:"button",onClick:()=>r("expense"),className:`flex-1 py-2 px-4 rounded-md text-center transition-colors ${t==="expense"?"bg-red-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Gasto"})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción"}),f.jsx("input",{type:"text",id:"description",value:n,onChange:d=>i(d.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50",placeholder:"Descripción de la transacción",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto ($)"}),f.jsxs("div",{className:"relative rounded-md shadow-sm",children:[f.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:f.jsx("span",{className:"text-gray-500 sm:text-sm",children:"$"})}),f.jsx("input",{type:"number",id:"amount",value:s,onChange:d=>a(d.target.value),step:"0.01",min:"0.01",className:"block w-full pl-7 rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50",placeholder:"0.00",required:!0})]})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoría"}),f.jsxs("select",{id:"category",value:o,onChange:d=>l(d.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50",required:!0,children:[f.jsx("option",{value:"",children:"Selecciona una categoría"}),c[t].map(d=>f.jsx("option",{value:d,children:d},d))]})]}),f.jsxs("button",{type:"submit",className:`w-full py-2 px-4 rounded-md text-white transition-colors flex items-center justify-center ${t==="income"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}`,children:[f.jsx(Dl,{className:"h-4 w-4 mr-2"}),"Registrar ",t==="income"?"Ingreso":"Gasto"]})]})]})},wT=()=>{const{financialRecords:e,updateFinancialRecord:t,deleteFinancialRecord:r}=er(),[n,i]=H.useState("all"),[s,a]=H.useState("all"),[o,l]=H.useState(null),[c,u]=H.useState({type:"income",description:"",amount:"",category:""}),d={income:["Ventas","Inversión","Reembolso","Otro"],expense:["Ingredientes","Equipo","Empaque","Marketing","Salarios","Servicios","Otro"]},h=(O,T)=>{const I=new Date(O),A=new Date;switch(T){case"today":return I.getDate()===A.getDate()&&I.getMonth()===A.getMonth()&&I.getFullYear()===A.getFullYear();case"week":{const R=new Date;return R.setDate(A.getDate()-7),I>=R}case"month":{const R=new Date;return R.setMonth(A.getMonth()-1),I>=R}default:return!0}},p=e.filter(O=>s==="all"||O.type===s).filter(O=>h(O.date,n)).sort((O,T)=>new Date(T.date).getTime()-new Date(O.date).getTime()),v=p.filter(O=>O.type==="income").reduce((O,T)=>O+T.amount,0),m=p.filter(O=>O.type==="expense").reduce((O,T)=>O+T.amount,0),x=v-m,w=p.reduce((O,T)=>{const I=`${T.type}-${T.category}`;return O[I]||(O[I]={type:T.type,category:T.category,amount:0}),O[I].amount+=T.amount,O},{}),y=O=>{l(O.id),u({type:O.type,description:O.description,amount:O.amount.toString(),category:O.category})},g=()=>{o&&c.description&&c.amount&&c.category&&(t(o,c.type,c.description,parseFloat(c.amount),c.category),l(null),u({type:"income",description:"",amount:"",category:""}))},k=()=>{l(null),u({type:"income",description:"",amount:"",category:""})},j=O=>{window.confirm("¿Estás seguro de que quieres eliminar este registro?")&&r(O)};return f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5",children:[f.jsxs("h2",{className:"text-xl font-semibold text-amber-800 mb-4 flex items-center",children:[f.jsx(jl,{className:"mr-2 h-5 w-5"})," Reporte Financiero"]}),f.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-6 gap-2",children:[f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs("select",{value:n,onChange:O=>i(O.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50 text-sm",children:[f.jsx("option",{value:"all",children:"Todos los periodos"}),f.jsx("option",{value:"today",children:"Hoy"}),f.jsx("option",{value:"week",children:"Última semana"}),f.jsx("option",{value:"month",children:"Último mes"})]}),f.jsxs("select",{value:s,onChange:O=>a(O.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50 text-sm",children:[f.jsx("option",{value:"all",children:"Todos los tipos"}),f.jsx("option",{value:"income",children:"Solo ingresos"}),f.jsx("option",{value:"expense",children:"Solo gastos"})]})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx(zx,{className:"h-4 w-4 mr-1 text-gray-500"}),f.jsxs("span",{className:"text-sm text-gray-500",children:["Mostrando ",p.length," transacciones"]})]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[f.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-100",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Ingresos"}),f.jsx(qh,{className:"h-4 w-4 text-green-600"})]}),f.jsxs("p",{className:"text-2xl font-bold text-green-700 mt-2",children:["$",v.toFixed(2)]})]}),f.jsxs("div",{className:"bg-red-50 rounded-lg p-4 border border-red-100",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Gastos"}),f.jsx(Gh,{className:"h-4 w-4 text-red-600"})]}),f.jsxs("p",{className:"text-2xl font-bold text-red-700 mt-2",children:["$",m.toFixed(2)]})]}),f.jsxs("div",{className:`rounded-lg p-4 border ${x>=0?"bg-blue-50 border-blue-100":"bg-orange-50 border-orange-100"}`,children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:`text-sm font-medium ${x>=0?"text-blue-800":"text-orange-800"}`,children:"Balance"}),x>=0?f.jsx(qh,{className:"h-4 w-4 text-blue-600"}):f.jsx(Gh,{className:"h-4 w-4 text-orange-600"})]}),f.jsxs("p",{className:`text-2xl font-bold mt-2 ${x>=0?"text-blue-700":"text-orange-700"}`,children:["$",Math.abs(x).toFixed(2)]})]})]}),Object.keys(w).length>0&&f.jsxs("div",{className:"mb-6",children:[f.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Distribución por Categoría"}),f.jsx("div",{className:"space-y-3",children:Object.values(w).map((O,T)=>f.jsxs("div",{className:"space-y-1",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:`${O.type==="income"?"text-green-700":"text-red-700"}`,children:O.category}),f.jsxs("span",{className:"font-medium",children:["$",O.amount.toFixed(2)]})]}),f.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:f.jsx("div",{className:`h-2 rounded-full ${O.type==="income"?"bg-green-500":"bg-red-500"}`,style:{width:`${Math.min(100,O.amount/(O.type==="income"?v:m)*100)}%`}})})]},T))})]}),p.length>0?f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[f.jsx("thead",{className:"bg-gray-50",children:f.jsxs("tr",{children:[f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Descripción"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Categoría"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Monto"}),f.jsx("th",{scope:"col",className:"px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),f.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(O=>f.jsx("tr",{className:"hover:bg-gray-50",children:o===O.id?f.jsxs(f.Fragment,{children:[f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:new Date(O.date).toLocaleDateString()}),f.jsx("td",{className:"px-3 py-2",children:f.jsx("input",{type:"text",value:c.description,onChange:T=>u({...c,description:T.target.value}),className:"w-full text-sm border-gray-300 rounded focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50"})}),f.jsx("td",{className:"px-3 py-2",children:f.jsxs("select",{value:c.category,onChange:T=>u({...c,category:T.target.value}),className:"w-full text-sm border-gray-300 rounded focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50",children:[f.jsx("option",{value:"",children:"Selecciona categoría"}),d[c.type].map(T=>f.jsx("option",{value:T,children:T},T))]})}),f.jsx("td",{className:"px-3 py-2",children:f.jsxs("div",{className:"flex items-center",children:[f.jsxs("select",{value:c.type,onChange:T=>u({...c,type:T.target.value}),className:"text-sm border-gray-300 rounded focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50 mr-1",children:[f.jsx("option",{value:"income",children:"+"}),f.jsx("option",{value:"expense",children:"-"})]}),f.jsx("input",{type:"number",value:c.amount,onChange:T=>u({...c,amount:T.target.value}),step:"0.01",min:"0.01",className:"w-20 text-sm border-gray-300 rounded focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50"})]})}),f.jsx("td",{className:"px-3 py-2 text-center",children:f.jsxs("div",{className:"flex justify-center space-x-1",children:[f.jsx("button",{onClick:g,className:"text-green-600 hover:text-green-800 transition-colors",title:"Guardar",children:f.jsx(Rf,{className:"h-4 w-4"})}),f.jsx("button",{onClick:k,className:"text-gray-600 hover:text-gray-800 transition-colors",title:"Cancelar",children:f.jsx(Sc,{className:"h-4 w-4"})})]})})]}):f.jsxs(f.Fragment,{children:[f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:new Date(O.date).toLocaleDateString()}),f.jsx("td",{className:"px-3 py-2 text-sm font-medium text-gray-900",children:O.description}),f.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm text-gray-500",children:O.category}),f.jsxs("td",{className:`px-3 py-2 whitespace-nowrap text-sm font-medium text-right ${O.type==="income"?"text-green-600":"text-red-600"}`,children:[O.type==="income"?"+":"-","$",O.amount.toFixed(2)]}),f.jsx("td",{className:"px-3 py-2 text-center",children:f.jsxs("div",{className:"flex justify-center space-x-1",children:[f.jsx("button",{onClick:()=>y(O),className:"text-blue-600 hover:text-blue-800 transition-colors",title:"Editar",children:f.jsx(Wx,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>j(O.id),className:"text-red-600 hover:text-red-800 transition-colors",title:"Eliminar",children:f.jsx(Lf,{className:"h-4 w-4"})})]})})]})},O.id))})]})}):f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(jl,{className:"h-12 w-12 mx-auto mb-2 opacity-30"}),f.jsx("p",{children:"No hay transacciones para mostrar"}),f.jsx("p",{className:"text-sm",children:"Ajusta los filtros o añade nuevas transacciones"})]})]})},_T=()=>f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-amber-900 mb-6",children:"Gestión Financiera"}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[f.jsx("div",{className:"lg:col-span-1",children:f.jsx(yT,{})}),f.jsx("div",{className:"lg:col-span-2",children:f.jsx(wT,{})})]})]}),ST=()=>{const{users:e,updateUser:t}=er(),[r,n]=H.useState(null),[i,s]=H.useState({name:"",email:"",phone:"",address:""}),a=c=>{n(c.id),s({name:c.name,email:c.email||"",phone:c.phone||"",address:c.address||""})},o=async()=>{if(r&&i.name.trim())try{await t(r,{name:i.name,email:i.email||void 0,phone:i.phone||void 0,address:i.address||void 0}),n(null),s({name:"",email:"",phone:"",address:""})}catch(c){console.error("Error updating user:",c),alert("Error al actualizar el cliente. Por favor intenta de nuevo.")}},l=()=>{n(null),s({name:"",email:"",phone:"",address:""})};return f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5",children:[f.jsxs("h2",{className:"text-xl font-semibold text-amber-800 mb-4 flex items-center",children:[f.jsx(C0,{className:"mr-2 h-5 w-5"})," Lista de Clientes"]}),e.length===0?f.jsxs("div",{className:"text-center py-8 text-gray-500",children:[f.jsx(C0,{className:"h-12 w-12 mx-auto mb-2 opacity-30"}),f.jsx("p",{children:"No hay clientes registrados"}),f.jsx("p",{className:"text-sm",children:"Añade un cliente para comenzar"})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(c=>f.jsx("div",{className:"border border-amber-100 rounded-lg p-4 bg-amber-50",children:r===c.id?f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-amber-800 mb-1",children:"Nombre *"}),f.jsx("input",{type:"text",value:i.name,onChange:u=>s({...i,name:u.target.value}),className:"w-full text-sm border-gray-300 rounded focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50",placeholder:"Nombre del cliente",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-amber-800 mb-1",children:"Teléfono"}),f.jsx("input",{type:"tel",value:i.phone,onChange:u=>s({...i,phone:u.target.value}),className:"w-full text-sm border-gray-300 rounded focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50",placeholder:"Número de teléfono"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-amber-800 mb-1",children:"Email"}),f.jsx("input",{type:"email",value:i.email,onChange:u=>s({...i,email:u.target.value}),className:"w-full text-sm border-gray-300 rounded focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50",placeholder:"Correo electrónico"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-xs font-medium text-amber-800 mb-1",children:"Dirección"}),f.jsx("textarea",{value:i.address,onChange:u=>s({...i,address:u.target.value}),rows:2,className:"w-full text-sm border-gray-300 rounded focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50",placeholder:"Dirección completa"})]}),f.jsxs("div",{className:"flex space-x-2 pt-2",children:[f.jsxs("button",{onClick:o,disabled:!i.name.trim(),className:"flex-1 flex items-center justify-center px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",children:[f.jsx(Rf,{className:"h-4 w-4 mr-1"}),"Guardar"]}),f.jsxs("button",{onClick:l,className:"flex-1 flex items-center justify-center px-3 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600 transition-colors text-sm",children:[f.jsx(Sc,{className:"h-4 w-4 mr-1"}),"Cancelar"]})]})]}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex justify-between items-start mb-3",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"font-semibold text-amber-900 text-lg",children:c.name}),f.jsxs("div",{className:"space-y-1 mt-2",children:[c.phone&&f.jsxs("p",{className:"text-sm text-gray-600 flex items-center",children:[f.jsx(iT,{className:"h-4 w-4 mr-2 text-amber-600"}),c.phone]}),c.email&&f.jsxs("p",{className:"text-sm text-gray-600 flex items-center",children:[f.jsx(tT,{className:"h-4 w-4 mr-2 text-amber-600"}),c.email]}),c.address&&f.jsxs("p",{className:"text-sm text-gray-600 flex items-start",children:[f.jsx(rT,{className:"h-4 w-4 mr-2 text-amber-600 mt-0.5 flex-shrink-0"}),f.jsx("span",{children:c.address})]})]})]}),f.jsx("button",{onClick:()=>a(c),className:"p-2 text-amber-600 hover:text-amber-800 hover:bg-amber-100 rounded-full transition-colors",title:"Editar cliente",children:f.jsx(Wx,{className:"h-4 w-4"})})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx("div",{className:"bg-amber-100/50 rounded p-2",children:f.jsxs("div",{className:"flex items-center justify-between text-sm text-amber-900",children:[f.jsxs("span",{className:"flex items-center",children:[f.jsx(En,{className:"h-4 w-4 mr-1"}),"Pedidos"]}),f.jsx("span",{className:"font-semibold",children:c.orderCount})]})}),f.jsx("div",{className:"bg-amber-100/50 rounded p-2",children:f.jsxs("div",{className:"flex items-center justify-between text-sm text-amber-900",children:[f.jsxs("span",{className:"flex items-center",children:[f.jsx(En,{className:"h-4 w-4 mr-1"}),"Galletas"]}),f.jsx("span",{className:"font-semibold",children:c.totalCookies})]})}),f.jsx("div",{className:"bg-amber-100/50 rounded p-2",children:f.jsxs("div",{className:"flex items-center justify-between text-sm text-amber-900",children:[f.jsxs("span",{className:"flex items-center",children:[f.jsx(mn,{className:"h-4 w-4 mr-1"}),"Cajas x4"]}),f.jsx("span",{className:"font-semibold",children:c.box4Count})]})}),f.jsx("div",{className:"bg-amber-100/50 rounded p-2",children:f.jsxs("div",{className:"flex items-center justify-between text-sm text-amber-900",children:[f.jsxs("span",{className:"flex items-center",children:[f.jsx(mn,{className:"h-4 w-4 mr-1"}),"Cajas x6"]}),f.jsx("span",{className:"font-semibold",children:c.box6Count})]})})]}),f.jsxs("div",{className:"mt-3 text-xs text-gray-500",children:["Cliente desde: ",new Date(c.createdAt).toLocaleDateString()]})]})},c.id))})]})},ET=()=>{const{addUser:e}=er(),[t,r]=H.useState(""),[n,i]=H.useState(""),[s,a]=H.useState(""),[o,l]=H.useState(""),c=u=>{u.preventDefault(),t.trim()&&(e(t,n,s,o),r(""),i(""),a(""),l(""))};return f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-5 mb-6",children:[f.jsxs("h2",{className:"text-xl font-semibold text-amber-800 mb-4 flex items-center",children:[f.jsx(Rl,{className:"mr-2 h-5 w-5"})," Nuevo Cliente"]}),f.jsxs("form",{onSubmit:c,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre *"}),f.jsx("input",{type:"text",id:"name",value:t,onChange:u=>r(u.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Teléfono"}),f.jsx("input",{type:"tel",id:"phone",value:s,onChange:u=>a(u.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-1",children:"Dirección"}),f.jsx("textarea",{id:"address",value:o,onChange:u=>l(u.target.value),rows:3,className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50"})]}),f.jsxs("div",{children:[f.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),f.jsx("input",{type:"email",id:"email",value:n,onChange:u=>i(u.target.value),className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-amber-500 focus:ring focus:ring-amber-200 focus:ring-opacity-50"})]}),f.jsxs("button",{type:"submit",className:"w-full py-2 px-4 bg-amber-600 hover:bg-amber-700 text-white rounded-md transition-colors flex items-center justify-center",children:[f.jsx(Rl,{className:"h-4 w-4 mr-2"}),"Crear Cliente"]})]})]})},TT=()=>f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-amber-900 mb-6",children:"Gestión de Clientes"}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[f.jsx("div",{className:"lg:col-span-1",children:f.jsx(ET,{})}),f.jsx("div",{className:"lg:col-span-2",children:f.jsx(ST,{})})]})]});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Ll={};Ll.version="0.18.5";var Vx=1252,kT=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Gx=function(e){kT.indexOf(e)!=-1&&(Vx=e)};function NT(){Gx(1252)}var Ga=function(e){Gx(e)};function CT(){Ga(1200),NT()}var Bo=function(t){return String.fromCharCode(t)},rp=function(t){return String.fromCharCode(t)},Ml,Un="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ka(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),a=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=Un.charAt(s)+Un.charAt(a)+Un.charAt(o)+Un.charAt(l);return t}function Tn(e){var t="",r=0,n=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Un.indexOf(e.charAt(c++)),a=Un.indexOf(e.charAt(c++)),r=s<<2|a>>4,t+=String.fromCharCode(r),o=Un.indexOf(e.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Un.indexOf(e.charAt(c++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var Be=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Cn=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ai(e){return Be?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function np(e){return Be?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Hr=function(t){return Be?Cn(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ec(e){if(typeof ArrayBuffer>"u")return Hr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function oo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function bT(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Ft=Be?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Cn(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function AT(e){for(var t=[],r=0,n=e.length+250,i=Ai(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Ai(65535),n=65530)}return t.push(i.slice(0,r)),Ft(t)}var wa=/\u0000/g,Uo=/[\u0001-\u0006]/g;function gs(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Vr(e,t){var r=""+e;return r.length>=t?r:ot("0",t-r.length)+r}function Mf(e,t){var r=""+e;return r.length>=t?r:ot(" ",t-r.length)+r}function Bl(e,t){var r=""+e;return r.length>=t?r:r+ot(" ",t-r.length)}function FT(e,t){var r=""+Math.round(e);return r.length>=t?r:ot("0",t-r.length)+r}function OT(e,t){var r=""+e;return r.length>=t?r:ot("0",t-r.length)+r}var ip=Math.pow(2,32);function Gi(e,t){if(e>ip||e<-ip)return FT(e,t);var r=Math.round(e);return OT(r,t)}function Ul(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var sp=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],pu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function jT(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var lt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},ap={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},PT={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $l(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,a=1,o=0,l=1,c=0,u=0,d=Math.floor(i);c<t&&(d=Math.floor(i),o=d*a+s,u=d*c+l,!(i-d<5e-8));)i=1/(i-d),s=a,a=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=s):(u=c,o=a)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function $o(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,a=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=UT(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var Kx=new Date(1899,11,31,0,0,0),DT=Kx.getTime(),IT=new Date(1900,2,1,0,0,0);function qx(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=IT&&(r+=24*60*60*1e3),(r-(DT+(e.getTimezoneOffset()-Kx.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Bf(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function RT(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function LT(e){var t=e<0?12:11,r=Bf(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function MT(e){var t=Bf(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function BT(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=LT(e):t===10?r=e.toFixed(10).substr(0,12):r=MT(e),Bf(RT(r.toUpperCase()))}function b0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):BT(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Zn(14,qx(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function UT(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function $T(e,t,r,n){var i="",s=0,a=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return pu[r.m-1][1];case 5:return pu[r.m-1][0];default:return pu[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return sp[r.q][0];default:return sp[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Vr(r.S,t.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=Vr(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Vr(l,c):"";return u}function $n(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var Xx=/%/g;function zT(e,t,r){var n=t.replace(Xx,""),i=t.length-n.length;return xn(e,n,r*Math.pow(10,2*i))+ot("%",i)}function WT(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return xn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Yx(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Yx(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Jx=/# (\?+)( ?)\/( ?)(\d+)/;function HT(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?ot(" ",e[1].length+1+e[4].length):Mf(a,e[1].length)+e[2]+"/"+e[3]+Vr(o,e[4].length))}function VT(e,t,r){return r+(t===0?"":""+t)+ot(" ",e[1].length+2+e[4].length)}var Qx=/^#*0*\.([0#]+)/,Zx=/\).*[0#]/,eg=/\(###\) ###\\?-####/;function qt(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function op(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function lp(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function GT(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function KT(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Tr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Zx)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Tr("n",n,r):"("+Tr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return WT(e,t,r);if(t.indexOf("%")!==-1)return zT(e,t,r);if(t.indexOf("E")!==-1)return Yx(t,r);if(t.charCodeAt(0)===36)return"$"+Tr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Gi(l,t.length);if(t.match(/^[#?]+$/))return i=Gi(r,0),i==="0"&&(i=""),i.length>t.length?i:qt(t.substr(0,t.length-i.length))+i;if(s=t.match(Jx))return HT(s,l,c);if(t.match(/^#+0+$/))return c+Gi(l,t.length-t.indexOf("0"));if(s=t.match(Qx))return i=op(r,s[1].length).replace(/^([^\.]+)$/,"$1."+qt(s[1])).replace(/\.$/,"."+qt(s[1])).replace(/\.(\d*)$/,function(v,m){return"."+m+ot("0",qt(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+op(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+$n(Gi(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Tr(e,t,-r):$n(""+(Math.floor(r)+GT(r,s[1].length)))+"."+Vr(lp(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Tr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=gs(Tr(e,t.replace(/[\\-]/g,""),r)),a=0,gs(gs(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(t.match(eg))return i=Tr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=$l(l,Math.pow(10,a)-1,!1),i=""+c,u=xn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Bl(o[2],a),u.length<s[4].length&&(u=qt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=$l(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Mf(o[1],a)+s[2]+"/"+s[3]+Bl(o[2],a):ot(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=Gi(r,0),t.length<=i.length?i:qt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=t.indexOf(".")-a,h=t.length-i.length-d;return qt(t.substr(0,d)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=lp(r,s[1].length),r<0?"-"+Tr(e,t,-r):$n(KT(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Vr(0,3-v.length):"")+v})+"."+Vr(a,s[1].length);switch(t){case"###,##0.00":return Tr(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=$n(Gi(l,0));return p!=="0"?c+p:"";case"###,###.00":return Tr(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Tr(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function qT(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return xn(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function XT(e,t,r){var n=t.replace(Xx,""),i=t.length-n.length;return xn(e,n,r*Math.pow(10,2*i))+ot("%",i)}function tg(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tg(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Jr(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Zx)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Jr("n",n,r):"("+Jr("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return qT(e,t,r);if(t.indexOf("%")!==-1)return XT(e,t,r);if(t.indexOf("E")!==-1)return tg(t,r);if(t.charCodeAt(0)===36)return"$"+Jr(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,a,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Vr(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:qt(t.substr(0,t.length-i.length))+i;if(s=t.match(Jx))return VT(s,l,c);if(t.match(/^#+0+$/))return c+Vr(l,t.length-t.indexOf("0"));if(s=t.match(Qx))return i=(""+r).replace(/^([^\.]+)$/,"$1."+qt(s[1])).replace(/\.$/,"."+qt(s[1])),i=i.replace(/\.(\d*)$/,function(v,m){return"."+m+ot("0",qt(s[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+$n(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Jr(e,t,-r):$n(""+r)+"."+ot("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Jr(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=gs(Jr(e,t.replace(/[\\-]/g,""),r)),a=0,gs(gs(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(t.match(eg))return i=Jr(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=$l(l,Math.pow(10,a)-1,!1),i=""+c,u=xn("n",s[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=Bl(o[2],a),u.length<s[4].length&&(u=qt(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=$l(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Mf(o[1],a)+s[2]+"/"+s[3]+Bl(o[2],a):ot(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:qt(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var d=t.indexOf(".")-a,h=t.length-i.length-d;return qt(t.substr(0,d)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Jr(e,t,-r):$n(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Vr(0,3-v.length):"")+v})+"."+Vr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=$n(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return Jr(e,t.slice(0,t.lastIndexOf(".")),r)+qt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function xn(e,t,r){return(r|0)===r?Jr(e,t,r):Tr(e,t,r)}function YT(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var rg=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ng(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Ul(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(rg))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function JT(e,t,r,n){for(var i=[],s="",a=0,o="",l="t",c,u,d,h="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!Ul(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(d=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(d);i[i.length]={t:"t",v:s},++a;break;case"\\":var p=e.charAt(++a),v=p==="("||p===")"?p:"t";i[i.length]={t:v,v:p},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(c==null&&(c=$o(t,r,e.charAt(a+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=$o(t,r),c==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"上":var m={t:o,v:o};if(c==null&&(c=$o(t,r)),e.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",h="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",a+=5,h="h"):e.substr(a,5).toUpperCase()==="上午/下午"?(c!=null&&(m.v=c.H>=12?"下午":"上午"),m.t="T",a+=5,h="h"):(m.t="t",++a),c==null&&m.t==="T")return"";i[i.length]=m,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(rg)){if(c==null&&(c=$o(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ng(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var x=0,w=0,y;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=h,l="h",x<1&&(x=1);break;case"s":(y=i[a].v.match(/\.0+$/))&&(w=Math.max(w,y[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&i[a].v.match(/[Hh]/)&&(x=1),x<2&&i[a].v.match(/[Mm]/)&&(x=2),x<3&&i[a].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var g="",k;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=$T(i[a].t.charCodeAt(0),i[a].v,c,w),i[a].t="t";break;case"n":case"?":for(k=a+1;i[k]!=null&&((o=i[k].t)==="?"||o==="D"||(o===" "||o==="t")&&i[k+1]!=null&&(i[k+1].t==="?"||i[k+1].t==="t"&&i[k+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[k].v==="/"||i[k].v===" "&&i[k+1]!=null&&i[k+1].t=="?"));)i[a].v+=i[k].v,i[k]={v:"",t:";"},++k;g+=i[a].v,a=k-1;break;case"G":i[a].t="t",i[a].v=b0(t,r);break}var j="",O,T;if(g.length>0){g.charCodeAt(0)==40?(O=t<0&&g.charCodeAt(0)===45?-t:t,T=xn("n",g,O)):(O=t<0&&n>1?-t:t,T=xn("n",g,O),O<0&&i[0]&&i[0].t=="t"&&(T=T.substr(1),i[0].v="-"+i[0].v)),k=T.length-1;var I=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){I=a;break}var A=i.length;if(I===i.length&&T.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(k>=i[a].v.length-1?(k-=i[a].v.length,i[a].v=T.substr(k+1,i[a].v.length)):k<0?i[a].v="":(i[a].v=T.substr(0,k+1),k=-1),i[a].t="t",A=a);k>=0&&A<i.length&&(i[A].v=T.substr(0,k+1)+i[A].v)}else if(I!==i.length&&T.indexOf("E")===-1){for(k=T.indexOf(".")-1,a=I;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(u=i[a].v.indexOf(".")>-1&&a===I?i[a].v.indexOf(".")-1:i[a].v.length-1,j=i[a].v.substr(u+1);u>=0;--u)k>=0&&(i[a].v.charAt(u)==="0"||i[a].v.charAt(u)==="#")&&(j=T.charAt(k--)+j);i[a].v=j,i[a].t="t",A=a}for(k>=0&&A<i.length&&(i[A].v=T.substr(0,k+1)+i[A].v),k=T.indexOf(".")+1,a=I;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==I)){for(u=i[a].v.indexOf(".")>-1&&a===I?i[a].v.indexOf(".")+1:0,j=i[a].v.substr(0,u);u<i[a].v.length;++u)k<T.length&&(j+=T.charAt(k++));i[a].v=j,i[a].t="t",A=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(O=n>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=xn(i[a].t,i[a].v,O),i[a].t="t");var R="";for(a=0;a!==i.length;++a)i[a]!=null&&(R+=i[a].v);return R}var cp=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function up(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function QT(e,t){var r=YT(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(cp),o=r[1].match(cp);return up(t,a)?[n,r[0]]:up(t,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Zn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:lt)[e],n==null&&(n=r.table&&r.table[ap[e]]||lt[ap[e]]),n==null&&(n=PT[e]||"General");break}if(Ul(n,0))return b0(t,r);t instanceof Date&&(t=qx(t,r.date1904));var i=QT(n,t);if(Ul(i[1]))return b0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return JT(i[1],t,r,i[0])}function ig(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(lt[r]==null){t<0&&(t=r);continue}if(lt[r]==e){t=r;break}}t<0&&(t=391)}return lt[t]=e,t}function Tc(e){for(var t=0;t!=392;++t)e[t]!==void 0&&ig(e[t],t)}function kc(){lt=jT()}var sg=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ZT(e){var t=typeof e=="number"?lt[e]:e;return t=t.replace(sg,"(\\d+)"),new RegExp("^"+t+"$")}function e4(e,t,r){var n=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(sg)||[]).forEach(function(d,h){var p=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:i=p;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var t4=function(){var e={};e.version="1.2.0";function t(){for(var T=0,I=new Array(256),A=0;A!=256;++A)T=A,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,I[A]=T;return typeof Int32Array<"u"?new Int32Array(I):I}var r=t();function n(T){var I=0,A=0,R=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)K[R]=T[R];for(R=0;R!=256;++R)for(A=T[R],I=256+R;I<4096;I+=256)A=K[I]=A>>>8^T[A&255];var G=[];for(R=1;R!=16;++R)G[R-1]=typeof Int32Array<"u"?K.subarray(R*256,R*256+256):K.slice(R*256,R*256+256);return G}var i=n(r),s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],d=i[6],h=i[7],p=i[8],v=i[9],m=i[10],x=i[11],w=i[12],y=i[13],g=i[14];function k(T,I){for(var A=I^-1,R=0,K=T.length;R<K;)A=A>>>8^r[(A^T.charCodeAt(R++))&255];return~A}function j(T,I){for(var A=I^-1,R=T.length-15,K=0;K<R;)A=g[T[K++]^A&255]^y[T[K++]^A>>8&255]^w[T[K++]^A>>16&255]^x[T[K++]^A>>>24]^m[T[K++]]^v[T[K++]]^p[T[K++]]^h[T[K++]]^d[T[K++]]^u[T[K++]]^c[T[K++]]^l[T[K++]]^o[T[K++]]^a[T[K++]]^s[T[K++]]^r[T[K++]];for(R+=15;K<R;)A=A>>>8^r[(A^T[K++])&255];return~A}function O(T,I){for(var A=I^-1,R=0,K=T.length,G=0,Q=0;R<K;)G=T.charCodeAt(R++),G<128?A=A>>>8^r[(A^G)&255]:G<2048?(A=A>>>8^r[(A^(192|G>>6&31))&255],A=A>>>8^r[(A^(128|G&63))&255]):G>=55296&&G<57344?(G=(G&1023)+64,Q=T.charCodeAt(R++)&1023,A=A>>>8^r[(A^(240|G>>8&7))&255],A=A>>>8^r[(A^(128|G>>2&63))&255],A=A>>>8^r[(A^(128|Q>>6&15|(G&3)<<4))&255],A=A>>>8^r[(A^(128|Q&63))&255]):(A=A>>>8^r[(A^(224|G>>12&15))&255],A=A>>>8^r[(A^(128|G>>6&63))&255],A=A>>>8^r[(A^(128|G&63))&255]);return~A}return e.table=r,e.bstr=k,e.buf=j,e.str=O,e}(),Ge=function(){var t={};t.version="1.2.1";function r(_,N){for(var S=_.split("/"),E=N.split("/"),C=0,b=0,B=Math.min(S.length,E.length);C<B;++C){if(b=S[C].length-E[C].length)return b;if(S[C]!=E[C])return S[C]<E[C]?-1:1}return S.length-E.length}function n(_){if(_.charAt(_.length-1)=="/")return _.slice(0,-1).indexOf("/")===-1?_:n(_.slice(0,-1));var N=_.lastIndexOf("/");return N===-1?_:_.slice(0,N+1)}function i(_){if(_.charAt(_.length-1)=="/")return i(_.slice(0,-1));var N=_.lastIndexOf("/");return N===-1?_:_.slice(N+1)}function s(_,N){typeof N=="string"&&(N=new Date(N));var S=N.getHours();S=S<<6|N.getMinutes(),S=S<<5|N.getSeconds()>>>1,_.write_shift(2,S);var E=N.getFullYear()-1980;E=E<<4|N.getMonth()+1,E=E<<5|N.getDate(),_.write_shift(2,E)}function a(_){var N=_.read_shift(2)&65535,S=_.read_shift(2)&65535,E=new Date,C=S&31;S>>>=5;var b=S&15;S>>>=4,E.setMilliseconds(0),E.setFullYear(S+1980),E.setMonth(b-1),E.setDate(C);var B=N&31;N>>>=5;var Y=N&63;return N>>>=6,E.setHours(N),E.setMinutes(Y),E.setSeconds(B<<1),E}function o(_){pr(_,0);for(var N={},S=0;_.l<=_.length-4;){var E=_.read_shift(2),C=_.read_shift(2),b=_.l+C,B={};switch(E){case 21589:S=_.read_shift(1),S&1&&(B.mtime=_.read_shift(4)),C>5&&(S&2&&(B.atime=_.read_shift(4)),S&4&&(B.ctime=_.read_shift(4))),B.mtime&&(B.mt=new Date(B.mtime*1e3));break}_.l=b,N[E]=B}return N}var l;function c(){return l||(l={})}function u(_,N){if(_[0]==80&&_[1]==75)return ld(_,N);if((_[0]|32)==109&&(_[1]|32)==105)return Iv(_,N);if(_.length<512)throw new Error("CFB file size "+_.length+" < 512");var S=3,E=512,C=0,b=0,B=0,Y=0,L=0,z=[],W=_.slice(0,512);pr(W,0);var ee=d(W);switch(S=ee[0],S){case 3:E=512;break;case 4:E=4096;break;case 0:if(ee[1]==0)return ld(_,N);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}E!==512&&(W=_.slice(0,E),pr(W,28));var ce=_.slice(0,E);h(W,S);var he=W.read_shift(4,"i");if(S===3&&he!==0)throw new Error("# Directory Sectors: Expected 0 saw "+he);W.l+=4,B=W.read_shift(4,"i"),W.l+=4,W.chk("00100000","Mini Stream Cutoff Size: "),Y=W.read_shift(4,"i"),C=W.read_shift(4,"i"),L=W.read_shift(4,"i"),b=W.read_shift(4,"i");for(var ne=-1,fe=0;fe<109&&(ne=W.read_shift(4,"i"),!(ne<0));++fe)z[fe]=ne;var Te=p(_,E);x(L,b,Te,E,z);var tt=y(Te,B,z,E);tt[B].name="!Directory",C>0&&Y!==Q&&(tt[Y].name="!MiniFAT"),tt[z[0]].name="!FAT",tt.fat_addrs=z,tt.ssz=E;var rt={},Rt=[],Ws=[],Hs=[];g(B,tt,Te,Rt,C,rt,Ws,Y),v(Ws,Hs,Rt),Rt.shift();var Vs={FileIndex:Ws,FullPaths:Hs};return N&&N.raw&&(Vs.raw={header:ce,sectors:Te}),Vs}function d(_){if(_[_.l]==80&&_[_.l+1]==75)return[0,0];_.chk(ye,"Header Signature: "),_.l+=16;var N=_.read_shift(2,"u");return[_.read_shift(2,"u"),N]}function h(_,N){var S=9;switch(_.l+=2,S=_.read_shift(2)){case 9:if(N!=3)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(N!=4)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}_.chk("0600","Mini Sector Shift: "),_.chk("000000000000","Reserved: ")}function p(_,N){for(var S=Math.ceil(_.length/N)-1,E=[],C=1;C<S;++C)E[C-1]=_.slice(C*N,(C+1)*N);return E[S-1]=_.slice(S*N),E}function v(_,N,S){for(var E=0,C=0,b=0,B=0,Y=0,L=S.length,z=[],W=[];E<L;++E)z[E]=W[E]=E,N[E]=S[E];for(;Y<W.length;++Y)E=W[Y],C=_[E].L,b=_[E].R,B=_[E].C,z[E]===E&&(C!==-1&&z[C]!==C&&(z[E]=z[C]),b!==-1&&z[b]!==b&&(z[E]=z[b])),B!==-1&&(z[B]=E),C!==-1&&E!=z[E]&&(z[C]=z[E],W.lastIndexOf(C)<Y&&W.push(C)),b!==-1&&E!=z[E]&&(z[b]=z[E],W.lastIndexOf(b)<Y&&W.push(b));for(E=1;E<L;++E)z[E]===E&&(b!==-1&&z[b]!==b?z[E]=z[b]:C!==-1&&z[C]!==C&&(z[E]=z[C]));for(E=1;E<L;++E)if(_[E].type!==0){if(Y=E,Y!=z[Y])do Y=z[Y],N[E]=N[Y]+"/"+N[E];while(Y!==0&&z[Y]!==-1&&Y!=z[Y]);z[E]=-1}for(N[0]+="/",E=1;E<L;++E)_[E].type!==2&&(N[E]+="/")}function m(_,N,S){for(var E=_.start,C=_.size,b=[],B=E;S&&C>0&&B>=0;)b.push(N.slice(B*G,B*G+G)),C-=G,B=gi(S,B*4);return b.length===0?X(0):Ft(b).slice(0,_.size)}function x(_,N,S,E,C){var b=Q;if(_===Q){if(N!==0)throw new Error("DIFAT chain shorter than expected")}else if(_!==-1){var B=S[_],Y=(E>>>2)-1;if(!B)return;for(var L=0;L<Y&&(b=gi(B,L*4))!==Q;++L)C.push(b);x(gi(B,E-4),N-1,S,E,C)}}function w(_,N,S,E,C){var b=[],B=[];C||(C=[]);var Y=E-1,L=0,z=0;for(L=N;L>=0;){C[L]=!0,b[b.length]=L,B.push(_[L]);var W=S[Math.floor(L*4/E)];if(z=L*4&Y,E<4+z)throw new Error("FAT boundary crossed: "+L+" 4 "+E);if(!_[W])break;L=gi(_[W],z)}return{nodes:b,data:vp([B])}}function y(_,N,S,E){var C=_.length,b=[],B=[],Y=[],L=[],z=E-1,W=0,ee=0,ce=0,he=0;for(W=0;W<C;++W)if(Y=[],ce=W+N,ce>=C&&(ce-=C),!B[ce]){L=[];var ne=[];for(ee=ce;ee>=0;){ne[ee]=!0,B[ee]=!0,Y[Y.length]=ee,L.push(_[ee]);var fe=S[Math.floor(ee*4/E)];if(he=ee*4&z,E<4+he)throw new Error("FAT boundary crossed: "+ee+" 4 "+E);if(!_[fe]||(ee=gi(_[fe],he),ne[ee]))break}b[ce]={nodes:Y,data:vp([L])}}return b}function g(_,N,S,E,C,b,B,Y){for(var L=0,z=E.length?2:0,W=N[_].data,ee=0,ce=0,he;ee<W.length;ee+=128){var ne=W.slice(ee,ee+128);pr(ne,64),ce=ne.read_shift(2),he=Hf(ne,0,ce-z),E.push(he);var fe={name:he,type:ne.read_shift(1),color:ne.read_shift(1),L:ne.read_shift(4,"i"),R:ne.read_shift(4,"i"),C:ne.read_shift(4,"i"),clsid:ne.read_shift(16),state:ne.read_shift(4,"i"),start:0,size:0},Te=ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2);Te!==0&&(fe.ct=k(ne,ne.l-8));var tt=ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2);tt!==0&&(fe.mt=k(ne,ne.l-8)),fe.start=ne.read_shift(4,"i"),fe.size=ne.read_shift(4,"i"),fe.size<0&&fe.start<0&&(fe.size=fe.type=0,fe.start=Q,fe.name=""),fe.type===5?(L=fe.start,C>0&&L!==Q&&(N[L].name="!StreamData")):fe.size>=4096?(fe.storage="fat",N[fe.start]===void 0&&(N[fe.start]=w(S,fe.start,N.fat_addrs,N.ssz)),N[fe.start].name=fe.name,fe.content=N[fe.start].data.slice(0,fe.size)):(fe.storage="minifat",fe.size<0?fe.size=0:L!==Q&&fe.start!==Q&&N[L]&&(fe.content=m(fe,N[L].data,(N[Y]||{}).data))),fe.content&&pr(fe.content,0),b[he]=fe,B.push(fe)}}function k(_,N){return new Date((xr(_,N+4)/1e7*Math.pow(2,32)+xr(_,N)/1e7-11644473600)*1e3)}function j(_,N){return c(),u(l.readFileSync(_),N)}function O(_,N){var S=N&&N.type;switch(S||Be&&Buffer.isBuffer(_)&&(S="buffer"),S||"base64"){case"file":return j(_,N);case"base64":return u(Hr(Tn(_)),N);case"binary":return u(Hr(_),N)}return u(_,N)}function T(_,N){var S=N||{},E=S.root||"Root Entry";if(_.FullPaths||(_.FullPaths=[]),_.FileIndex||(_.FileIndex=[]),_.FullPaths.length!==_.FileIndex.length)throw new Error("inconsistent CFB structure");_.FullPaths.length===0&&(_.FullPaths[0]=E+"/",_.FileIndex[0]={name:E,type:5}),S.CLSID&&(_.FileIndex[0].clsid=S.CLSID),I(_)}function I(_){var N="Sh33tJ5";if(!Ge.find(_,"/"+N)){var S=X(4);S[0]=55,S[1]=S[3]=50,S[2]=54,_.FileIndex.push({name:N,type:2,content:S,size:4,L:69,R:69,C:69}),_.FullPaths.push(_.FullPaths[0]+N),A(_)}}function A(_,N){T(_);for(var S=!1,E=!1,C=_.FullPaths.length-1;C>=0;--C){var b=_.FileIndex[C];switch(b.type){case 0:E?S=!0:(_.FileIndex.pop(),_.FullPaths.pop());break;case 1:case 2:case 5:E=!0,isNaN(b.R*b.L*b.C)&&(S=!0),b.R>-1&&b.L>-1&&b.R==b.L&&(S=!0);break;default:S=!0;break}}if(!(!S&&!N)){var B=new Date(1987,1,19),Y=0,L=Object.create?Object.create(null):{},z=[];for(C=0;C<_.FullPaths.length;++C)L[_.FullPaths[C]]=!0,_.FileIndex[C].type!==0&&z.push([_.FullPaths[C],_.FileIndex[C]]);for(C=0;C<z.length;++C){var W=n(z[C][0]);E=L[W],E||(z.push([W,{name:i(W).replace("/",""),type:1,clsid:re,ct:B,mt:B,content:null}]),L[W]=!0)}for(z.sort(function(he,ne){return r(he[0],ne[0])}),_.FullPaths=[],_.FileIndex=[],C=0;C<z.length;++C)_.FullPaths[C]=z[C][0],_.FileIndex[C]=z[C][1];for(C=0;C<z.length;++C){var ee=_.FileIndex[C],ce=_.FullPaths[C];if(ee.name=i(ce).replace("/",""),ee.L=ee.R=ee.C=-(ee.color=1),ee.size=ee.content?ee.content.length:0,ee.start=0,ee.clsid=ee.clsid||re,C===0)ee.C=z.length>1?1:-1,ee.size=0,ee.type=5;else if(ce.slice(-1)=="/"){for(Y=C+1;Y<z.length&&n(_.FullPaths[Y])!=ce;++Y);for(ee.C=Y>=z.length?-1:Y,Y=C+1;Y<z.length&&n(_.FullPaths[Y])!=n(ce);++Y);ee.R=Y>=z.length?-1:Y,ee.type=1}else n(_.FullPaths[C+1]||"")==n(ce)&&(ee.R=C+1),ee.type=2}}}function R(_,N){var S=N||{};if(S.fileType=="mad")return Rv(_,S);switch(A(_),S.fileType){case"zip":return Av(_,S)}var E=function(he){for(var ne=0,fe=0,Te=0;Te<he.FileIndex.length;++Te){var tt=he.FileIndex[Te];if(tt.content){var rt=tt.content.length;rt>0&&(rt<4096?ne+=rt+63>>6:fe+=rt+511>>9)}}for(var Rt=he.FullPaths.length+3>>2,Ws=ne+7>>3,Hs=ne+127>>7,Vs=Ws+fe+Rt+Hs,fi=Vs+127>>7,jc=fi<=109?0:Math.ceil((fi-109)/127);Vs+fi+jc+127>>7>fi;)jc=++fi<=109?0:Math.ceil((fi-109)/127);var an=[1,jc,fi,Hs,Rt,fe,ne,0];return he.FileIndex[0].size=ne<<6,an[7]=(he.FileIndex[0].start=an[0]+an[1]+an[2]+an[3]+an[4]+an[5])+(an[6]+7>>3),an}(_),C=X(E[7]<<9),b=0,B=0;{for(b=0;b<8;++b)C.write_shift(1,Ee[b]);for(b=0;b<8;++b)C.write_shift(2,0);for(C.write_shift(2,62),C.write_shift(2,3),C.write_shift(2,65534),C.write_shift(2,9),C.write_shift(2,6),b=0;b<3;++b)C.write_shift(2,0);for(C.write_shift(4,0),C.write_shift(4,E[2]),C.write_shift(4,E[0]+E[1]+E[2]+E[3]-1),C.write_shift(4,0),C.write_shift(4,4096),C.write_shift(4,E[3]?E[0]+E[1]+E[2]-1:Q),C.write_shift(4,E[3]),C.write_shift(-4,E[1]?E[0]-1:Q),C.write_shift(4,E[1]),b=0;b<109;++b)C.write_shift(-4,b<E[2]?E[1]+b:-1)}if(E[1])for(B=0;B<E[1];++B){for(;b<236+B*127;++b)C.write_shift(-4,b<E[2]?E[1]+b:-1);C.write_shift(-4,B===E[1]-1?Q:B+1)}var Y=function(he){for(B+=he;b<B-1;++b)C.write_shift(-4,b+1);he&&(++b,C.write_shift(-4,Q))};for(B=b=0,B+=E[1];b<B;++b)C.write_shift(-4,Se.DIFSECT);for(B+=E[2];b<B;++b)C.write_shift(-4,Se.FATSECT);Y(E[3]),Y(E[4]);for(var L=0,z=0,W=_.FileIndex[0];L<_.FileIndex.length;++L)W=_.FileIndex[L],W.content&&(z=W.content.length,!(z<4096)&&(W.start=B,Y(z+511>>9)));for(Y(E[6]+7>>3);C.l&511;)C.write_shift(-4,Se.ENDOFCHAIN);for(B=b=0,L=0;L<_.FileIndex.length;++L)W=_.FileIndex[L],W.content&&(z=W.content.length,!(!z||z>=4096)&&(W.start=B,Y(z+63>>6)));for(;C.l&511;)C.write_shift(-4,Se.ENDOFCHAIN);for(b=0;b<E[4]<<2;++b){var ee=_.FullPaths[b];if(!ee||ee.length===0){for(L=0;L<17;++L)C.write_shift(4,0);for(L=0;L<3;++L)C.write_shift(4,-1);for(L=0;L<12;++L)C.write_shift(4,0);continue}W=_.FileIndex[b],b===0&&(W.start=W.size?W.start-1:Q);var ce=b===0&&S.root||W.name;if(z=2*(ce.length+1),C.write_shift(64,ce,"utf16le"),C.write_shift(2,z),C.write_shift(1,W.type),C.write_shift(1,W.color),C.write_shift(-4,W.L),C.write_shift(-4,W.R),C.write_shift(-4,W.C),W.clsid)C.write_shift(16,W.clsid,"hex");else for(L=0;L<4;++L)C.write_shift(4,0);C.write_shift(4,W.state||0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,0),C.write_shift(4,W.start),C.write_shift(4,W.size),C.write_shift(4,0)}for(b=1;b<_.FileIndex.length;++b)if(W=_.FileIndex[b],W.size>=4096)if(C.l=W.start+1<<9,Be&&Buffer.isBuffer(W.content))W.content.copy(C,C.l,0,W.size),C.l+=W.size+511&-512;else{for(L=0;L<W.size;++L)C.write_shift(1,W.content[L]);for(;L&511;++L)C.write_shift(1,0)}for(b=1;b<_.FileIndex.length;++b)if(W=_.FileIndex[b],W.size>0&&W.size<4096)if(Be&&Buffer.isBuffer(W.content))W.content.copy(C,C.l,0,W.size),C.l+=W.size+63&-64;else{for(L=0;L<W.size;++L)C.write_shift(1,W.content[L]);for(;L&63;++L)C.write_shift(1,0)}if(Be)C.l=C.length;else for(;C.l<C.length;)C.write_shift(1,0);return C}function K(_,N){var S=_.FullPaths.map(function(L){return L.toUpperCase()}),E=S.map(function(L){var z=L.split("/");return z[z.length-(L.slice(-1)=="/"?2:1)]}),C=!1;N.charCodeAt(0)===47?(C=!0,N=S[0].slice(0,-1)+N):C=N.indexOf("/")!==-1;var b=N.toUpperCase(),B=C===!0?S.indexOf(b):E.indexOf(b);if(B!==-1)return _.FileIndex[B];var Y=!b.match(Uo);for(b=b.replace(wa,""),Y&&(b=b.replace(Uo,"!")),B=0;B<S.length;++B)if((Y?S[B].replace(Uo,"!"):S[B]).replace(wa,"")==b||(Y?E[B].replace(Uo,"!"):E[B]).replace(wa,"")==b)return _.FileIndex[B];return null}var G=64,Q=-2,ye="d0cf11e0a1b11ae1",Ee=[208,207,17,224,161,177,26,225],re="00000000000000000000000000000000",Se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Q,FREESECT:-1,HEADER_SIGNATURE:ye,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:re,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function le(_,N,S){c();var E=R(_,S);l.writeFileSync(N,E)}function xe(_){for(var N=new Array(_.length),S=0;S<_.length;++S)N[S]=String.fromCharCode(_[S]);return N.join("")}function we(_,N){var S=R(_,N);switch(N&&N.type||"buffer"){case"file":return c(),l.writeFileSync(N.filename,S),S;case"binary":return typeof S=="string"?S:xe(S);case"base64":return Ka(typeof S=="string"?S:xe(S));case"buffer":if(Be)return Buffer.isBuffer(S)?S:Cn(S);case"array":return typeof S=="string"?Hr(S):S}return S}var be;function F(_){try{var N=_.InflateRaw,S=new N;if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),S.bytesRead)be=_;else throw new Error("zlib does not expose bytesRead")}catch(E){console.error("cannot use native zlib: "+(E.message||E))}}function U(_,N){if(!be)return ad(_,N);var S=be.InflateRaw,E=new S,C=E._processChunk(_.slice(_.l),E._finishFlushFlag);return _.l+=E.bytesRead,C}function D(_){return be?be.deflateRawSync(_):Ht(_)}var P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(_){var N=(_<<1|_<<11)&139536|(_<<5|_<<15)&558144;return(N>>16|N>>8|N)&255}for(var ge=typeof Uint8Array<"u",ue=ge?new Uint8Array(256):[],De=0;De<256;++De)ue[De]=ve(De);function Oe(_,N){var S=ue[_&255];return N<=8?S>>>8-N:(S=S<<8|ue[_>>8&255],N<=16?S>>>16-N:(S=S<<8|ue[_>>16&255],S>>>24-N))}function Tt(_,N){var S=N&7,E=N>>>3;return(_[E]|(S<=6?0:_[E+1]<<8))>>>S&3}function Ie(_,N){var S=N&7,E=N>>>3;return(_[E]|(S<=5?0:_[E+1]<<8))>>>S&7}function Pr(_,N){var S=N&7,E=N>>>3;return(_[E]|(S<=4?0:_[E+1]<<8))>>>S&15}function Ze(_,N){var S=N&7,E=N>>>3;return(_[E]|(S<=3?0:_[E+1]<<8))>>>S&31}function de(_,N){var S=N&7,E=N>>>3;return(_[E]|(S<=1?0:_[E+1]<<8))>>>S&127}function Wt(_,N,S){var E=N&7,C=N>>>3,b=(1<<S)-1,B=_[C]>>>E;return S<8-E||(B|=_[C+1]<<8-E,S<16-E)||(B|=_[C+2]<<16-E,S<24-E)||(B|=_[C+3]<<24-E),B&b}function Dr(_,N,S){var E=N&7,C=N>>>3;return E<=5?_[C]|=(S&7)<<E:(_[C]|=S<<E&255,_[C+1]=(S&7)>>8-E),N+3}function sn(_,N,S){var E=N&7,C=N>>>3;return S=(S&1)<<E,_[C]|=S,N+1}function M(_,N,S){var E=N&7,C=N>>>3;return S<<=E,_[C]|=S&255,S>>>=8,_[C+1]=S,N+8}function ie(_,N,S){var E=N&7,C=N>>>3;return S<<=E,_[C]|=S&255,S>>>=8,_[C+1]=S&255,_[C+2]=S>>>8,N+16}function V(_,N){var S=_.length,E=2*S>N?2*S:N+5,C=0;if(S>=N)return _;if(Be){var b=np(E);if(_.copy)_.copy(b);else for(;C<_.length;++C)b[C]=_[C];return b}else if(ge){var B=new Uint8Array(E);if(B.set)B.set(_);else for(;C<S;++C)B[C]=_[C];return B}return _.length=E,_}function q(_){for(var N=new Array(_),S=0;S<_;++S)N[S]=0;return N}function oe(_,N,S){var E=1,C=0,b=0,B=0,Y=0,L=_.length,z=ge?new Uint16Array(32):q(32);for(b=0;b<32;++b)z[b]=0;for(b=L;b<S;++b)_[b]=0;L=_.length;var W=ge?new Uint16Array(L):q(L);for(b=0;b<L;++b)z[C=_[b]]++,E<C&&(E=C),W[b]=0;for(z[0]=0,b=1;b<=E;++b)z[b+16]=Y=Y+z[b-1]<<1;for(b=0;b<L;++b)Y=_[b],Y!=0&&(W[b]=z[Y+16]++);var ee=0;for(b=0;b<L;++b)if(ee=_[b],ee!=0)for(Y=Oe(W[b],E)>>E-ee,B=(1<<E+4-ee)-1;B>=0;--B)N[Y|B<<ee]=ee&15|b<<4;return E}var _e=ge?new Uint16Array(512):q(512),Re=ge?new Uint16Array(32):q(32);if(!ge){for(var je=0;je<512;++je)_e[je]=0;for(je=0;je<32;++je)Re[je]=0}(function(){for(var _=[],N=0;N<32;N++)_.push(5);oe(_,Re,32);var S=[];for(N=0;N<=143;N++)S.push(8);for(;N<=255;N++)S.push(9);for(;N<=279;N++)S.push(7);for(;N<=287;N++)S.push(8);oe(S,_e,288)})();var Er=function(){for(var N=ge?new Uint8Array(32768):[],S=0,E=0;S<pe.length-1;++S)for(;E<pe[S+1];++E)N[E]=S;for(;E<32768;++E)N[E]=29;var C=ge?new Uint8Array(259):[];for(S=0,E=0;S<J.length-1;++S)for(;E<J[S+1];++E)C[E]=S;function b(Y,L){for(var z=0;z<Y.length;){var W=Math.min(65535,Y.length-z),ee=z+W==Y.length;for(L.write_shift(1,+ee),L.write_shift(2,W),L.write_shift(2,~W&65535);W-- >0;)L[L.l++]=Y[z++]}return L.l}function B(Y,L){for(var z=0,W=0,ee=ge?new Uint16Array(32768):[];W<Y.length;){var ce=Math.min(65535,Y.length-W);if(ce<10){for(z=Dr(L,z,+(W+ce==Y.length)),z&7&&(z+=8-(z&7)),L.l=z/8|0,L.write_shift(2,ce),L.write_shift(2,~ce&65535);ce-- >0;)L[L.l++]=Y[W++];z=L.l*8;continue}z=Dr(L,z,+(W+ce==Y.length)+2);for(var he=0;ce-- >0;){var ne=Y[W];he=(he<<5^ne)&32767;var fe=-1,Te=0;if((fe=ee[he])&&(fe|=W&-32768,fe>W&&(fe-=32768),fe<W))for(;Y[fe+Te]==Y[W+Te]&&Te<250;)++Te;if(Te>2){ne=C[Te],ne<=22?z=M(L,z,ue[ne+1]>>1)-1:(M(L,z,3),z+=5,M(L,z,ue[ne-23]>>5),z+=3);var tt=ne<8?0:ne-4>>2;tt>0&&(ie(L,z,Te-J[ne]),z+=tt),ne=N[W-fe],z=M(L,z,ue[ne]>>3),z-=3;var rt=ne<4?0:ne-2>>1;rt>0&&(ie(L,z,W-fe-pe[ne]),z+=rt);for(var Rt=0;Rt<Te;++Rt)ee[he]=W&32767,he=(he<<5^Y[W])&32767,++W;ce-=Te-1}else ne<=143?ne=ne+48:z=sn(L,z,1),z=M(L,z,ue[ne]),ee[he]=W&32767,++W}z=M(L,z,0)-1}return L.l=(z+7)/8|0,L.l}return function(L,z){return L.length<8?b(L,z):B(L,z)}}();function Ht(_){var N=X(50+Math.floor(_.length*1.1)),S=Er(_,N);return N.slice(0,S)}var Ir=ge?new Uint16Array(32768):q(32768),Ui=ge?new Uint16Array(32768):q(32768),ci=ge?new Uint16Array(128):q(128),ui=1,sd=1;function Nv(_,N){var S=Ze(_,N)+257;N+=5;var E=Ze(_,N)+1;N+=5;var C=Pr(_,N)+4;N+=4;for(var b=0,B=ge?new Uint8Array(19):q(19),Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],L=1,z=ge?new Uint8Array(8):q(8),W=ge?new Uint8Array(8):q(8),ee=B.length,ce=0;ce<C;++ce)B[P[ce]]=b=Ie(_,N),L<b&&(L=b),z[b]++,N+=3;var he=0;for(z[0]=0,ce=1;ce<=L;++ce)W[ce]=he=he+z[ce-1]<<1;for(ce=0;ce<ee;++ce)(he=B[ce])!=0&&(Y[ce]=W[he]++);var ne=0;for(ce=0;ce<ee;++ce)if(ne=B[ce],ne!=0){he=ue[Y[ce]]>>8-ne;for(var fe=(1<<7-ne)-1;fe>=0;--fe)ci[he|fe<<ne]=ne&7|ce<<3}var Te=[];for(L=1;Te.length<S+E;)switch(he=ci[de(_,N)],N+=he&7,he>>>=3){case 16:for(b=3+Tt(_,N),N+=2,he=Te[Te.length-1];b-- >0;)Te.push(he);break;case 17:for(b=3+Ie(_,N),N+=3;b-- >0;)Te.push(0);break;case 18:for(b=11+de(_,N),N+=7;b-- >0;)Te.push(0);break;default:Te.push(he),L<he&&(L=he);break}var tt=Te.slice(0,S),rt=Te.slice(S);for(ce=S;ce<286;++ce)tt[ce]=0;for(ce=E;ce<30;++ce)rt[ce]=0;return ui=oe(tt,Ir,286),sd=oe(rt,Ui,30),N}function Cv(_,N){if(_[0]==3&&!(_[1]&3))return[Ai(N),2];for(var S=0,E=0,C=np(N||1<<18),b=0,B=C.length>>>0,Y=0,L=0;!(E&1);){if(E=Ie(_,S),S+=3,E>>>1)E>>1==1?(Y=9,L=5):(S=Nv(_,S),Y=ui,L=sd);else{S&7&&(S+=8-(S&7));var z=_[S>>>3]|_[(S>>>3)+1]<<8;if(S+=32,z>0)for(!N&&B<b+z&&(C=V(C,b+z),B=C.length);z-- >0;)C[b++]=_[S>>>3],S+=8;continue}for(;;){!N&&B<b+32767&&(C=V(C,b+32767),B=C.length);var W=Wt(_,S,Y),ee=E>>>1==1?_e[W]:Ir[W];if(S+=ee&15,ee>>>=4,!(ee>>>8&255))C[b++]=ee;else{if(ee==256)break;ee-=257;var ce=ee<8?0:ee-4>>2;ce>5&&(ce=0);var he=b+J[ee];ce>0&&(he+=Wt(_,S,ce),S+=ce),W=Wt(_,S,L),ee=E>>>1==1?Re[W]:Ui[W],S+=ee&15,ee>>>=4;var ne=ee<4?0:ee-2>>1,fe=pe[ee];for(ne>0&&(fe+=Wt(_,S,ne),S+=ne),!N&&B<he&&(C=V(C,he+100),B=C.length);b<he;)C[b]=C[b-fe],++b}}}return N?[C,S+7>>>3]:[C.slice(0,b),S+7>>>3]}function ad(_,N){var S=_.slice(_.l||0),E=Cv(S,N);return _.l+=E[1],E[0]}function od(_,N){if(_)typeof console<"u"&&console.error(N);else throw new Error(N)}function ld(_,N){var S=_;pr(S,0);var E=[],C=[],b={FileIndex:E,FullPaths:C};T(b,{root:N.root});for(var B=S.length-4;(S[B]!=80||S[B+1]!=75||S[B+2]!=5||S[B+3]!=6)&&B>=0;)--B;S.l=B+4,S.l+=4;var Y=S.read_shift(2);S.l+=6;var L=S.read_shift(4);for(S.l=L,B=0;B<Y;++B){S.l+=20;var z=S.read_shift(4),W=S.read_shift(4),ee=S.read_shift(2),ce=S.read_shift(2),he=S.read_shift(2);S.l+=8;var ne=S.read_shift(4),fe=o(S.slice(S.l+ee,S.l+ee+ce));S.l+=ee+ce+he;var Te=S.l;S.l=ne+4,bv(S,z,W,b,fe),S.l=Te}return b}function bv(_,N,S,E,C){_.l+=2;var b=_.read_shift(2),B=_.read_shift(2),Y=a(_);if(b&8257)throw new Error("Unsupported ZIP encryption");for(var L=_.read_shift(4),z=_.read_shift(4),W=_.read_shift(4),ee=_.read_shift(2),ce=_.read_shift(2),he="",ne=0;ne<ee;++ne)he+=String.fromCharCode(_[_.l++]);if(ce){var fe=o(_.slice(_.l,_.l+ce));(fe[21589]||{}).mt&&(Y=fe[21589].mt),((C||{})[21589]||{}).mt&&(Y=C[21589].mt)}_.l+=ce;var Te=_.slice(_.l,_.l+z);switch(B){case 8:Te=U(_,W);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+B)}var tt=!1;b&8&&(L=_.read_shift(4),L==134695760&&(L=_.read_shift(4),tt=!0),z=_.read_shift(4),W=_.read_shift(4)),z!=N&&od(tt,"Bad compressed size: "+N+" != "+z),W!=S&&od(tt,"Bad uncompressed size: "+S+" != "+W),Oc(E,he,Te,{unsafe:!0,mt:Y})}function Av(_,N){var S=N||{},E=[],C=[],b=X(1),B=S.compression?8:0,Y=0,L=0,z=0,W=0,ee=0,ce=_.FullPaths[0],he=ce,ne=_.FileIndex[0],fe=[],Te=0;for(L=1;L<_.FullPaths.length;++L)if(he=_.FullPaths[L].slice(ce.length),ne=_.FileIndex[L],!(!ne.size||!ne.content||he=="Sh33tJ5")){var tt=W,rt=X(he.length);for(z=0;z<he.length;++z)rt.write_shift(1,he.charCodeAt(z)&127);rt=rt.slice(0,rt.l),fe[ee]=t4.buf(ne.content,0);var Rt=ne.content;B==8&&(Rt=D(Rt)),b=X(30),b.write_shift(4,67324752),b.write_shift(2,20),b.write_shift(2,Y),b.write_shift(2,B),ne.mt?s(b,ne.mt):b.write_shift(4,0),b.write_shift(-4,fe[ee]),b.write_shift(4,Rt.length),b.write_shift(4,ne.content.length),b.write_shift(2,rt.length),b.write_shift(2,0),W+=b.length,E.push(b),W+=rt.length,E.push(rt),W+=Rt.length,E.push(Rt),b=X(46),b.write_shift(4,33639248),b.write_shift(2,0),b.write_shift(2,20),b.write_shift(2,Y),b.write_shift(2,B),b.write_shift(4,0),b.write_shift(-4,fe[ee]),b.write_shift(4,Rt.length),b.write_shift(4,ne.content.length),b.write_shift(2,rt.length),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(4,0),b.write_shift(4,tt),Te+=b.l,C.push(b),Te+=rt.length,C.push(rt),++ee}return b=X(22),b.write_shift(4,101010256),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,ee),b.write_shift(2,ee),b.write_shift(4,Te),b.write_shift(4,W),b.write_shift(2,0),Ft([Ft(E),Ft(C),b])}var po={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Fv(_,N){if(_.ctype)return _.ctype;var S=_.name||"",E=S.match(/\.([^\.]+)$/);return E&&po[E[1]]||N&&(E=(S=N).match(/[\.\\]([^\.\\])+$/),E&&po[E[1]])?po[E[1]]:"application/octet-stream"}function Ov(_){for(var N=Ka(_),S=[],E=0;E<N.length;E+=76)S.push(N.slice(E,E+76));return S.join(`\r
`)+`\r
`}function jv(_){var N=_.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(z){var W=z.charCodeAt(0).toString(16).toUpperCase();return"="+(W.length==1?"0"+W:W)});N=N.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),N.charAt(0)==`
`&&(N="=0D"+N.slice(1)),N=N.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var S=[],E=N.split(`\r
`),C=0;C<E.length;++C){var b=E[C];if(b.length==0){S.push("");continue}for(var B=0;B<b.length;){var Y=76,L=b.slice(B,B+Y);L.charAt(Y-1)=="="?Y--:L.charAt(Y-2)=="="?Y-=2:L.charAt(Y-3)=="="&&(Y-=3),L=b.slice(B,B+Y),B+=Y,B<b.length&&(L+="="),S.push(L)}}return S.join(`\r
`)}function Pv(_){for(var N=[],S=0;S<_.length;++S){for(var E=_[S];S<=_.length&&E.charAt(E.length-1)=="=";)E=E.slice(0,E.length-1)+_[++S];N.push(E)}for(var C=0;C<N.length;++C)N[C]=N[C].replace(/[=][0-9A-Fa-f]{2}/g,function(b){return String.fromCharCode(parseInt(b.slice(1),16))});return Hr(N.join(`\r
`))}function Dv(_,N,S){for(var E="",C="",b="",B,Y=0;Y<10;++Y){var L=N[Y];if(!L||L.match(/^\s*$/))break;var z=L.match(/^(.*?):\s*([^\s].*)$/);if(z)switch(z[1].toLowerCase()){case"content-location":E=z[2].trim();break;case"content-type":b=z[2].trim();break;case"content-transfer-encoding":C=z[2].trim();break}}switch(++Y,C.toLowerCase()){case"base64":B=Hr(Tn(N.slice(Y).join("")));break;case"quoted-printable":B=Pv(N.slice(Y));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+C)}var W=Oc(_,E.slice(S.length),B,{unsafe:!0});b&&(W.ctype=b)}function Iv(_,N){if(xe(_.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var S=N&&N.root||"",E=(Be&&Buffer.isBuffer(_)?_.toString("binary"):xe(_)).split(`\r
`),C=0,b="";for(C=0;C<E.length;++C)if(b=E[C],!!/^Content-Location:/i.test(b)&&(b=b.slice(b.indexOf("file")),S||(S=b.slice(0,b.lastIndexOf("/")+1)),b.slice(0,S.length)!=S))for(;S.length>0&&(S=S.slice(0,S.length-1),S=S.slice(0,S.lastIndexOf("/")+1),b.slice(0,S.length)!=S););var B=(E[1]||"").match(/boundary="(.*?)"/);if(!B)throw new Error("MAD cannot find boundary");var Y="--"+(B[1]||""),L=[],z=[],W={FileIndex:L,FullPaths:z};T(W);var ee,ce=0;for(C=0;C<E.length;++C){var he=E[C];he!==Y&&he!==Y+"--"||(ce++&&Dv(W,E.slice(ee,C),S),ee=C)}return W}function Rv(_,N){var S=N||{},E=S.boundary||"SheetJS";E="------="+E;for(var C=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+E.slice(2)+'"',"","",""],b=_.FullPaths[0],B=b,Y=_.FileIndex[0],L=1;L<_.FullPaths.length;++L)if(B=_.FullPaths[L].slice(b.length),Y=_.FileIndex[L],!(!Y.size||!Y.content||B=="Sh33tJ5")){B=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Te){return"_x"+Te.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Te){return"_u"+Te.charCodeAt(0).toString(16)+"_"});for(var z=Y.content,W=Be&&Buffer.isBuffer(z)?z.toString("binary"):xe(z),ee=0,ce=Math.min(1024,W.length),he=0,ne=0;ne<=ce;++ne)(he=W.charCodeAt(ne))>=32&&he<128&&++ee;var fe=ee>=ce*4/5;C.push(E),C.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+B),C.push("Content-Transfer-Encoding: "+(fe?"quoted-printable":"base64")),C.push("Content-Type: "+Fv(Y,B)),C.push(""),C.push(fe?jv(W):Ov(W))}return C.push(E+`--\r
`),C.join(`\r
`)}function Lv(_){var N={};return T(N,_),N}function Oc(_,N,S,E){var C=E&&E.unsafe;C||T(_);var b=!C&&Ge.find(_,N);if(!b){var B=_.FullPaths[0];N.slice(0,B.length)==B?B=N:(B.slice(-1)!="/"&&(B+="/"),B=(B+N).replace("//","/")),b={name:i(N),type:2},_.FileIndex.push(b),_.FullPaths.push(B),C||Ge.utils.cfb_gc(_)}return b.content=S,b.size=S?S.length:0,E&&(E.CLSID&&(b.clsid=E.CLSID),E.mt&&(b.mt=E.mt),E.ct&&(b.ct=E.ct)),b}function Mv(_,N){T(_);var S=Ge.find(_,N);if(S){for(var E=0;E<_.FileIndex.length;++E)if(_.FileIndex[E]==S)return _.FileIndex.splice(E,1),_.FullPaths.splice(E,1),!0}return!1}function Bv(_,N,S){T(_);var E=Ge.find(_,N);if(E){for(var C=0;C<_.FileIndex.length;++C)if(_.FileIndex[C]==E)return _.FileIndex[C].name=i(S),_.FullPaths[C]=S,!0}return!1}function Uv(_){A(_,!0)}return t.find=K,t.read=O,t.parse=u,t.write=we,t.writeFile=le,t.utils={cfb_new:Lv,cfb_add:Oc,cfb_del:Mv,cfb_mov:Bv,cfb_gc:Uv,ReadShift:Sa,CheckField:Eg,prep_blob:pr,bconcat:Ft,use_zlib:F,_deflateRaw:Ht,_inflateRaw:ad,consts:Se},t}();function r4(e){return typeof e=="string"?Ec(e):Array.isArray(e)?bT(e):e}function lo(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ec(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Xa(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([r4(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=oo(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function It(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function fp(e,t){for(var r=[],n=It(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function Uf(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Nc(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function n4(e){for(var t=[],r=It(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var zl=new Date(1899,11,30,0,0,0);function cr(e,t){var r=e.getTime(),n=zl.getTime()+(e.getTimezoneOffset()-zl.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var ag=new Date,i4=zl.getTime()+(ag.getTimezoneOffset()-zl.getTimezoneOffset())*6e4,dp=ag.getTimezoneOffset();function og(e){var t=new Date;return t.setTime(e*24*60*60*1e3+i4),t.getTimezoneOffset()!==dp&&t.setTime(t.getTime()+(t.getTimezoneOffset()-dp)*6e4),t}var hp=new Date("2017-02-19T19:06:09.000Z"),lg=isNaN(hp.getFullYear())?new Date("2/19/17"):hp,s4=lg.getFullYear()==2017;function Jt(e,t){var r=new Date(e);if(s4)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(lg.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Cc(e,t){if(Be&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function ur(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ur(e[r]));return t}function ot(e,t){for(var r="";r.length<t;)r+=e;return r}function gn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var a4=["january","february","march","april","may","june","july","august","september","october","november","december"];function qa(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&a4.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Ce(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Be?n=Cn(r):n=AT(r),Ge.utils.cfb_add(e,t,n)}Ge.utils.cfb_add(e,t,r)}else e.file(t,r)}function $f(){return Ge.utils.cfb_new()}var pt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,o4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},zf=Uf(o4),Wf=/[&<>'"]/g,l4=/[\u0000-\u0008\u000b-\u001f]/g;function We(e){var t=e+"";return t.replace(Wf,function(r){return zf[r]}).replace(l4,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function pp(e){return We(e).replace(/ /g,"_x0020_")}var cg=/[\u0000-\u001f]/g;function c4(e){var t=e+"";return t.replace(Wf,function(r){return zf[r]}).replace(/\n/g,"<br/>").replace(cg,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function u4(e){var t=e+"";return t.replace(Wf,function(r){return zf[r]}).replace(cg,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function f4(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function d4(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function mu(e){for(var t="",r=0,n=0,i=0,s=0,a=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function mp(e){var t=Ai(2*e.length),r,n,i=1,s=0,a=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function xp(e){return Cn(e,"binary").toString("utf8")}var zo="foo bar bazâð£",_a=Be&&(xp(zo)==mu(zo)&&xp||mp(zo)==mu(zo)&&mp)||mu,Xa=Be?function(e){return Cn(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},h4=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),ug=/(^\s|\s$|\n)/;function Ot(e,t){return"<"+e+(t.match(ug)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Ya(e){return It(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function se(e,t,r){return"<"+e+(r!=null?Ya(r):"")+(t!=null?(t.match(ug)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function A0(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function p4(e,t){switch(typeof e){case"string":var r=se("vt:lpwstr",We(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return se((e|0)==e?"vt:i4":"vt:r8",We(String(e)));case"boolean":return se("vt:bool",e?"true":"false")}if(e instanceof Date)return se("vt:filetime",A0(e));throw new Error("Unable to serialize "+e)}var wt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Bs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],mr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function m4(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function x4(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=n?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var gp=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},vp=Be?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Cn(t)})):gp(e)}:gp,yp=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(oa(e,i)));return n.join("").replace(wa,"")},Hf=Be?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(wa,""):yp(e,t,r)}:yp,wp=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},fg=Be?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):wp(e,t,r)}:wp,_p=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Yi(e,i)));return n.join("")},co=Be?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):_p(t,r,n)}:_p,dg=function(e,t){var r=xr(e,t);return r>0?co(e,t+4,t+4+r-1):""},hg=dg,pg=function(e,t){var r=xr(e,t);return r>0?co(e,t+4,t+4+r-1):""},mg=pg,xg=function(e,t){var r=2*xr(e,t);return r>0?co(e,t+4,t+4+r-1):""},gg=xg,vg=function(t,r){var n=xr(t,r);return n>0?Hf(t,r+4,r+4+n):""},yg=vg,wg=function(e,t){var r=xr(e,t);return r>0?co(e,t+4,t+4+r):""},_g=wg,Sg=function(e,t){return m4(e,t)},Wl=Sg,Vf=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Be&&(hg=function(t,r){if(!Buffer.isBuffer(t))return dg(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},mg=function(t,r){if(!Buffer.isBuffer(t))return pg(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},gg=function(t,r){if(!Buffer.isBuffer(t))return xg(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},yg=function(t,r){if(!Buffer.isBuffer(t))return vg(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},_g=function(t,r){if(!Buffer.isBuffer(t))return wg(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Wl=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Sg(t,r)},Vf=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Yi=function(e,t){return e[t]},oa=function(e,t){return e[t+1]*256+e[t]},g4=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},xr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},gi=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},v4=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Sa(e,t){var r="",n,i,s=[],a,o,l,c;switch(t){case"dbcs":if(c=this.l,Be&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(oa(this,c)),c+=2;e*=2;break;case"utf8":r=co(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Hf(this,this.l,this.l+e);break;case"wstr":return Sa.call(this,e,"dbcs");case"lpstr-ansi":r=hg(this,this.l),e=4+xr(this,this.l);break;case"lpstr-cp":r=mg(this,this.l),e=4+xr(this,this.l);break;case"lpwstr":r=gg(this,this.l),e=4+2*xr(this,this.l);break;case"lpp4":e=4+xr(this,this.l),r=yg(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+xr(this,this.l),r=_g(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(a=Yi(this,this.l+e++))!==0;)s.push(Bo(a));r=s.join("");break;case"_wstr":for(e=0,r="";(a=oa(this,this.l+e))!==0;)s.push(Bo(a)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Yi(this,c),this.l=c+1,o=Sa.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Bo(oa(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Yi(this,c),this.l=c+1,o=Sa.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Bo(Yi(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Yi(this,this.l),this.l++,n;case 2:return n=(t==="i"?g4:oa)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?gi:v4)(this,this.l),this.l+=4,n):(i=xr(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Wl(this,this.l):i=Wl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=fg(this,this.l,e);break}}return this.l+=e,r}var y4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},w4=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},_4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function S4(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)_4(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,y4(this,t,this.l);break;case 8:if(n=8,r==="f"){x4(this,t,this.l);break}case 16:break;case-4:n=4,w4(this,t,this.l);break}return this.l+=n,this}function Eg(e,t){var r=fg(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function pr(e,t){e.l=t,e.read_shift=Sa,e.chk=Eg,e.write_shift=S4}function nn(e,t){e.l+=t}function X(e){var t=Ai(e);return pr(t,0),t}function lr(){var e=[],t=Be?256:2048,r=function(c){var u=X(c);return pr(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},a=function(){return i(),Ft(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function Z(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=mA[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=e.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&Vf(r)&&e.push(r)}}function Ea(e,t,r){var n=ur(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Sp(e,t,r){var n=ur(e);return n.s=Ea(n.s,t.s,r),n.e=Ea(n.e,t.s,r),n}function Ta(e,t){if(e.cRel&&e.c<0)for(e=ur(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ur(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ve(e);return!e.cRel&&e.cRel!=null&&(r=k4(r)),!e.rRel&&e.rRel!=null&&(r=E4(r)),r}function xu(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ut(e.s.c)+":"+(e.e.cRel?"":"$")+Ut(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Pt(e.s.r)+":"+(e.e.rRel?"":"$")+Pt(e.e.r):Ta(e.s,t.biff)+":"+Ta(e.e,t.biff)}function Gf(e){return parseInt(T4(e),10)-1}function Pt(e){return""+(e+1)}function E4(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function T4(e){return e.replace(/\$(\d+)$/,"$1")}function Kf(e){for(var t=N4(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ut(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function k4(e){return e.replace(/^([A-Z])/,"$$$1")}function N4(e){return e.replace(/^\$([A-Z])/,"$1")}function C4(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function _t(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Ve(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function wr(e){var t=e.indexOf(":");return t==-1?{s:_t(e),e:_t(e)}:{s:_t(e.slice(0,t)),e:_t(e.slice(t+1))}}function ht(e,t){return typeof t>"u"||typeof t=="number"?ht(e.s,e.e):(typeof e!="string"&&(e=Ve(e)),typeof t!="string"&&(t=Ve(t)),e==t?e:e+":"+t)}function Qe(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Ep(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Zn(e.z,r?cr(t):t)}catch{}try{return e.w=Zn((e.XF||{}).numFmtId||(r?14:0),r?cr(t):t)}catch{return""+t}}function kn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?uo[e.v]||e.v:t==null?Ep(e,e.v):Ep(e,t))}function Ii(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Tg(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?_t(n.origin):n.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Qe(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var p={v:t[d][h]},v=a+d,m=o+h;if(c.s.r>v&&(c.s.r=v),c.s.c>m&&(c.s.c=m),c.e.r<v&&(c.e.r=v),c.e.c<m&&(c.e.c=m),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))p=t[d][h];else if(Array.isArray(p.v)&&(p.f=t[d][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||lt[14],n.cellDates?(p.t="d",p.w=Zn(p.z,cr(p.v))):(p.t="n",p.v=cr(p.v),p.w=Zn(p.z,p.v))):p.t="s";if(i)s[v]||(s[v]=[]),s[v][m]&&s[v][m].z&&(p.z=s[v][m].z),s[v][m]=p;else{var x=Ve({c:m,r:v});s[x]&&s[x].z&&(p.z=s[x].z),s[x]=p}}}return c.s.c<1e7&&(s["!ref"]=ht(c)),s}function Us(e,t){return Tg(null,e,t)}function b4(e){return e.read_shift(4,"i")}function qr(e,t){return t||(t=X(4)),t.write_shift(4,e),t}function $t(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function St(e,t){var r=!1;return t==null&&(r=!0,t=X(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function A4(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function F4(e,t){return t||(t=X(4)),t.write_shift(2,0),t.write_shift(2,0),t}function qf(e,t){var r=e.l,n=e.read_shift(1),i=$t(e),s=[],a={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(A4(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}function O4(e,t){var r=!1;return t==null&&(r=!0,t=X(15+4*e.t.length)),t.write_shift(1,0),St(e.t,t),r?t.slice(0,t.l):t}var j4=qf;function P4(e,t){var r=!1;return t==null&&(r=!0,t=X(23+4*e.t.length)),t.write_shift(1,1),St(e.t,t),t.write_shift(4,1),F4({},t),r?t.slice(0,t.l):t}function jr(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ri(e,t){return t==null&&(t=X(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Li(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Mi(e,t){return t==null&&(t=X(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var D4=$t,kg=St;function Xf(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Hl(e,t){var r=!1;return t==null&&(r=!0,t=X(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var I4=$t,F0=Xf,Yf=Hl;function Ng(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?Wl([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):gi(t,0)>>2;return r?i/100:i}function Cg(e,t){t==null&&(t=X(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function bg(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function R4(e,t){return t||(t=X(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Bi=bg,$s=R4;function zs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Fi(e,t){return(t||X(8)).write_shift(8,e,"f")}function L4(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=G4[i];c&&(t.rgb=Dp(c));break;case 2:t.rgb=Dp([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Vl(e,t){if(t||(t=X(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function M4(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function B4(e,t){t||(t=X(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var Ag=2,fr=3,Wo=11,Gl=19,Ho=64,U4=65,$4=71,z4=4108,W4=4126,bt=80,Tp={1:{n:"CodePage",t:Ag},2:{n:"Category",t:bt},3:{n:"PresentationFormat",t:bt},4:{n:"ByteCount",t:fr},5:{n:"LineCount",t:fr},6:{n:"ParagraphCount",t:fr},7:{n:"SlideCount",t:fr},8:{n:"NoteCount",t:fr},9:{n:"HiddenCount",t:fr},10:{n:"MultimediaClipCount",t:fr},11:{n:"ScaleCrop",t:Wo},12:{n:"HeadingPairs",t:z4},13:{n:"TitlesOfParts",t:W4},14:{n:"Manager",t:bt},15:{n:"Company",t:bt},16:{n:"LinksUpToDate",t:Wo},17:{n:"CharacterCount",t:fr},19:{n:"SharedDoc",t:Wo},22:{n:"HyperlinksChanged",t:Wo},23:{n:"AppVersion",t:fr,p:"version"},24:{n:"DigSig",t:U4},26:{n:"ContentType",t:bt},27:{n:"ContentStatus",t:bt},28:{n:"Language",t:bt},29:{n:"Version",t:bt},255:{},2147483648:{n:"Locale",t:Gl},2147483651:{n:"Behavior",t:Gl},1919054434:{}},kp={1:{n:"CodePage",t:Ag},2:{n:"Title",t:bt},3:{n:"Subject",t:bt},4:{n:"Author",t:bt},5:{n:"Keywords",t:bt},6:{n:"Comments",t:bt},7:{n:"Template",t:bt},8:{n:"LastAuthor",t:bt},9:{n:"RevNumber",t:bt},10:{n:"EditTime",t:Ho},11:{n:"LastPrinted",t:Ho},12:{n:"CreatedDate",t:Ho},13:{n:"ModifiedDate",t:Ho},14:{n:"PageCount",t:fr},15:{n:"WordCount",t:fr},16:{n:"CharCount",t:fr},17:{n:"Thumbnail",t:$4},18:{n:"Application",t:bt},19:{n:"DocSecurity",t:fr},255:{},2147483648:{n:"Locale",t:Gl},2147483651:{n:"Behavior",t:Gl},1919054434:{}};function H4(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var V4=H4([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),G4=ur(V4),uo={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},K4={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Vo={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Fg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Og(e,t){var r=n4(K4),n=[],i;n[n.length]=pt,n[n.length]=se("Types",null,{xmlns:wt.CT,"xmlns:xsd":wt.xsd,"xmlns:xsi":wt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return se("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=se("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Vo[l][t.bookType]||Vo[l].xlsx}))},a=function(l){(e[l]||[]).forEach(function(c){n[n.length]=se("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Vo[l][t.bookType]||Vo[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=se("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Le={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function jg(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function vs(e){var t=[pt,se("Relationships",null,{xmlns:wt.RELS})];return It(e["!id"]).forEach(function(r){t[t.length]=se("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ze(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Le.HLINK,Le.XPATH,Le.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function q4(e){var t=[pt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Np(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function X4(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Y4(e){var t=[pt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Np(e[r][0],e[r][1])),t.push(X4("",e[r][0]));return t.push(Np("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Pg(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ll.version+"</meta:generator></office:meta></office:document-meta>"}var Ei=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function gu(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=We(t),n[n.length]=r?se(e,t,r):Ot(e,t))}function Dg(e,t){var r=t||{},n=[pt,se("cp:coreProperties",null,{"xmlns:cp":wt.CORE_PROPS,"xmlns:dc":wt.dc,"xmlns:dcterms":wt.dcterms,"xmlns:dcmitype":wt.dcmitype,"xmlns:xsi":wt.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&gu("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:A0(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&gu("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:A0(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Ei.length;++s){var a=Ei[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&gu(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ys=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Ig=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Rg(e){var t=[],r=se;return e||(e={}),e.Application="SheetJS",t[t.length]=pt,t[t.length]=se("Properties",null,{xmlns:wt.EXT_PROPS,"xmlns:vt":wt.vt}),ys.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=We(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+We(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function Lg(e){var t=[pt,se("Properties",null,{xmlns:wt.CUST_PROPS,"xmlns:vt":wt.vt})];if(!e)return t.join("");var r=1;return It(e).forEach(function(i){++r,t[t.length]=se("property",p4(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:We(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Cp={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function J4(e,t){var r=[];return It(Cp).map(function(n){for(var i=0;i<Ei.length;++i)if(Ei[i][1]==n)return Ei[i];for(i=0;i<ys.length;++i)if(ys[i][1]==n)return ys[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Ot(Cp[n[1]]||n[1],i))}}),se("DocumentProperties",r.join(""),{xmlns:mr.o})}function Q4(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&It(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var a=0;a<Ei.length;++a)if(s==Ei[a][1])return;for(a=0;a<ys.length;++a)if(s==ys[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(se(pp(s),o,{"dt:dt":l}))}}),t&&It(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(se(pp(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+mr.o+'">'+i.join("")+"</"+n+">"}function Z4(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=X(8);return a.write_shift(4,n),a.write_shift(4,i),a}function bp(e,t){var r=X(4),n=X(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=X(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=Z4(t);break;case 31:case 80:for(n=X(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Ft([r,n])}var Mg=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function ek(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Ap(e,t,r){var n=X(8),i=[],s=[],a=8,o=0,l=X(8),c=X(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),a+=8+l.length,!t){c=X(8),c.write_shift(4,0),i.unshift(c);var u=[X(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(l=X(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Ft(u),s.unshift(l),a+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Mg.indexOf(e[o][0])>-1||Ig.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],p=0;if(t){p=+t[e[o][0]];var v=r[p];if(v.p=="version"&&typeof h=="string"){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}l=bp(v.t,h)}else{var x=ek(h);x==-1&&(x=31,h=String(h)),l=bp(x,h)}s.push(l),c=X(8),c.write_shift(4,t?p:2+o),i.push(c),a+=8+l.length}var w=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,w),w+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Ft([n].concat(i).concat(s))}function Fp(e,t,r,n,i,s){var a=X(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Ge.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var l=Ap(e,r,n);if(o.push(l),i){var c=Ap(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(c)}return Ft(o)}function tk(e,t){t||(t=X(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function rk(e,t){return e.read_shift(t)===1}function Xt(e,t){return t||(t=X(2)),t.write_shift(2,+!!e),t}function Bg(e){return e.read_shift(2,"u")}function kr(e,t){return t||(t=X(2)),t.write_shift(2,e),t}function Ug(e,t,r){return r||(r=X(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function $g(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return a}function nk(e){var t=e.t||"",r=X(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=X(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Ft(i)}function ik(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function sk(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ik(e,n,r)}function ak(e,t,r){if(r.biff>5)return sk(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function zg(e,t,r){return r||(r=X(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Op(e,t){t||(t=X(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function ok(e){var t=X(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(s==28)n=n.slice(1),Op(n,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&Op(i>-1?n.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Oi(e,t,r,n){return n||(n=X(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function lk(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),a=e.read_shift(n,"i");return[i,s,a]}function ck(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function Wg(e,t){return t||(t=X(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Jf(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=X(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function uk(e,t){var r=!t||t.biff==8,n=X(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function fk(e,t){var r=!t||t.biff>=8?2:1,n=X(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function dk(e,t){var r=X(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=nk(e[i]);var s=Ft([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function hk(){var e=X(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function pk(e){var t=X(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function mk(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=X(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function xk(e,t,r,n){var i=X(10);return Oi(e,t,n,i),i.write_shift(4,r),i}function gk(e,t,r,n,i){var s=!i||i.biff==8,a=X(8+ +s+(1+s)*r.length);return Oi(e,t,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function vk(e,t,r,n){var i=r&&r.biff==5;n||(n=X(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function yk(e,t){var r=t.biff==8||!t.biff?4:2,n=X(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function jp(e,t,r,n){var i=r&&r.biff==5;n||(n=X(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function wk(e){var t=X(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function _k(e,t,r,n,i,s){var a=X(8);return Oi(e,t,n,a),Ug(r,s,a),a}function Sk(e,t,r,n){var i=X(14);return Oi(e,t,n,i),Fi(r,i),i}function Ek(e,t,r){if(r.biff<8)return Tk(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(lk(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function Tk(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=$g(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function kk(e){var t=X(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Wg(e[r],t);return t}function Nk(e){var t=X(24),r=_t(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Ft([t,ok(e[1])])}function Ck(e){var t=e[1].Tooltip,r=X(10+2*(t.length+1));r.write_shift(2,2048);var n=_t(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function bk(e){return e||(e=X(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Ak(e,t,r){if(!r.cellStyles)return nn(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),a=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Fk(e,t){var r=X(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Ok(e){for(var t=X(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function jk(e,t,r){var n=X(15);return ho(n,e,t),n.write_shift(8,r,"f"),n}function Pk(e,t,r){var n=X(9);return ho(n,e,t),n.write_shift(2,r),n}var Dk=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Uf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Ai(1);switch(l.type){case"base64":u=Hr(Tn(o));break;case"binary":u=Hr(o);break;case"buffer":case"array":u=o;break}pr(u,0);var d=u.read_shift(1),h=!!(d&136),p=!1,v=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var m=0,x=521;d==2&&(m=u.read_shift(2)),u.l+=3,d!=2&&(m=u.read_shift(4)),m>1048576&&(m=1e6),d!=2&&(x=u.read_shift(2));var w=u.read_shift(2),y=l.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=e[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var g=[],k={},j=Math.min(u.length,d==2?521:x-10-(p?264:0)),O=v?32:11;u.l<j&&u[u.l]!=13;)switch(k={},k.name=Ml.utils.decode(y,u.slice(u.l,u.l+O)).replace(/[\u0000\r\n].*$/g,""),u.l+=O,k.type=String.fromCharCode(u.read_shift(1)),d!=2&&!v&&(k.offset=u.read_shift(4)),k.len=u.read_shift(1),d==2&&(k.offset=u.read_shift(2)),k.dec=u.read_shift(1),k.name.length&&g.push(k),d!=2&&(u.l+=v?13:14),k.type){case"B":(!p||k.len!=8)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(u[u.l]!==13&&(u.l=x-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=x;var T=0,I=0;for(c[0]=[],I=0;I!=g.length;++I)c[0][I]=g[I].name;for(;m-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,c[++T]=[],I=0,I=0;I!=g.length;++I){var A=u.slice(u.l,u.l+g[I].len);u.l+=g[I].len,pr(A,0);var R=Ml.utils.decode(y,A);switch(g[I].type){case"C":R.trim().length&&(c[T][I]=R.replace(/\s+$/,""));break;case"D":R.length===8?c[T][I]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):c[T][I]=R;break;case"F":c[T][I]=parseFloat(R.trim());break;case"+":case"I":c[T][I]=v?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":c[T][I]=!0;break;case"N":case"F":c[T][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[T][I]="##MEMO##"+(v?parseInt(R.trim(),10):A.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(c[T][I]=+R||0);break;case"@":c[T][I]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":c[T][I]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":c[T][I]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[T][I]=-A.read_shift(-8,"f");break;case"B":if(p&&g[I].len==8){c[T][I]=A.read_shift(8,"f");break}case"G":case"P":A.l+=g[I].len;break;case"0":if(g[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+g[I].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=g,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Us(r(o,c),c);return u["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,u}function i(o,l){try{return Ii(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&Ga(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=lr(),d=Jl(o,{header:1,raw:!0,cellDates:!0}),h=d[0],p=d.slice(1),v=o["!cols"]||[],m=0,x=0,w=0,y=1;for(m=0;m<h.length;++m){if(((v[m]||{}).DBF||{}).name){h[m]=v[m].DBF.name,++w;continue}if(h[m]!=null){if(++w,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(x=0;x<1024;++x)if(h.indexOf(h[m]+"_"+x)==-1){h[m]+="_"+x;break}}}}var g=Qe(o["!ref"]),k=[],j=[],O=[];for(m=0;m<=g.e.c-g.s.c;++m){var T="",I="",A=0,R=[];for(x=0;x<p.length;++x)p[x][m]!=null&&R.push(p[x][m]);if(R.length==0||h[m]==null){k[m]="?";continue}for(x=0;x<R.length;++x){switch(typeof R[x]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=R[x]instanceof Date?"D":"C";break;default:I="C"}A=Math.max(A,String(R[x]).length),T=T&&T!=I?"C":I}A>250&&(A=250),I=((v[m]||{}).DBF||{}).type,I=="C"&&v[m].DBF.len>A&&(A=v[m].DBF.len),T=="B"&&I=="N"&&(T="N",O[m]=v[m].DBF.dec,A=v[m].DBF.len),j[m]=T=="C"||I=="N"?A:s[T]||0,y+=j[m],k[m]=T}var K=u.next(32);for(K.write_shift(4,318902576),K.write_shift(4,p.length),K.write_shift(2,296+32*w),K.write_shift(2,y),m=0;m<4;++m)K.write_shift(4,0);for(K.write_shift(4,0|(+t[Vx]||3)<<8),m=0,x=0;m<h.length;++m)if(h[m]!=null){var G=u.next(32),Q=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);G.write_shift(1,Q,"sbcs"),G.write_shift(1,k[m]=="?"?"C":k[m],"sbcs"),G.write_shift(4,x),G.write_shift(1,j[m]||s[k[m]]||0),G.write_shift(1,O[m]||0),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(1,0),G.write_shift(4,0),G.write_shift(4,0),x+=j[m]||s[k[m]]||0}var ye=u.next(264);for(ye.write_shift(4,13),m=0;m<65;++m)ye.write_shift(4,0);for(m=0;m<p.length;++m){var Ee=u.next(y);for(Ee.write_shift(1,0),x=0;x<h.length;++x)if(h[x]!=null)switch(k[x]){case"L":Ee.write_shift(1,p[m][x]==null?63:p[m][x]?84:70);break;case"B":Ee.write_shift(8,p[m][x]||0,"f");break;case"N":var re="0";for(typeof p[m][x]=="number"&&(re=p[m][x].toFixed(O[x]||0)),w=0;w<j[x]-re.length;++w)Ee.write_shift(1,32);Ee.write_shift(1,re,"sbcs");break;case"D":p[m][x]?(Ee.write_shift(4,("0000"+p[m][x].getFullYear()).slice(-4),"sbcs"),Ee.write_shift(2,("00"+(p[m][x].getMonth()+1)).slice(-2),"sbcs"),Ee.write_shift(2,("00"+p[m][x].getDate()).slice(-2),"sbcs")):Ee.write_shift(8,"00000000","sbcs");break;case"C":var Se=String(p[m][x]!=null?p[m][x]:"").slice(0,j[x]);for(Ee.write_shift(1,Se,"sbcs"),w=0;w<j[x]-Se.length;++w)Ee.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),Ik=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+It(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var v=e[p];return typeof v=="number"?rp(v):v},n=function(h,p,v){var m=p.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return m==59?h:rp(m)};e["|"]=254;function i(h,p){switch(p.type){case"base64":return s(Tn(h),p);case"binary":return s(h,p);case"buffer":return s(Be&&Buffer.isBuffer(h)?h.toString("binary"):oo(h),p);case"array":return s(Cc(h),p)}throw new Error("Unrecognized type "+p.type)}function s(h,p){var v=h.split(/[\n\r]+/),m=-1,x=-1,w=0,y=0,g=[],k=[],j=null,O={},T=[],I=[],A=[],R=0,K;for(+p.codepage>=0&&Ga(+p.codepage);w!==v.length;++w){R=0;var G=v[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Q=G.replace(/;;/g,"\0").split(";").map(function(P){return P.replace(/\u0000/g,";")}),ye=Q[0],Ee;if(G.length>0)switch(ye){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Q[1].charAt(0)=="P"&&k.push(G.slice(3).replace(/;;/g,";"));break;case"C":var re=!1,Se=!1,le=!1,xe=!1,we=-1,be=-1;for(y=1;y<Q.length;++y)switch(Q[y].charAt(0)){case"A":break;case"X":x=parseInt(Q[y].slice(1))-1,Se=!0;break;case"Y":for(m=parseInt(Q[y].slice(1))-1,Se||(x=0),K=g.length;K<=m;++K)g[K]=[];break;case"K":Ee=Q[y].slice(1),Ee.charAt(0)==='"'?Ee=Ee.slice(1,Ee.length-1):Ee==="TRUE"?Ee=!0:Ee==="FALSE"?Ee=!1:isNaN(gn(Ee))?isNaN(qa(Ee).getDate())||(Ee=Jt(Ee)):(Ee=gn(Ee),j!==null&&ng(j)&&(Ee=og(Ee))),re=!0;break;case"E":xe=!0;var F=P3(Q[y].slice(1),{r:m,c:x});g[m][x]=[g[m][x],F];break;case"S":le=!0,g[m][x]=[g[m][x],"S5S"];break;case"G":break;case"R":we=parseInt(Q[y].slice(1))-1;break;case"C":be=parseInt(Q[y].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+G)}if(re&&(g[m][x]&&g[m][x].length==2?g[m][x][0]=Ee:g[m][x]=Ee,j=null),le){if(xe)throw new Error("SYLK shared formula cannot have own formula");var U=we>-1&&g[we][be];if(!U||!U[1])throw new Error("SYLK shared formula cannot find base");g[m][x][1]=D3(U[1],{r:m-we,c:x-be})}break;case"F":var D=0;for(y=1;y<Q.length;++y)switch(Q[y].charAt(0)){case"X":x=parseInt(Q[y].slice(1))-1,++D;break;case"Y":for(m=parseInt(Q[y].slice(1))-1,K=g.length;K<=m;++K)g[K]=[];break;case"M":R=parseInt(Q[y].slice(1))/20;break;case"F":break;case"G":break;case"P":j=k[parseInt(Q[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=Q[y].slice(1).split(" "),K=parseInt(A[0],10);K<=parseInt(A[1],10);++K)R=parseInt(A[2],10),I[K-1]=R===0?{hidden:!0}:{wch:R},Qf(I[K-1]);break;case"C":x=parseInt(Q[y].slice(1))-1,I[x]||(I[x]={});break;case"R":m=parseInt(Q[y].slice(1))-1,T[m]||(T[m]={}),R>0?(T[m].hpt=R,T[m].hpx=qg(R)):R===0&&(T[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+G)}D<1&&(j=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+G)}}return T.length>0&&(O["!rows"]=T),I.length>0&&(O["!cols"]=I),p&&p.sheetRows&&(g=g.slice(0,p.sheetRows)),[g,O]}function a(h,p){var v=i(h,p),m=v[0],x=v[1],w=Us(m,p);return It(x).forEach(function(y){w[y]=x[y]}),w}function o(h,p){return Ii(a(h,p),p)}function l(h,p,v,m){var x="C;Y"+(v+1)+";X"+(m+1)+";K";switch(h.t){case"n":x+=h.v||0,h.f&&!h.F&&(x+=";E"+ed(h.f,{r:v,c:m}));break;case"b":x+=h.v?"TRUE":"FALSE";break;case"e":x+=h.w||h.v;break;case"d":x+='"'+(h.w||h.v)+'"';break;case"s":x+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function c(h,p){p.forEach(function(v,m){var x="F;W"+(m+1)+" "+(m+1)+" ";v.hidden?x+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Kl(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=ql(v.wpx)),typeof v.wch=="number"&&(x+=Math.round(v.wch))),x.charAt(x.length-1)!=" "&&h.push(x)})}function u(h,p){p.forEach(function(v,m){var x="F;";v.hidden?x+="M0;":v.hpt?x+="M"+20*v.hpt+";":v.hpx&&(x+="M"+20*Xl(v.hpx)+";"),x.length>2&&h.push(x+"R"+(m+1))})}function d(h,p){var v=["ID;PWXL;N;E"],m=[],x=Qe(h["!ref"]),w,y=Array.isArray(h),g=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),h["!cols"]&&c(v,h["!cols"]),h["!rows"]&&u(v,h["!rows"]),v.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var k=x.s.r;k<=x.e.r;++k)for(var j=x.s.c;j<=x.e.c;++j){var O=Ve({r:k,c:j});w=y?(h[k]||[])[j]:h[O],!(!w||w.v==null&&(!w.f||w.F))&&m.push(l(w,h,k,j))}return v.join(g)+g+m.join(g)+g+"E"+g}return{to_workbook:o,to_sheet:a,from_sheet:d}}(),Rk=function(){function e(s,a){switch(a.type){case"base64":return t(Tn(s),a);case"binary":return t(s,a);case"buffer":return t(Be&&Buffer.isBuffer(s)?s.toString("binary"):oo(s),a);case"array":return t(Cc(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,c=-1,u=0,d=[];u!==o.length;++u){if(o[u].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var h=o[u].trim().split(","),p=h[0],v=h[1];++u;for(var m=o[u]||"";(m.match(/["]/g)||[]).length&1&&u<o.length-1;)m+=`
`+o[++u];switch(m=m.trim(),+p){case-1:if(m==="BOT"){d[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[l][c]=!0:m==="FALSE"?d[l][c]=!1:isNaN(gn(v))?isNaN(qa(v).getDate())?d[l][c]=v:d[l][c]=Jt(v):d[l][c]=gn(v),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(d=d.slice(0,a.sheetRows)),d}function r(s,a){return Us(e(s,a),a)}function n(s,a){return Ii(r(s,a),a)}var i=function(){var s=function(l,c,u,d,h){l.push(c),l.push(u+","+d),l.push('"'+h.replace(/"/g,'""')+'"')},a=function(l,c,u,d){l.push(c+","+u),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],u=Qe(l["!ref"]),d,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){a(c,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var m=Ve({r:p,c:v});if(d=h?(l[p]||[])[v]:l[m],!d){a(c,1,0,"");continue}switch(d.t){case"n":var x=d.w;!x&&d.v!=null&&(x=d.v),x==null?d.f&&!d.F?a(c,1,0,"="+d.f):a(c,1,0,""):a(c,0,x,"V");break;case"b":a(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Zn(d.z||lt[14],cr(Jt(d.v)))),a(c,0,d.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var w=`\r
`,y=c.join(w);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),Hg=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var p=d.split(`
`),v=-1,m=-1,x=0,w=[];x!==p.length;++x){var y=p[x].trim().split(":");if(y[0]==="cell"){var g=_t(y[1]);if(w.length<=g.r)for(v=w.length;v<=g.r;++v)w[v]||(w[v]=[]);switch(v=g.r,m=g.c,y[2]){case"t":w[v][m]=e(y[3]);break;case"v":w[v][m]=+y[3];break;case"vtf":var k=y[y.length-1];case"vtc":switch(y[3]){case"nl":w[v][m]=!!+y[4];break;default:w[v][m]=+y[4];break}y[2]=="vtf"&&(w[v][m]=[w[v][m],k])}}}return h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),w}function n(d,h){return Us(r(d,h),h)}function i(d,h){return Ii(n(d,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],p=[],v,m="",x=wr(d["!ref"]),w=Array.isArray(d),y=x.s.r;y<=x.e.r;++y)for(var g=x.s.c;g<=x.e.c;++g)if(m=Ve({r:y,c:g}),v=w?(d[y]||[])[g]:d[m],!(!v||v.v==null||v.t==="z")){switch(p=["cell",m,"t"],v.t){case"s":case"str":p.push(t(v.v));break;case"n":v.f?(p[2]="vtf",p[3]="n",p[4]=v.v,p[5]=t(v.f)):(p[2]="v",p[3]=v.v);break;case"b":p[2]="vt"+(v.f?"f":"c"),p[3]="nl",p[4]=v.v?"1":"0",p[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var k=cr(Jt(v.v));p[2]="vtc",p[3]="nd",p[4]=""+k,p[5]=v.w||Zn(v.z||lt[14],k);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(d){return[s,a,o,a,c(d),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),Lk=function(){function e(u,d,h,p,v){v.raw?d[h][p]=u:u===""||(u==="TRUE"?d[h][p]=!0:u==="FALSE"?d[h][p]=!1:isNaN(gn(u))?isNaN(qa(u).getDate())?d[h][p]=u:d[h][p]=Jt(u):d[h][p]=gn(u))}function t(u,d){var h=d||{},p=[];if(!u||u.length===0)return p;for(var v=u.split(/[\r\n]/),m=v.length-1;m>=0&&v[m].length===0;)--m;for(var x=10,w=0,y=0;y<=m;++y)w=v[y].indexOf(" "),w==-1?w=v[y].length:w++,x=Math.max(x,w);for(y=0;y<=m;++y){p[y]=[];var g=0;for(e(v[y].slice(0,x).trim(),p,y,g,h),g=1;g<=(v[y].length-x)/10+1;++g)e(v[y].slice(x+(g-1)*10,x+g*10).trim(),p,y,g,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var d={},h=!1,p=0,v=0;p<u.length;++p)(v=u.charCodeAt(p))==34?h=!h:!h&&v in r&&(d[v]=(d[v]||0)+1);v=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&v.push([d[p],p]);if(!v.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&v.push([d[p],p])}return v.sort(function(m,x){return m[0]-x[0]||n[m[1]]-n[x[1]]}),r[v.pop()[1]]||44}function s(u,d){var h=d||{},p="",v=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=i(u.slice(0,1024)):h&&h.FS?p=h.FS:p=i(u.slice(0,1024));var x=0,w=0,y=0,g=0,k=0,j=p.charCodeAt(0),O=!1,T=0,I=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var A=h.dateNF!=null?ZT(h.dateNF):null;function R(){var K=u.slice(g,k),G={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)G.t="z";else if(h.raw)G.t="s",G.v=K;else if(K.trim().length===0)G.t="s",G.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(G.t="s",G.v=K.slice(2,-1).replace(/""/g,'"')):I3(K)?(G.t="n",G.f=K.slice(1)):(G.t="s",G.v=K);else if(K=="TRUE")G.t="b",G.v=!0;else if(K=="FALSE")G.t="b",G.v=!1;else if(!isNaN(y=gn(K)))G.t="n",h.cellText!==!1&&(G.w=K),G.v=y;else if(!isNaN(qa(K).getDate())||A&&K.match(A)){G.z=h.dateNF||lt[14];var Q=0;A&&K.match(A)&&(K=e4(K,h.dateNF,K.match(A)||[]),Q=1),h.cellDates?(G.t="d",G.v=Jt(K,Q)):(G.t="n",G.v=cr(Jt(K,Q))),h.cellText!==!1&&(G.w=Zn(G.z,G.v instanceof Date?cr(G.v):G.v)),h.cellNF||delete G.z}else G.t="s",G.v=K;if(G.t=="z"||(h.dense?(v[x]||(v[x]=[]),v[x][w]=G):v[Ve({c:w,r:x})]=G),g=k+1,I=u.charCodeAt(g),m.e.c<w&&(m.e.c=w),m.e.r<x&&(m.e.r=x),T==j)++w;else if(w=0,++x,h.sheetRows&&h.sheetRows<=x)return!0}e:for(;k<u.length;++k)switch(T=u.charCodeAt(k)){case 34:I===34&&(O=!O);break;case j:case 10:case 13:if(!O&&R())break e;break}return k-g>0&&R(),v["!ref"]=ht(m),v}function a(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,d):Us(t(u,d),d)}function o(u,d){var h="",p=d.type=="string"?[0,0,0,0]:XA(u,d);switch(d.type){case"base64":h=Tn(u);break;case"binary":h=u;break;case"buffer":d.codepage==65001?h=u.toString("utf8"):d.codepage&&typeof Ml<"u"||(h=Be&&Buffer.isBuffer(u)?u.toString("binary"):oo(u));break;case"array":h=Cc(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=_a(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=_a(h):d.type=="binary"&&typeof Ml<"u",h.slice(0,19)=="socialcalc:version:"?Hg.to_sheet(d.type=="string"?h:_a(h),d):a(h,d)}function l(u,d){return Ii(o(u,d),d)}function c(u){for(var d=[],h=Qe(u["!ref"]),p,v=Array.isArray(u),m=h.s.r;m<=h.e.r;++m){for(var x=[],w=h.s.c;w<=h.e.c;++w){var y=Ve({r:m,c:w});if(p=v?(u[m]||[])[w]:u[y],!p||p.v==null){x.push("          ");continue}for(var g=(p.w||(kn(p),p.w)||"").slice(0,10);g.length<10;)g+=" ";x.push(g+(w===0?" ":""))}d.push(x.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}(),Pp=function(){function e(F,U,D){if(F){pr(F,F.l||0);for(var P=D.Enum||we;F.l<F.length;){var J=F.read_shift(2),pe=P[J]||P[65535],ve=F.read_shift(2),ge=F.l+ve,ue=pe.f&&pe.f(F,ve,D);if(F.l=ge,U(ue,pe,J))return}}}function t(F,U){switch(U.type){case"base64":return r(Hr(Tn(F)),U);case"binary":return r(Hr(F),U);case"buffer":case"array":return r(F,U)}throw"Unsupported type "+U.type}function r(F,U){if(!F)return F;var D=U||{},P=D.dense?[]:{},J="Sheet1",pe="",ve=0,ge={},ue=[],De=[],Oe={s:{r:0,c:0},e:{r:0,c:0}},Tt=D.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)D.Enum=we,e(F,function(de,Wt,Dr){switch(Dr){case 0:D.vers=de,de>=4096&&(D.qpro=!0);break;case 6:Oe=de;break;case 204:de&&(pe=de);break;case 222:pe=de;break;case 15:case 51:D.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:Dr==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=D.dateNF||lt[14],D.cellDates&&(de[1].t="d",de[1].v=og(de[1].v))),D.qpro&&de[3]>ve&&(P["!ref"]=ht(Oe),ge[J]=P,ue.push(J),P=D.dense?[]:{},Oe={s:{r:0,c:0},e:{r:0,c:0}},ve=de[3],J=pe||"Sheet"+(ve+1),pe="");var sn=D.dense?(P[de[0].r]||[])[de[0].c]:P[Ve(de[0])];if(sn){sn.t=de[1].t,sn.v=de[1].v,de[1].z!=null&&(sn.z=de[1].z),de[1].f!=null&&(sn.f=de[1].f);break}D.dense?(P[de[0].r]||(P[de[0].r]=[]),P[de[0].r][de[0].c]=de[1]):P[Ve(de[0])]=de[1];break}},D);else if(F[2]==26||F[2]==14)D.Enum=be,F[2]==14&&(D.qpro=!0,F.l=0),e(F,function(de,Wt,Dr){switch(Dr){case 204:J=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>ve&&(P["!ref"]=ht(Oe),ge[J]=P,ue.push(J),P=D.dense?[]:{},Oe={s:{r:0,c:0},e:{r:0,c:0}},ve=de[3],J="Sheet"+(ve+1)),Tt>0&&de[0].r>=Tt)break;D.dense?(P[de[0].r]||(P[de[0].r]=[]),P[de[0].r][de[0].c]=de[1]):P[Ve(de[0])]=de[1],Oe.e.c<de[0].c&&(Oe.e.c=de[0].c),Oe.e.r<de[0].r&&(Oe.e.r=de[0].r);break;case 27:de[14e3]&&(De[de[14e3][0]]=de[14e3][1]);break;case 1537:De[de[0]]=de[1],de[0]==ve&&(J=de[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(P["!ref"]=ht(Oe),ge[pe||J]=P,ue.push(pe||J),!De.length)return{SheetNames:ue,Sheets:ge};for(var Ie={},Pr=[],Ze=0;Ze<De.length;++Ze)ge[ue[Ze]]?(Pr.push(De[Ze]||ue[Ze]),Ie[De[Ze]]=ge[De[Ze]]||ge[ue[Ze]]):(Pr.push(De[Ze]),Ie[De[Ze]]={"!ref":"A1"});return{SheetNames:Pr,Sheets:Ie}}function n(F,U){var D=U||{};if(+D.codepage>=0&&Ga(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var P=lr(),J=Qe(F["!ref"]),pe=Array.isArray(F),ve=[];ae(P,0,s(1030)),ae(P,6,l(J));for(var ge=Math.min(J.e.r,8191),ue=J.s.r;ue<=ge;++ue)for(var De=Pt(ue),Oe=J.s.c;Oe<=J.e.c;++Oe){ue===J.s.r&&(ve[Oe]=Ut(Oe));var Tt=ve[Oe]+De,Ie=pe?(F[ue]||[])[Oe]:F[Tt];if(!(!Ie||Ie.t=="z"))if(Ie.t=="n")(Ie.v|0)==Ie.v&&Ie.v>=-32768&&Ie.v<=32767?ae(P,13,p(ue,Oe,Ie.v)):ae(P,14,m(ue,Oe,Ie.v));else{var Pr=kn(Ie);ae(P,15,d(ue,Oe,Pr.slice(0,239)))}}return ae(P,1),P.end()}function i(F,U){var D=U||{};if(+D.codepage>=0&&Ga(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var P=lr();ae(P,0,a(F));for(var J=0,pe=0;J<F.SheetNames.length;++J)(F.Sheets[F.SheetNames[J]]||{})["!ref"]&&ae(P,27,xe(F.SheetNames[J],pe++));var ve=0;for(J=0;J<F.SheetNames.length;++J){var ge=F.Sheets[F.SheetNames[J]];if(!(!ge||!ge["!ref"])){for(var ue=Qe(ge["!ref"]),De=Array.isArray(ge),Oe=[],Tt=Math.min(ue.e.r,8191),Ie=ue.s.r;Ie<=Tt;++Ie)for(var Pr=Pt(Ie),Ze=ue.s.c;Ze<=ue.e.c;++Ze){Ie===ue.s.r&&(Oe[Ze]=Ut(Ze));var de=Oe[Ze]+Pr,Wt=De?(ge[Ie]||[])[Ze]:ge[de];if(!(!Wt||Wt.t=="z"))if(Wt.t=="n")ae(P,23,R(Ie,Ze,ve,Wt.v));else{var Dr=kn(Wt);ae(P,22,T(Ie,Ze,ve,Dr.slice(0,239)))}}++ve}}return ae(P,1),P.end()}function s(F){var U=X(2);return U.write_shift(2,F),U}function a(F){var U=X(26);U.write_shift(2,4096),U.write_shift(2,4),U.write_shift(4,0);for(var D=0,P=0,J=0,pe=0;pe<F.SheetNames.length;++pe){var ve=F.SheetNames[pe],ge=F.Sheets[ve];if(!(!ge||!ge["!ref"])){++J;var ue=wr(ge["!ref"]);D<ue.e.r&&(D=ue.e.r),P<ue.e.c&&(P=ue.e.c)}}return D>8191&&(D=8191),U.write_shift(2,D),U.write_shift(1,J),U.write_shift(1,P),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(1,1),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(4,0),U}function o(F,U,D){var P={s:{c:0,r:0},e:{c:0,r:0}};return U==8&&D.qpro?(P.s.c=F.read_shift(1),F.l++,P.s.r=F.read_shift(2),P.e.c=F.read_shift(1),F.l++,P.e.r=F.read_shift(2),P):(P.s.c=F.read_shift(2),P.s.r=F.read_shift(2),U==12&&D.qpro&&(F.l+=2),P.e.c=F.read_shift(2),P.e.r=F.read_shift(2),U==12&&D.qpro&&(F.l+=2),P.s.c==65535&&(P.s.c=P.e.c=P.s.r=P.e.r=0),P)}function l(F){var U=X(8);return U.write_shift(2,F.s.c),U.write_shift(2,F.s.r),U.write_shift(2,F.e.c),U.write_shift(2,F.e.r),U}function c(F,U,D){var P=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(P[0].c=F.read_shift(1),P[3]=F.read_shift(1),P[0].r=F.read_shift(2),F.l+=2):(P[2]=F.read_shift(1),P[0].c=F.read_shift(2),P[0].r=F.read_shift(2)),P}function u(F,U,D){var P=F.l+U,J=c(F,U,D);if(J[1].t="s",D.vers==20768){F.l++;var pe=F.read_shift(1);return J[1].v=F.read_shift(pe,"utf8"),J}return D.qpro&&F.l++,J[1].v=F.read_shift(P-F.l,"cstr"),J}function d(F,U,D){var P=X(7+D.length);P.write_shift(1,255),P.write_shift(2,U),P.write_shift(2,F),P.write_shift(1,39);for(var J=0;J<P.length;++J){var pe=D.charCodeAt(J);P.write_shift(1,pe>=128?95:pe)}return P.write_shift(1,0),P}function h(F,U,D){var P=c(F,U,D);return P[1].v=F.read_shift(2,"i"),P}function p(F,U,D){var P=X(7);return P.write_shift(1,255),P.write_shift(2,U),P.write_shift(2,F),P.write_shift(2,D,"i"),P}function v(F,U,D){var P=c(F,U,D);return P[1].v=F.read_shift(8,"f"),P}function m(F,U,D){var P=X(13);return P.write_shift(1,255),P.write_shift(2,U),P.write_shift(2,F),P.write_shift(8,D,"f"),P}function x(F,U,D){var P=F.l+U,J=c(F,U,D);if(J[1].v=F.read_shift(8,"f"),D.qpro)F.l=P;else{var pe=F.read_shift(2);k(F.slice(F.l,F.l+pe),J),F.l+=pe}return J}function w(F,U,D){var P=U&32768;return U&=-32769,U=(P?F:0)+(U>=8192?U-16384:U),(P?"":"$")+(D?Ut(U):Pt(U))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},g=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(F,U){pr(F,0);for(var D=[],P=0,J="",pe="",ve="",ge="";F.l<F.length;){var ue=F[F.l++];switch(ue){case 0:D.push(F.read_shift(8,"f"));break;case 1:pe=w(U[0].c,F.read_shift(2),!0),J=w(U[0].r,F.read_shift(2),!1),D.push(pe+J);break;case 2:{var De=w(U[0].c,F.read_shift(2),!0),Oe=w(U[0].r,F.read_shift(2),!1);pe=w(U[0].c,F.read_shift(2),!0),J=w(U[0].r,F.read_shift(2),!1),D.push(De+Oe+":"+pe+J)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(F.read_shift(2));break;case 6:{for(var Tt="";ue=F[F.l++];)Tt+=String.fromCharCode(ue);D.push('"'+Tt.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:ge=D.pop(),ve=D.pop(),D.push(["AND","OR"][ue-20]+"("+ve+","+ge+")");break;default:if(ue<32&&g[ue])ge=D.pop(),ve=D.pop(),D.push(ve+g[ue]+ge);else if(y[ue]){if(P=y[ue][1],P==69&&(P=F[F.l++]),P>D.length){console.error("WK1 bad formula parse 0x"+ue.toString(16)+":|"+D.join("|")+"|");return}var Ie=D.slice(-P);D.length-=P,D.push(y[ue][0]+"("+Ie.join(",")+")")}else return ue<=7?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=24?console.error("WK1 unsupported op "+ue.toString(16)):ue<=30?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=115?console.error("WK1 unsupported function opcode "+ue.toString(16)):console.error("WK1 unrecognized opcode "+ue.toString(16))}}D.length==1?U[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function j(F){var U=[{c:0,r:0},{t:"n",v:0},0];return U[0].r=F.read_shift(2),U[3]=F[F.l++],U[0].c=F[F.l++],U}function O(F,U){var D=j(F);return D[1].t="s",D[1].v=F.read_shift(U-4,"cstr"),D}function T(F,U,D,P){var J=X(6+P.length);J.write_shift(2,F),J.write_shift(1,D),J.write_shift(1,U),J.write_shift(1,39);for(var pe=0;pe<P.length;++pe){var ve=P.charCodeAt(pe);J.write_shift(1,ve>=128?95:ve)}return J.write_shift(1,0),J}function I(F,U){var D=j(F);D[1].v=F.read_shift(2);var P=D[1].v>>1;if(D[1].v&1)switch(P&7){case 0:P=(P>>3)*5e3;break;case 1:P=(P>>3)*500;break;case 2:P=(P>>3)/20;break;case 3:P=(P>>3)/200;break;case 4:P=(P>>3)/2e3;break;case 5:P=(P>>3)/2e4;break;case 6:P=(P>>3)/16;break;case 7:P=(P>>3)/64;break}return D[1].v=P,D}function A(F,U){var D=j(F),P=F.read_shift(4),J=F.read_shift(4),pe=F.read_shift(2);if(pe==65535)return P===0&&J===3221225472?(D[1].t="e",D[1].v=15):P===0&&J===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var ve=pe&32768;return pe=(pe&32767)-16446,D[1].v=(1-ve*2)*(J*Math.pow(2,pe+32)+P*Math.pow(2,pe)),D}function R(F,U,D,P){var J=X(14);if(J.write_shift(2,F),J.write_shift(1,D),J.write_shift(1,U),P==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var pe=0,ve=0,ge=0,ue=0;return P<0&&(pe=1,P=-P),ve=Math.log2(P)|0,P/=Math.pow(2,ve-31),ue=P>>>0,ue&2147483648||(P/=2,++ve,ue=P>>>0),P-=ue,ue|=2147483648,ue>>>=0,P*=Math.pow(2,32),ge=P>>>0,J.write_shift(4,ge),J.write_shift(4,ue),ve+=16383+(pe?32768:0),J.write_shift(2,ve),J}function K(F,U){var D=A(F);return F.l+=U-14,D}function G(F,U){var D=j(F),P=F.read_shift(4);return D[1].v=P>>6,D}function Q(F,U){var D=j(F),P=F.read_shift(8,"f");return D[1].v=P,D}function ye(F,U){var D=Q(F);return F.l+=U-10,D}function Ee(F,U){return F[F.l+U-1]==0?F.read_shift(U,"cstr"):""}function re(F,U){var D=F[F.l++];D>U-1&&(D=U-1);for(var P="";P.length<D;)P+=String.fromCharCode(F[F.l++]);return P}function Se(F,U,D){if(!(!D.qpro||U<21)){var P=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var J=F.read_shift(U-21,"cstr");return[P,J]}}function le(F,U){for(var D={},P=F.l+U;F.l<P;){var J=F.read_shift(2);if(J==14e3){for(D[J]=[0,""],D[J][0]=F.read_shift(2);F[F.l];)D[J][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return D}function xe(F,U){var D=X(5+F.length);D.write_shift(2,14e3),D.write_shift(2,U);for(var P=0;P<F.length;++P){var J=F.charCodeAt(P);D[D.l++]=J>127?95:J}return D[D.l++]=0,D}var we={0:{n:"BOF",f:Bg},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ee},222:{n:"SHEETNAMELP",f:re},65535:{n:""}},be={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:G},38:{n:"??"},39:{n:"NUMBER27",f:Q},40:{n:"FORMULA28",f:ye},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}(),Mk=/^\s|\s$|[\t\n\r]/;function Vg(e,t){if(!t.bookSST)return"";var r=[pt];r[r.length]=se("sst",null,{xmlns:Bs[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(Mk)&&(s+=' xml:space="preserve"'),s+=">"+We(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Bk(e){return[e.read_shift(4),e.read_shift(4)]}function Uk(e,t){return t||(t=X(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var $k=O4;function zk(e){var t=lr();Z(t,159,Uk(e));for(var r=0;r<e.length;++r)Z(t,19,$k(e[r]));return Z(t,160),t.end()}function Wk(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Gg(e){var t=0,r,n=Wk(e),i=n.length+1,s,a,o,l,c;for(r=Ai(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^a;return t^52811}var Hk=function(){function e(i,s){switch(s.type){case"base64":return t(Tn(i),s);case"binary":return t(i,s);case"buffer":return t(Be&&Buffer.isBuffer(i)?i.toString("binary"):oo(i),s);case"array":return t(Cc(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,p=0,v,m=-1;v=h.exec(u);){switch(v[0]){case"\\cell":var x=u.slice(p,h.lastIndex-v[0].length);if(x[0]==" "&&(x=x.slice(1)),++m,x.length){var w={v:x,t:"s"};Array.isArray(o)?o[d][m]=w:o[Ve({r:d,c:m})]=w}break}p=h.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=ht(c),o}function r(i,s){return Ii(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=Qe(i["!ref"]),o,l=Array.isArray(i),c=a.s.r;c<=a.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var d=Ve({r:c,c:u});o=l?(i[c]||[])[u]:i[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(kn(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Dp(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Vk=6,vn=Vk;function Kl(e){return Math.floor((e+Math.round(128/vn)/256)*vn)}function ql(e){return Math.floor((e-5)/vn*100+.5)/100}function O0(e){return Math.round((e*vn+5)/vn*256)/256}function Qf(e){e.width?(e.wpx=Kl(e.width),e.wch=ql(e.wpx),e.MDW=vn):e.wpx?(e.wch=ql(e.wpx),e.width=O0(e.wch),e.MDW=vn):typeof e.wch=="number"&&(e.width=O0(e.wch),e.wpx=Kl(e.width),e.MDW=vn),e.customWidth&&delete e.customWidth}var Gk=96,Kg=Gk;function Xl(e){return e*96/Kg}function qg(e){return e*Kg/96}function Kk(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=se("numFmt",null,{numFmtId:n,formatCode:We(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=se("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function qk(e){var t=[];return t[t.length]=se("cellXfs",null),e.forEach(function(r){t[t.length]=se("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=se("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Xg(e,t){var r=[pt,se("styleSheet",null,{xmlns:Bs[0],"xmlns:vt":wt.vt})],n;return e.SSF&&(n=Kk(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=qk(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Xk(e,t){var r=e.read_shift(2),n=$t(e);return[r,n]}function Yk(e,t,r){r||(r=X(6+4*t.length)),r.write_shift(2,e),St(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Jk(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=M4(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(n.underline=a);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=L4(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=$t(e),n}function Qk(e,t){t||(t=X(25+4*32)),t.write_shift(2,e.sz*20),B4(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Vl(e.color,t);var n=0;return n=2,t.write_shift(1,n),St(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Zk=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],vu,e3=nn;function Ip(e,t){t||(t=X(4*3+8*7+16*1)),vu||(vu=Uf(Zk));var r=vu[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Vl({auto:1},t),Vl({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function t3(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function Yg(e,t,r){r||(r=X(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ta(e,t){return t||(t=X(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var r3=nn;function n3(e,t){return t||(t=X(51)),t.write_shift(1,0),ta(null,t),ta(null,t),ta(null,t),ta(null,t),ta(null,t),t.length>t.l?t.slice(0,t.l):t}function i3(e,t){return t||(t=X(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Hl(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function s3(e,t,r){var n=X(2052);return n.write_shift(4,e),Hl(t,n),Hl(r,n),n.length>n.l?n.slice(0,n.l):n}function a3(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(Z(e,615,qr(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Z(e,44,Yk(i,t[i]))}),Z(e,616))}}function o3(e){var t=1;Z(e,611,qr(t)),Z(e,43,Qk({sz:12,color:{theme:1},name:"Calibri",family:2})),Z(e,612)}function l3(e){var t=2;Z(e,603,qr(t)),Z(e,45,Ip({patternType:"none"})),Z(e,45,Ip({patternType:"gray125"})),Z(e,604)}function c3(e){var t=1;Z(e,613,qr(t)),Z(e,46,n3()),Z(e,614)}function u3(e){var t=1;Z(e,626,qr(t)),Z(e,47,Yg({numFmtId:0},65535)),Z(e,627)}function f3(e,t){Z(e,617,qr(t.length)),t.forEach(function(r){Z(e,47,Yg(r,0))}),Z(e,618)}function d3(e){var t=1;Z(e,619,qr(t)),Z(e,48,i3({xfId:0,name:"Normal"})),Z(e,620)}function h3(e){var t=0;Z(e,505,qr(t)),Z(e,506)}function p3(e){var t=0;Z(e,508,s3(t,"TableStyleMedium9","PivotStyleMedium4")),Z(e,509)}function m3(e,t){var r=lr();return Z(r,278),a3(r,e.SSF),o3(r),l3(r),c3(r),u3(r),f3(r,t.cellXfs),d3(r),h3(r),p3(r),Z(r,279),r.end()}function Jg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[pt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function x3(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:$t(e)}}function g3(e){var t=X(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),St(e.name,t),t.slice(0,t.l)}function v3(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function y3(e){var t=X(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function w3(e,t){var r=X(8+2*t.length);return r.write_shift(4,e),St(t,r),r.slice(0,r.l)}function _3(e){return e.l+=4,e.read_shift(4)!=0}function S3(e,t){var r=X(8);return r.write_shift(4,e),r.write_shift(4,1),r}function E3(){var e=lr();return Z(e,332),Z(e,334,qr(1)),Z(e,335,g3({name:"XLDAPR",version:12e4,flags:3496657072})),Z(e,336),Z(e,339,w3(1,"XLDAPR")),Z(e,52),Z(e,35,qr(514)),Z(e,4096,qr(0)),Z(e,4097,kr(1)),Z(e,36),Z(e,53),Z(e,340),Z(e,337,S3(1)),Z(e,51,y3([[1,0]])),Z(e,338),Z(e,333),e.end()}function Qg(){var e=[pt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function T3(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ve(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var cs=1024;function Zg(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[se("xml",null,{"xmlns:v":mr.v,"xmlns:o":mr.o,"xmlns:x":mr.x,"xmlns:mv":mr.mv}).replace(/\/>/,">"),se("o:shapelayout",se("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),se("v:shapetype",[se("v:stroke",null,{joinstyle:"miter"}),se("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];cs<e*1e3;)cs+=1e3;return t.forEach(function(s){var a=_t(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?se("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=se("v:fill",l,o),u={on:"t",obscured:"t"};++cs,i=i.concat(["<v:shape"+Ya({id:"_x0000_s"+cs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,se("v:shadow",null,u),se("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ot("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Ot("x:AutoFill","False"),Ot("x:Row",String(a.r)),Ot("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function ev(e){var t=[pt,se("comments",null,{xmlns:Bs[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=We(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(We(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(Ot("t",We(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(Ot("t",We(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function k3(e,t,r){var n=[pt,se("ThreadedComments",null,{xmlns:wt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),n.push(se("threadedComment",Ot("text",a.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function N3(e){var t=[pt,se("personList",null,{xmlns:wt.TCMNT,"xmlns:x":Bs[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(se("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function C3(e){var t={};t.iauthor=e.read_shift(4);var r=Bi(e);return t.rfx=r.s,t.ref=Ve(r.s),e.l+=16,t}function b3(e,t){return t==null&&(t=X(36)),t.write_shift(4,e[1].iauthor),$s(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var A3=$t;function F3(e){return St(e.slice(0,54))}function O3(e){var t=lr(),r=[];return Z(t,628),Z(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Z(t,632,F3(i.a)))})}),Z(t,631),Z(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:_t(n[0]),e:_t(n[0])};Z(t,635,b3([s,i])),i.t&&i.t.length>0&&Z(t,637,P4(i)),Z(t,636),delete i.iauthor})}),Z(t,634),Z(t,629),t.end()}function j3(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ge.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var tv=["xlsb","xlsm","xlam","biff8","xla"],P3=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,i+(o?"":"$")+Ut(u)+(l?"":"$")+Pt(c)}return function(i,s){return t=s,i.replace(e,r)}}(),Zf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ed=function(){return function(t,r){return t.replace(Zf,function(n,i,s,a,o,l){var c=Kf(a)-(s?0:r.c),u=Gf(l)-(o?0:r.r),d=u==0?"":o?u+1:"["+u+"]",h=c==0?"":s?c+1:"["+c+"]";return i+"R"+d+"C"+h})}}();function D3(e,t){return e.replace(Zf,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Ut(Kf(s)+t.c))+(a=="$"?a+o:Pt(Gf(o)+t.r))})}function I3(e){return e.length!=1}function ft(e){e.l+=1}function ei(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function rv(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return nv(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),a=ei(e),o=ei(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function nv(e){var t=ei(e),r=ei(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function R3(e,t,r){if(r.biff<8)return nv(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=ei(e),a=ei(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function iv(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return L3(e);var n=e.read_shift(r&&r.biff==12?4:2),i=ei(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function L3(e){var t=ei(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function M3(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function B3(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return U3(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function U3(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function $3(e,t,r){var n=(e[e.l++]&96)>>5,i=rv(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function z3(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=rv(e,s,r);return[n,i,a]}function W3(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function H3(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function V3(e,t,r){var n=(e[e.l++]&96)>>5,i=R3(e,t-1,r);return[n,i]}function G3(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Rp(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function K3(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function q3(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function X3(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Y3(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function J3(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function sv(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Q3(e){return e.read_shift(2),sv(e)}function Z3(e){return e.read_shift(2),sv(e)}function eN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=iv(e,0,r);return[n,i]}function tN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=B3(e,0,r);return[n,i]}function rN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=iv(e,0,r);return[n,i,s]}function nN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[nC[i],lv[i],n]}function iN(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:sN(e);return[i,(s[0]===0?lv:rC)[s[1]]]}function sN(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function aN(e,t,r){e.l+=r&&r.biff==2?3:4}function oN(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function lN(e){return e.l++,uo[e.read_shift(1)]}function cN(e){return e.l++,e.read_shift(2)}function uN(e){return e.l++,e.read_shift(1)!==0}function fN(e){return e.l++,zs(e)}function dN(e,t,r){return e.l++,$g(e,t-1,r)}function hN(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=rk(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=uo[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=zs(e);break;case 2:r[1]=ak(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function pN(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Bi:ck)(e));return i}function mN(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=hN(e,r.biff);return a}function xN(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function gN(e,t,r){if(r.biff==5)return vN(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function vN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function yN(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function wN(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function _N(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function SN(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var EN=nn,TN=nn,kN=nn;function fo(e,t,r){return e.l+=2,[M3(e)]}function td(e){return e.l+=6,[]}var NN=fo,CN=td,bN=td,AN=fo;function av(e){return e.l+=2,[Bg(e),e.read_shift(2)&1]}var FN=fo,ON=av,jN=td,PN=fo,DN=fo,IN=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function RN(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=IN[r>>2&31];return{ixti:t,coltype:r&3,rt:a,idx:n,c:i,C:s}}function LN(e){return e.l+=2,[e.read_shift(4)]}function MN(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function BN(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function UN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function $N(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function zN(e){return e.l+=4,[0,0]}var Lp={1:{n:"PtgExp",f:oN},2:{n:"PtgTbl",f:kN},3:{n:"PtgAdd",f:ft},4:{n:"PtgSub",f:ft},5:{n:"PtgMul",f:ft},6:{n:"PtgDiv",f:ft},7:{n:"PtgPower",f:ft},8:{n:"PtgConcat",f:ft},9:{n:"PtgLt",f:ft},10:{n:"PtgLe",f:ft},11:{n:"PtgEq",f:ft},12:{n:"PtgGe",f:ft},13:{n:"PtgGt",f:ft},14:{n:"PtgNe",f:ft},15:{n:"PtgIsect",f:ft},16:{n:"PtgUnion",f:ft},17:{n:"PtgRange",f:ft},18:{n:"PtgUplus",f:ft},19:{n:"PtgUminus",f:ft},20:{n:"PtgPercent",f:ft},21:{n:"PtgParen",f:ft},22:{n:"PtgMissArg",f:ft},23:{n:"PtgStr",f:dN},26:{n:"PtgSheet",f:MN},27:{n:"PtgEndSheet",f:BN},28:{n:"PtgErr",f:lN},29:{n:"PtgBool",f:uN},30:{n:"PtgInt",f:cN},31:{n:"PtgNum",f:fN},32:{n:"PtgArray",f:G3},33:{n:"PtgFunc",f:nN},34:{n:"PtgFuncVar",f:iN},35:{n:"PtgName",f:xN},36:{n:"PtgRef",f:eN},37:{n:"PtgArea",f:$3},38:{n:"PtgMemArea",f:yN},39:{n:"PtgMemErr",f:EN},40:{n:"PtgMemNoMem",f:TN},41:{n:"PtgMemFunc",f:wN},42:{n:"PtgRefErr",f:_N},43:{n:"PtgAreaErr",f:W3},44:{n:"PtgRefN",f:tN},45:{n:"PtgAreaN",f:V3},46:{n:"PtgMemAreaN",f:UN},47:{n:"PtgMemNoMemN",f:$N},57:{n:"PtgNameX",f:gN},58:{n:"PtgRef3d",f:rN},59:{n:"PtgArea3d",f:z3},60:{n:"PtgRefErr3d",f:SN},61:{n:"PtgAreaErr3d",f:H3},255:{}},WN={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},HN={1:{n:"PtgElfLel",f:av},2:{n:"PtgElfRw",f:PN},3:{n:"PtgElfCol",f:NN},6:{n:"PtgElfRwV",f:DN},7:{n:"PtgElfColV",f:AN},10:{n:"PtgElfRadical",f:FN},11:{n:"PtgElfRadicalS",f:jN},13:{n:"PtgElfColS",f:CN},15:{n:"PtgElfColSV",f:bN},16:{n:"PtgElfRadicalLel",f:ON},25:{n:"PtgList",f:RN},29:{n:"PtgSxName",f:LN},255:{}},VN={0:{n:"PtgAttrNoop",f:zN},1:{n:"PtgAttrSemi",f:J3},2:{n:"PtgAttrIf",f:X3},4:{n:"PtgAttrChoose",f:K3},8:{n:"PtgAttrGoto",f:q3},16:{n:"PtgAttrSum",f:aN},32:{n:"PtgAttrBaxcel",f:Rp},33:{n:"PtgAttrBaxcel",f:Rp},64:{n:"PtgAttrSpace",f:Q3},65:{n:"PtgAttrSpaceSemi",f:Z3},128:{n:"PtgAttrIfError",f:Y3},255:{}};function GN(e,t,r,n){if(n.biff<8)return nn(e,t);for(var i=e.l+t,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=mN(e,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=pN(e,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=e.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return t=i-e.l,t!==0&&s.push(nn(e,t)),s}function KN(e,t,r){for(var n=e.l+t,i,s,a=[];n!=e.l;)t=n-e.l,s=e[e.l],i=Lp[s]||Lp[WN[s]],(s===24||s===25)&&(i=(s===24?HN:VN)[e[e.l+1]]),!i||!i.f?nn(e,t):a.push([i.n,i.f(e,t,r)]);return a}function qN(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var XN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function YN(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function ov(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Mp(e,t,r){var n=ov(e,t,r);return n=="#REF"?n:YN(n,r)}function Fs(e,t,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,c,u,d=0,h=0,p,v="";if(!e[0]||!e[0][0])return"";for(var m=-1,x="",w=0,y=e[0].length;w<y;++w){var g=e[0][w];switch(g[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:x=ot(" ",e[0][m][1][1]);break;case 1:x=ot("\r",e[0][m][1][1]);break;default:if(x="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+x,m=-1}o.push(c+XN[g[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Ea(g[1][1],a,i),o.push(Ta(u,s));break;case"PtgRefN":u=r?Ea(g[1][1],r,i):g[1][1],o.push(Ta(u,s));break;case"PtgRef3d":d=g[1][1],u=Ea(g[1][2],a,i),v=Mp(n,d,i),o.push(v+"!"+Ta(u,s));break;case"PtgFunc":case"PtgFuncVar":var k=g[1][0],j=g[1][1];k||(k=0),k&=127;var O=k==0?[]:o.slice(-k);o.length-=k,j==="User"&&(j=O.shift()),o.push(j+"("+O.join(",")+")");break;case"PtgBool":o.push(g[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(g[1]);break;case"PtgNum":o.push(String(g[1]));break;case"PtgStr":o.push('"'+g[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(g[1]);break;case"PtgAreaN":p=Sp(g[1][1],r?{s:r}:a,i),o.push(xu(p,i));break;case"PtgArea":p=Sp(g[1][1],a,i),o.push(xu(p,i));break;case"PtgArea3d":d=g[1][1],p=g[1][2],v=Mp(n,d,i),o.push(v+"!"+xu(p,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=g[1][2];var T=(n.names||[])[h-1]||(n[0]||[])[h],I=T?T.Name:"SH33TJSNAME"+String(h);I&&I.slice(0,6)=="_xlfn."&&!i.xlfn&&(I=I.slice(6)),o.push(I);break;case"PtgNameX":var A=g[1][1];h=g[1][2];var R;if(i.biff<=5)A<0&&(A=-A),n[A]&&(R=n[A][h]);else{var K="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][h]&&n[A][h].itab>0&&(K=n.SheetNames[n[A][h].itab-1]+"!"):K=n.SheetNames[h-1]+"!"),n[A]&&n[A][h])K+=n[A][h].Name;else if(n[0]&&n[0][h])K+=n[0][h].Name;else{var G=(ov(n,A,i)||"").split(";;");G[h-1]?K=G[h-1]:K+="SH33TJSERRX"}o.push(K);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var Q="(",ye=")";if(m>=0){switch(x="",e[0][m][1][0]){case 2:Q=ot(" ",e[0][m][1][1])+Q;break;case 3:Q=ot("\r",e[0][m][1][1])+Q;break;case 4:ye=ot(" ",e[0][m][1][1])+ye;break;case 5:ye=ot("\r",e[0][m][1][1])+ye;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(Q+o.pop()+ye);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:g[1][1],r:g[1][0]};var Ee={c:r.c,r:r.r};if(n.sharedf[Ve(u)]){var re=n.sharedf[Ve(u)];o.push(Fs(re,a,Ee,n,i))}else{var Se=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Fs(c[1],a,Ee,n,i)),Se=!0;break}Se||o.push(g[1])}break;case"PtgArray":o.push("{"+qN(g[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+g[1].idx+"[#"+g[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(g));default:throw new Error("Unrecognized Formula Token: "+String(g))}var le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&le.indexOf(e[0][w][0])==-1){g=e[0][m];var xe=!0;switch(g[1][0]){case 4:xe=!1;case 0:x=ot(" ",g[1][1]);break;case 5:xe=!1;case 1:x=ot("\r",g[1][1]);break;default:if(x="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+g[1][0])}o.push((xe?x:"")+o.pop()+(xe?"":x)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function JN(e){if(e==null){var t=X(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Fi(e);return Fi(0)}function QN(e,t,r,n,i){var s=Oi(t,r,i),a=JN(e.v),o=X(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=X(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var d=Ft([s,a,o,c]);return d}function bc(e,t,r){var n=e.read_shift(4),i=KN(e,n,r),s=e.read_shift(4),a=s>0?GN(e,s,i,r):null;return[i,a]}var ZN=bc,Ac=bc,eC=bc,tC=bc,rC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},lv={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},nC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function iC(e){var t="of:="+e.replace(Zf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function sC(e){return e.replace(/\./,"!")}var ka=typeof Map<"u";function rd(e,t,r){var n=0,i=e.length;if(r){if(ka?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=ka?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(ka?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function Fc(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(vn=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ql(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=O0(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function cv(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function li(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){ig(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function aC(e,t,r){if(e&&e["!ref"]){var n=Qe(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function oC(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ht(e[r])+'"/>';return t+"</mergeCells>"}function lC(e,t,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,a.codeName=Xa(We(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+se("outlinePr",null,c)}!s&&!o||(i[i.length]=se("sheetPr",o,a))}var cC=["objects","scenarios","selectLockedCells","selectUnlockedCells"],uC=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function fC(e){var t={sheet:1};return cC.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),uC.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Gg(e.password).toString(16).toUpperCase()),se("sheetProtection",null,t)}function dC(e){return cv(e),se("pageMargins",null,e)}function hC(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=se("col",null,Fc(i,n)));return r[r.length]="</cols>",r.join("")}function pC(e,t,r,n){var i=typeof e.ref=="string"?e.ref:ht(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=wr(i);a.s.r==a.e.r&&(a.e.r=wr(t["!ref"]).e.r,i=ht(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),se("autoFilter",null,{ref:i})}function mC(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),se("sheetViews",se("sheetView",null,i),{})}function xC(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=uo[e.v];break;case"d":n&&n.cellDates?i=Jt(e.v,-1).toISOString():(e=ur(e),e.t="n",i=""+(e.v=cr(Jt(e.v)))),typeof e.z>"u"&&(e.z=lt[14]);break;default:i=e.v;break}var o=Ot("v",We(i)),l={r:t},c=li(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Ot("v",""+rd(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=a),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=se("f",We(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),se("c",o,l)}function gC(e,t,r,n){var i=[],s=[],a=Qe(e["!ref"]),o="",l,c="",u=[],d=0,h=0,p=e["!rows"],v=Array.isArray(e),m={r:c},x,w=-1;for(h=a.s.c;h<=a.e.c;++h)u[h]=Ut(h);for(d=a.s.r;d<=a.e.r;++d){for(s=[],c=Pt(d),h=a.s.c;h<=a.e.c;++h){l=u[h]+c;var y=v?(e[d]||[])[h]:e[l];y!==void 0&&(o=xC(y,l,e,t))!=null&&s.push(o)}(s.length>0||p&&p[d])&&(m={r:c},p&&p[d]&&(x=p[d],x.hidden&&(m.hidden=1),w=-1,x.hpx?w=Xl(x.hpx):x.hpt&&(w=x.hpt),w>-1&&(m.ht=w,m.customHeight=1),x.level&&(m.outlineLevel=x.level)),i[i.length]=se("row",s.join(""),m))}if(p)for(;d<p.length;++d)p&&p[d]&&(m={r:d+1},x=p[d],x.hidden&&(m.hidden=1),w=-1,x.hpx?w=Xl(x.hpx):x.hpt&&(w=x.hpt),w>-1&&(m.ht=w,m.customHeight=1),x.level&&(m.outlineLevel=x.level),i[i.length]=se("row","",m));return i.join("")}function uv(e,t,r,n){var i=[pt,se("worksheet",null,{xmlns:Bs[0],"xmlns:r":wt.r})],s=r.SheetNames[e],a=0,o="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=Qe(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=ht(u)}n||(n={}),l["!comments"]=[];var d=[];lC(l,r,e,t,i),i[i.length]=se("dimension",null,{ref:c}),i[i.length]=mC(l,t,e,r),t.sheetFormat&&(i[i.length]=se("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=hC(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=gC(l,t),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=fC(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=pC(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=oC(l["!merges"]));var h=-1,p,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(v=ze(n,-1,We(m[1].Target).replace(/#.*$/,""),Le.HLINK),p["r:id"]="rId"+v),(h=m[1].Target.indexOf("#"))>-1&&(p.location=We(m[1].Target.slice(h+1))),m[1].Tooltip&&(p.tooltip=We(m[1].Tooltip)),i[i.length]=se("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=dC(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Ot("ignoredErrors",se("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(v=ze(n,-1,"../drawings/drawing"+(e+1)+".xml",Le.DRAW),i[i.length]=se("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=d),l["!comments"].length>0&&(v=ze(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Le.VML),i[i.length]=se("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function vC(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function yC(e,t,r){var n=X(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=Xl(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var d=-1,h=-1,p=u<<10;p<u+1<<10;++p){c.c=p;var v=Array.isArray(r)?(r[c.r]||[])[c.c]:r[Ve(c)];v&&(d<0&&(d=p),h=p)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,h))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function wC(e,t,r,n){var i=yC(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Z(e,0,i)}var _C=Bi,SC=$s;function EC(){}function TC(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=D4(e),r}function kC(e,t,r){r==null&&(r=X(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Vl({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),kg(e,r),r.slice(0,r.l)}function NC(e){var t=jr(e);return[t]}function CC(e,t,r){return r==null&&(r=X(8)),Ri(t,r)}function bC(e){var t=Li(e);return[t]}function AC(e,t,r){return r==null&&(r=X(4)),Mi(t,r)}function FC(e){var t=jr(e),r=e.read_shift(1);return[t,r,"b"]}function OC(e,t,r){return r==null&&(r=X(9)),Ri(t,r),r.write_shift(1,e.v?1:0),r}function jC(e){var t=Li(e),r=e.read_shift(1);return[t,r,"b"]}function PC(e,t,r){return r==null&&(r=X(5)),Mi(t,r),r.write_shift(1,e.v?1:0),r}function DC(e){var t=jr(e),r=e.read_shift(1);return[t,r,"e"]}function IC(e,t,r){return r==null&&(r=X(9)),Ri(t,r),r.write_shift(1,e.v),r}function RC(e){var t=Li(e),r=e.read_shift(1);return[t,r,"e"]}function LC(e,t,r){return r==null&&(r=X(8)),Mi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function MC(e){var t=jr(e),r=e.read_shift(4);return[t,r,"s"]}function BC(e,t,r){return r==null&&(r=X(12)),Ri(t,r),r.write_shift(4,t.v),r}function UC(e){var t=Li(e),r=e.read_shift(4);return[t,r,"s"]}function $C(e,t,r){return r==null&&(r=X(8)),Mi(t,r),r.write_shift(4,t.v),r}function zC(e){var t=jr(e),r=zs(e);return[t,r,"n"]}function WC(e,t,r){return r==null&&(r=X(16)),Ri(t,r),Fi(e.v,r),r}function HC(e){var t=Li(e),r=zs(e);return[t,r,"n"]}function VC(e,t,r){return r==null&&(r=X(12)),Mi(t,r),Fi(e.v,r),r}function GC(e){var t=jr(e),r=Ng(e);return[t,r,"n"]}function KC(e,t,r){return r==null&&(r=X(12)),Ri(t,r),Cg(e.v,r),r}function qC(e){var t=Li(e),r=Ng(e);return[t,r,"n"]}function XC(e,t,r){return r==null&&(r=X(8)),Mi(t,r),Cg(e.v,r),r}function YC(e){var t=jr(e),r=qf(e);return[t,r,"is"]}function JC(e){var t=jr(e),r=$t(e);return[t,r,"str"]}function QC(e,t,r){return r==null&&(r=X(12+4*e.v.length)),Ri(t,r),St(e.v,r),r.length>r.l?r.slice(0,r.l):r}function ZC(e){var t=Li(e),r=$t(e);return[t,r,"str"]}function eb(e,t,r){return r==null&&(r=X(8+4*e.v.length)),Mi(t,r),St(e.v,r),r.length>r.l?r.slice(0,r.l):r}function tb(e,t,r){var n=e.l+t,i=jr(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(r.cellFormula){e.l+=2;var o=Ac(e,n-e.l,r);a[3]=Fs(o,null,i,r.supbooks,r)}else e.l=n;return a}function rb(e,t,r){var n=e.l+t,i=jr(e);i.r=r["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(r.cellFormula){e.l+=2;var o=Ac(e,n-e.l,r);a[3]=Fs(o,null,i,r.supbooks,r)}else e.l=n;return a}function nb(e,t,r){var n=e.l+t,i=jr(e);i.r=r["!row"];var s=zs(e),a=[i,s,"n"];if(r.cellFormula){e.l+=2;var o=Ac(e,n-e.l,r);a[3]=Fs(o,null,i,r.supbooks,r)}else e.l=n;return a}function ib(e,t,r){var n=e.l+t,i=jr(e);i.r=r["!row"];var s=$t(e),a=[i,s,"str"];if(r.cellFormula){e.l+=2;var o=Ac(e,n-e.l,r);a[3]=Fs(o,null,i,r.supbooks,r)}else e.l=n;return a}var sb=Bi,ab=$s;function ob(e,t){return t==null&&(t=X(4)),t.write_shift(4,e),t}function lb(e,t){var r=e.l+t,n=Bi(e),i=Xf(e),s=$t(e),a=$t(e),o=$t(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function cb(e,t){var r=X(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));$s({s:_t(e[0]),e:_t(e[0])},r),Yf("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return St(i||"",r),St(e[1].Tooltip||"",r),St("",r),r.slice(0,r.l)}function ub(){}function fb(e,t,r){var n=e.l+t,i=bg(e),s=e.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=ZN(e,n-e.l,r);a[1]=o}else e.l=n;return a}function db(e,t,r){var n=e.l+t,i=Bi(e),s=[i];if(r.cellFormula){var a=tC(e,n-e.l,r);s[1]=a,e.l=n}else e.l=n;return s}function hb(e,t,r){r==null&&(r=X(18));var n=Fc(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var fv=["left","right","top","bottom","header","footer"];function pb(e){var t={};return fv.forEach(function(r){t[r]=zs(e)}),t}function mb(e,t){return t==null&&(t=X(6*8)),cv(e),fv.forEach(function(r){Fi(e[r],t)}),t}function xb(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function gb(e,t,r){r==null&&(r=X(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function vb(e){var t=X(24);return t.write_shift(4,4),t.write_shift(4,1),$s(e,t),t}function yb(e,t){return t==null&&(t=X(16*4+2)),t.write_shift(2,e.password?Gg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function wb(){}function _b(){}function Sb(e,t,r,n,i,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=ur(t),t.z=t.z||lt[14],t.v=cr(Jt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=li(i.cellXfs,t,i),t.l&&s["!links"].push([Ve(l),t.l]),t.c&&s["!comments"].push([Ve(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=rd(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,a?Z(e,18,$C(t,l)):Z(e,7,BC(t,l))):(l.t="str",a?Z(e,17,eb(t,l)):Z(e,6,QC(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?Z(e,13,XC(t,l)):Z(e,2,KC(t,l)):a?Z(e,16,VC(t,l)):Z(e,5,WC(t,l)),!0;case"b":return l.t="b",a?Z(e,15,PC(t,l)):Z(e,4,OC(t,l)),!0;case"e":return l.t="e",a?Z(e,14,LC(t,l)):Z(e,3,IC(t,l)),!0}return a?Z(e,12,AC(t,l)):Z(e,1,CC(t,l)),!0}function Eb(e,t,r,n){var i=Qe(t["!ref"]||"A1"),s,a="",o=[];Z(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){a=Pt(u),wC(e,t,i,u);var d=!1;if(u<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){u===i.s.r&&(o[h]=Ut(h)),s=o[h]+a;var p=l?(t[u]||[])[h]:t[s];if(!p){d=!1;continue}d=Sb(e,p,u,h,n,t,d)}}Z(e,146)}function Tb(e,t){!t||!t["!merges"]||(Z(e,177,ob(t["!merges"].length)),t["!merges"].forEach(function(r){Z(e,176,ab(r))}),Z(e,178))}function kb(e,t){!t||!t["!cols"]||(Z(e,390),t["!cols"].forEach(function(r,n){r&&Z(e,60,hb(n,r))}),Z(e,391))}function Nb(e,t){!t||!t["!ref"]||(Z(e,648),Z(e,649,vb(Qe(t["!ref"]))),Z(e,650))}function Cb(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=ze(r,-1,n[1].Target.replace(/#.*$/,""),Le.HLINK);Z(e,494,cb(n,i))}}),delete t["!links"]}function bb(e,t,r,n){if(t["!comments"].length>0){var i=ze(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Le.VML);Z(e,551,Yf("rId"+i)),t["!legacy"]=i}}function Ab(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:ht(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=wr(s);o.s.r==o.e.r&&(o.e.r=wr(t["!ref"]).e.r,s=ht(o));for(var l=0;l<a.length;++l){var c=a[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Z(e,161,$s(Qe(s))),Z(e,162)}}function Fb(e,t,r){Z(e,133),Z(e,137,gb(t,r)),Z(e,138),Z(e,134)}function Ob(e,t){t["!protect"]&&Z(e,535,yb(t["!protect"]))}function jb(e,t,r,n){var i=lr(),s=r.SheetNames[e],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=Qe(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Z(i,129),(r.vbaraw||a["!outline"])&&Z(i,147,kC(o,a["!outline"])),Z(i,148,SC(l)),Fb(i,a,r.Workbook),kb(i,a),Eb(i,a,e,t),Ob(i,a),Ab(i,a,r,e),Tb(i,a),Cb(i,a,n),a["!margins"]&&Z(i,476,mb(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Nb(i,a),bb(i,a,e,n),Z(i,130),i.end()}function Pb(e,t){e.l+=10;var r=$t(e);return{name:r}}var Db=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Ib(e){return!e.Workbook||!e.Workbook.WBProps?"false":d4(e.Workbook.WBProps.date1904)?"true":"false"}var Rb="][*?/\\".split("");function dv(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Rb.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Lb(e,t,r){e.forEach(function(n,i){dv(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=t&&t[i]&&t[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function Mb(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Lb(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)aC(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function hv(e){var t=[pt];t[t.length]=se("workbook",null,{xmlns:Bs[0],"xmlns:r":wt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Db.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=se("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var a={name:We(e.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=se("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=se("definedName",We(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Bb(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=F0(e),r.name=$t(e),r}function Ub(e,t){return t||(t=X(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Yf(e.strRelID,t),St(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function $b(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?$t(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function zb(e,t){t||(t=X(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),kg(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Wb(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=I4(e),a=eC(e,0,r),o=Xf(e);e.l=n;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function Hb(e,t){Z(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Z(e,156,Ub(i))}Z(e,144)}function Vb(e,t){t||(t=X(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return St("SheetJS",t),St(Ll.version,t),St(Ll.version,t),St("7262",t),t.length>t.l?t.slice(0,t.l):t}function Gb(e,t){t||(t=X(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Kb(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Z(e,135),Z(e,158,Gb(i)),Z(e,136))}}function qb(e,t){var r=lr();return Z(r,131),Z(r,128,Vb()),Z(r,153,zb(e.Workbook&&e.Workbook.WBProps||null)),Kb(r,e),Hb(r,e),Z(r,132),r.end()}function Xb(e,t,r){return(t.slice(-4)===".bin"?qb:hv)(e)}function Yb(e,t,r,n,i){return(t.slice(-4)===".bin"?jb:uv)(e,r,n,i)}function Jb(e,t,r){return(t.slice(-4)===".bin"?m3:Xg)(e,r)}function Qb(e,t,r){return(t.slice(-4)===".bin"?zk:Vg)(e,r)}function Zb(e,t,r){return(t.slice(-4)===".bin"?O3:ev)(e)}function eA(e){return(e.slice(-4)===".bin"?E3:Qg)()}function tA(e,t){var r=[];return e.Props&&r.push(J4(e.Props,t)),e.Custprops&&r.push(Q4(e.Props,e.Custprops)),r.join("")}function rA(){return""}function nA(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(se("NumberFormat",null,{"ss:Format":We(lt[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(se("Style",s.join(""),a))}),se("Styles",r.join(""))}function pv(e){return se("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ed(e.Ref,{r:0,c:0})})}function iA(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(pv(i)))}return se("Names",r.join(""))}function sA(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(pv(o)))}return s.join("")}function aA(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(se("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(se("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(se("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(se("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Ot("ProtectContents","True")),e["!protect"].objects&&i.push(Ot("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Ot("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Ot("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Ot("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":se("WorksheetOptions",i.join(""),{xmlns:mr.x})}function oA(e){return e.map(function(t){var r=f4(t.t||""),n=se("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return se("Comment",n,{"ss:Author":t.a})}).join("")}function lA(e,t,r,n,i,s,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+We(ed(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=_t(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=We(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=We(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=a.c||c[u].s.r!=a.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var d="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=uo[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||lt[14]);break;case"s":d="String",h=u4(e.v||"");break}var p=li(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=a.c+1;var v=e.v!=null?h:"",m=e.t=="z"?"":'<Data ss:Type="'+d+'">'+v+"</Data>";return(e.c||[]).length>0&&(m+=oA(e.c)),se("Cell",m,o)}function cA(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=qg(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function uA(e,t,r,n){if(!e["!ref"])return"";var i=Qe(e["!ref"]),s=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(x,w){Qf(x);var y=!!x.width,g=Fc(w,x),k={"ss:Index":w+1};y&&(k["ss:Width"]=Kl(g.width)),x.hidden&&(k["ss:Hidden"]="1"),o.push(se("Column",null,k))});for(var l=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var u=[cA(c,(e["!rows"]||[])[c])],d=i.s.c;d<=i.e.c;++d){var h=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>d)&&!(s[a].s.r>c)&&!(s[a].e.c<d)&&!(s[a].e.r<c)){(s[a].s.c!=d||s[a].s.r!=c)&&(h=!0);break}if(!h){var p={r:c,c:d},v=Ve(p),m=l?(e[c]||[])[d]:e[v];u.push(lA(m,v,e,t,r,n,p))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function fA(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],a=s?sA(s,t,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?uA(s,t,e,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(aA(s,t,e,r)),n.join("")}function dA(e,t){t||(t={}),e.SSF||(e.SSF=ur(lt)),e.SSF&&(kc(),Tc(e.SSF),t.revssf=Nc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],li(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(tA(e,t)),r.push(rA()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(se("Worksheet",fA(n,t,e),{"ss:Name":We(e.SheetNames[n])}));return r[2]=nA(e,t),r[3]=iA(e),pt+se("Workbook",r.join(""),{xmlns:mr.ss,"xmlns:o":mr.o,"xmlns:x":mr.x,"xmlns:ss":mr.ss,"xmlns:dt":mr.dt,"xmlns:html":mr.html})}var yu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function hA(e,t){var r=[],n=[],i=[],s=0,a,o=fp(Tp,"n"),l=fp(kp,"n");if(e.Props)for(a=It(e.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Props[a[s]]]);if(e.Custprops)for(a=It(e.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(l,a[s])?n:i).push([a[s],e.Custprops[a[s]]]);var c=[];for(s=0;s<i.length;++s)Mg.indexOf(i[s][0])>-1||Ig.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Ge.utils.cfb_add(t,"/SummaryInformation",Fp(n,yu.SI,l,kp)),(r.length||c.length)&&Ge.utils.cfb_add(t,"/DocumentSummaryInformation",Fp(r,yu.DSI,o,Tp,c.length?c:null,yu.UDI))}function pA(e,t){var r=t||{},n=Ge.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ge.utils.cfb_add(n,i,mv(e,r)),r.biff==8&&(e.Props||e.Custprops)&&hA(e,n),r.biff==8&&e.vbaraw&&j3(n,Ge.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var mA={0:{f:vC},1:{f:NC},2:{f:GC},3:{f:DC},4:{f:FC},5:{f:zC},6:{f:JC},7:{f:MC},8:{f:ib},9:{f:nb},10:{f:tb},11:{f:rb},12:{f:bC},13:{f:qC},14:{f:RC},15:{f:jC},16:{f:HC},17:{f:ZC},18:{f:UC},19:{f:qf},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Wb},40:{},42:{},43:{f:Jk},44:{f:Xk},45:{f:e3},46:{f:r3},47:{f:t3},48:{},49:{f:b4},50:{},51:{f:v3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ak},62:{f:YC},63:{f:T3},64:{f:wb},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:nn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:xb},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:TC},148:{f:_C,p:16},151:{f:ub},152:{},153:{f:$b},154:{},155:{},156:{f:Bb},157:{},158:{},159:{T:1,f:Bk},160:{T:-1},161:{T:1,f:Bi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:sb},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:x3},336:{T:-1},337:{f:_3,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:F0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ek},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:fb},427:{f:db},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:pb},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:EC},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:lb},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:F0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:A3},633:{T:1},634:{T:-1},635:{T:1,f:C3},636:{T:-1},637:{f:j4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Pb},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:_b},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ae(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&Vf(r)&&e.push(r)}}function xA(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return ae(e,t,r,i);var s=t;if(!isNaN(s)){for(var a=r.parts||[],o=0,l=0,c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<i;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(a[o]||8224)<=8224;)c+=a[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function ho(e,t,r){return e||(e=X(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function gA(e,t,r,n){var i=X(9);return ho(i,e,t),Ug(r,n||"b",i),i}function vA(e,t,r){var n=X(8+2*r.length);return ho(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function yA(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?cr(Jt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?ae(e,2,Pk(r,n,i)):ae(e,3,jk(r,n,i));return;case"b":case"e":ae(e,5,gA(r,n,t.v,t.t));return;case"s":case"str":ae(e,4,vA(r,n,(t.v||"").slice(0,255)));return}ae(e,1,ho(null,r,n))}function wA(e,t,r,n){var i=Array.isArray(t),s=Qe(t["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=ht(s)}for(var c=s.s.r;c<=s.e.r;++c){o=Pt(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=Ut(u)),a=l[u]+o;var d=i?(t[c]||[])[u]:t[a];d&&yA(e,d,c,u)}}}function _A(e,t){for(var r=t||{},n=lr(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ae(n,r.biff==4?1033:r.biff==3?521:9,Jf(e,16,r)),wA(n,e.Sheets[e.SheetNames[i]],i,r),ae(n,10),n.end()}function SA(e,t,r){ae(e,49,mk({sz:12,name:"Arial"},r))}function EA(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&ae(e,1054,vk(i,t[i],r))})}function TA(e,t){var r=X(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ae(e,2151,r),r=X(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Wg(Qe(t["!ref"]||"A1"),r),r.write_shift(4,4),ae(e,2152,r)}function kA(e,t){for(var r=0;r<16;++r)ae(e,224,jp({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){ae(e,224,jp(n,0,t))})}function NA(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];ae(e,440,Nk(n)),n[1].Tooltip&&ae(e,2048,Ck(n))}delete t["!links"]}function CA(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&ae(e,125,Fk(Fc(i,n),i))})}}function bA(e,t,r,n,i){var s=16+li(i.cellXfs,t,i);if(t.v==null&&!t.bf){ae(e,513,Oi(r,n,s));return}if(t.bf)ae(e,6,QN(t,r,n,i,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?cr(Jt(t.v)):t.v;ae(e,515,Sk(r,n,a,s));break;case"b":case"e":ae(e,517,_k(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=rd(i.Strings,t.v,i.revStrings);ae(e,253,xk(r,n,o,s))}else ae(e,516,gk(r,n,(t.v||"").slice(0,255),s,i));break;default:ae(e,513,Oi(r,n,s))}}function AA(e,t,r){var n=lr(),i=r.SheetNames[e],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[e]||{},l=Array.isArray(s),c=t.biff==8,u,d="",h=[],p=Qe(s["!ref"]||"A1"),v=c?65536:16384;if(p.e.c>255||p.e.r>=v){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,v-1)}ae(n,2057,Jf(r,16,t)),ae(n,13,kr(1)),ae(n,12,kr(100)),ae(n,15,Xt(!0)),ae(n,17,Xt(!1)),ae(n,16,Fi(.001)),ae(n,95,Xt(!0)),ae(n,42,Xt(!1)),ae(n,43,Xt(!1)),ae(n,130,kr(1)),ae(n,128,wk()),ae(n,131,Xt(!1)),ae(n,132,Xt(!1)),c&&CA(n,s["!cols"]),ae(n,512,yk(p,t)),c&&(s["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){d=Pt(m);for(var x=p.s.c;x<=p.e.c;++x){m===p.s.r&&(h[x]=Ut(x)),u=h[x]+d;var w=l?(s[m]||[])[x]:s[u];w&&(bA(n,w,m,x,t),c&&w.l&&s["!links"].push([u,w.l]))}}var y=o.CodeName||o.name||i;return c&&ae(n,574,pk((a.Views||[])[0])),c&&(s["!merges"]||[]).length&&ae(n,229,kk(s["!merges"])),c&&NA(n,s),ae(n,442,zg(y)),c&&TA(n,s),ae(n,10),n.end()}function FA(e,t,r){var n=lr(),i=(e||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(ae(n,2057,Jf(e,5,r)),r.bookType=="xla"&&ae(n,135),ae(n,225,o?kr(1200):null),ae(n,193,tk(2)),l&&ae(n,191),l&&ae(n,192),ae(n,226),ae(n,92,uk("SheetJS",r)),ae(n,66,kr(o?1200:1252)),o&&ae(n,353,kr(0)),o&&ae(n,448),ae(n,317,Ok(e.SheetNames.length)),o&&e.vbaraw&&ae(n,211),o&&e.vbaraw){var c=a.CodeName||"ThisWorkbook";ae(n,442,zg(c))}ae(n,156,kr(17)),ae(n,25,Xt(!1)),ae(n,18,Xt(!1)),ae(n,19,kr(0)),o&&ae(n,431,Xt(!1)),o&&ae(n,444,kr(0)),ae(n,61,hk()),ae(n,64,Xt(!1)),ae(n,141,kr(0)),ae(n,34,Xt(Ib(e)=="true")),ae(n,14,Xt(!0)),o&&ae(n,439,Xt(!1)),ae(n,218,kr(0)),SA(n,e,r),EA(n,e.SSF,r),kA(n,r),o&&ae(n,352,Xt(!1));var u=n.end(),d=lr();o&&ae(d,140,bk()),o&&r.Strings&&xA(d,252,dk(r.Strings)),ae(d,10);var h=d.end(),p=lr(),v=0,m=0;for(m=0;m<e.SheetNames.length;++m)v+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var x=u.length+v+h.length;for(m=0;m<e.SheetNames.length;++m){var w=s[m]||{};ae(p,133,fk({pos:x,hs:w.Hidden||0,dt:0,name:e.SheetNames[m]},r)),x+=t[m].length}var y=p.end();if(v!=y.length)throw new Error("BS8 "+v+" != "+y.length);var g=[];return u.length&&g.push(u),y.length&&g.push(y),h.length&&g.push(h),Ft(g)}function OA(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ur(lt)),e&&e.SSF&&(kc(),Tc(e.SSF),r.revssf=Nc(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,nd(r),r.cellXfs=[],li(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=AA(i,r,e);return n.unshift(FA(e,n,r)),Ft(n)}function mv(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=wr(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return OA(e,t);case 4:case 3:case 2:return _A(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function jA(e,t,r,n){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=Ve({r,c:a}),d=n.dense?(e[r]||[])[a]:e[u],h=d&&d.v!=null&&(d.h||c4(d.w||(kn(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+u,s.push(se("td",h,p))}}var v="<tr>";return v+s.join("")+"</tr>"}var PA='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',DA="</body></html>";function IA(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function xv(e,t){var r=t||{},n=r.header!=null?r.header:PA,i=r.footer!=null?r.footer:DA,s=[n],a=wr(e["!ref"]);r.dense=Array.isArray(e),s.push(IA(e,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(jA(e,a,o,r));return s.push("</table>"+i),s.join("")}function gv(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?_t(n.origin):n.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=wr(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var d=[],h=0,p=e["!rows"]||(e["!rows"]=[]),v=0,m=0,x=0,w=0,y=0,g=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&m<l;++v){var k=o[v];if(Bp(k)){if(n.display)continue;p[m]={hidden:!0}}var j=k.children;for(x=w=0;x<j.length;++x){var O=j[x];if(!(n.display&&Bp(O))){var T=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):h4(O.innerHTML),I=O.getAttribute("data-z")||O.getAttribute("z");for(h=0;h<d.length;++h){var A=d[h];A.s.c==w+s&&A.s.r<m+i&&m+i<=A.e.r&&(w=A.e.c+1-s,h=-1)}g=+O.getAttribute("colspan")||1,((y=+O.getAttribute("rowspan")||1)>1||g>1)&&d.push({s:{r:m+i,c:w+s},e:{r:m+i+(y||1)-1,c:w+s+(g||1)-1}});var R={t:"s",v:T},K=O.getAttribute("data-t")||O.getAttribute("t")||"";T!=null&&(T.length==0?R.t=K||"z":n.raw||T.trim().length==0||K=="s"||(T==="TRUE"?R={t:"b",v:!0}:T==="FALSE"?R={t:"b",v:!1}:isNaN(gn(T))?isNaN(qa(T).getDate())||(R={t:"d",v:Jt(T)},n.cellDates||(R={t:"n",v:cr(R.v)}),R.z=n.dateNF||lt[14]):R={t:"n",v:gn(T)})),R.z===void 0&&I!=null&&(R.z=I);var G="",Q=O.getElementsByTagName("A");if(Q&&Q.length)for(var ye=0;ye<Q.length&&!(Q[ye].hasAttribute("href")&&(G=Q[ye].getAttribute("href"),G.charAt(0)!="#"));++ye);G&&G.charAt(0)!="#"&&(R.l={Target:G}),n.dense?(e[m+i]||(e[m+i]=[]),e[m+i][w+s]=R):e[Ve({c:w+s,r:m+i})]=R,c.e.c<w+s&&(c.e.c=w+s),w+=g}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,m-1+i),e["!ref"]=ht(c),m>=l&&(e["!fullref"]=ht((c.e.r=o.length-v+m-1+i,c))),e}function vv(e,t){var r=t||{},n=r.dense?[]:{};return gv(n,e,t)}function RA(e,t){return Ii(vv(e,t),t)}function Bp(e){var t="",r=LA(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function LA(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var MA=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Ya({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return pt+t}}(),Up=function(){var e=function(s){return We(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var l=[];l.push('      <table:table table:name="'+We(a.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,d=wr(s["!ref"]||"A1"),h=s["!merges"]||[],p=0,v=Array.isArray(s);if(s["!cols"])for(u=0;u<=d.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var m="",x=s["!rows"]||[];for(c=0;c<d.s.r;++c)m=x[c]?' table:style-name="ro'+x[c].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;c<=d.e.r;++c){for(m=x[c]?' table:style-name="ro'+x[c].ods+'"':"",l.push("        <table:table-row"+m+`>
`),u=0;u<d.s.c;++u)l.push(t);for(;u<=d.e.c;++u){var w=!1,y={},g="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>u)&&!(h[p].s.r>c)&&!(h[p].e.c<u)&&!(h[p].e.r<c)){(h[p].s.c!=u||h[p].s.r!=c)&&(w=!0),y["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,y["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(w){l.push(r);continue}var k=Ve({r:c,c:u}),j=v?(s[c]||[])[u]:s[k];if(j&&j.f&&(y["table:formula"]=We(iC(j.f)),j.F&&j.F.slice(0,k.length)==k)){var O=wr(j.F);y["table:number-matrix-columns-spanned"]=O.e.c-O.s.c+1,y["table:number-matrix-rows-spanned"]=O.e.r-O.s.r+1}if(!j){l.push(t);continue}switch(j.t){case"b":g=j.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=j.v?"true":"false";break;case"n":g=j.w||String(j.v||0),y["office:value-type"]="float",y["office:value"]=j.v||0;break;case"s":case"str":g=j.v==null?"":j.v,y["office:value-type"]="string";break;case"d":g=j.w||Jt(j.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Jt(j.v).toISOString(),y["table:style-name"]="ce1";break;default:l.push(t);continue}var T=e(g);if(j.l&&j.l.Target){var I=j.l.Target;I=I.charAt(0)=="#"?"#"+sC(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),T=se("text:a",T,{"xlink:href":I.replace(/&/g,"&amp;")})}l.push("          "+se("table:table-cell",se("text:p",T,{}),y)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var d=c["!cols"][u];if(d.width==null&&d.wpx==null&&d.wch==null)continue;Qf(d),d.ods=o;var h=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(c){return a.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var d=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[pt],c=Ya({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Ya({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(Pg().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=a.SheetNames.length;++d)l.push(n(a.Sheets[a.SheetNames[d]],a,d));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function yv(e,t){if(t.bookType=="fods")return Up(e,t);var r=$f(),n="",i=[],s=[];return n="mimetype",Ce(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ce(r,n,Up(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Ce(r,n,MA(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Ce(r,n,pt+Pg()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Ce(r,n,Y4(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ce(r,n,q4(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Yl(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function BA(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Hr(Xa(e))}function UA(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ti(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function $A(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function Ja(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function $e(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function ws(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function mt(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Ja(e,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:a=4,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Ja(e,r),o=e.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function Nt(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push($e(n*8+i.type)),i.type==2&&t.push($e(i.data.length)),t.push(i.data))})}),ti(t)}function Lr(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Ja(e,n),s=mt(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:ws(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=mt(o.data),c=ws(l[3][0].data);a.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(a.merge=ws(s[3][0].data)>>>0>0),r.push(a)}return r}function Ki(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:$e(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:$e(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:$e(a.data.length)}],n[2].push({data:Nt(a.meta),type:2})});var s=Nt(n);t.push($e(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),ti(t)}function zA(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Ja(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var a=t[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[r[0]],o>1&&(a|=t[r[0]+1]<<8),o>2&&(a|=t[r[0]+2]<<16),o>3&&(a|=t[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(t.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[ti(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=ti(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Mr(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(zA(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ti(t)}function qi(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=$e(n),a=s.length;t.push(s),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return ti(t)}function wu(e,t){var r=new Uint8Array(32),n=Yl(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,$A(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function _u(e,t){var r=new Uint8Array(32),n=Yl(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function An(e){var t=mt(e);return Ja(t[1][0].data)}function WA(e,t,r){var n,i,s,a;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=e[8])==null?void 0:s[0])==null?void 0:a.data)&&ws(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Yl(e[7][0].data),u=0,d=[],h=Yl(e[4][0].data),p=0,v=[],m=0;m<t.length;++m){if(t[m]==null){c.setUint16(m*2,65535,!0),h.setUint16(m*2,65535);continue}c.setUint16(m*2,u,!0),h.setUint16(m*2,p,!0);var x,w;switch(typeof t[m]){case"string":x=wu({t:"s",v:t[m]},r),w=_u({t:"s",v:t[m]},r);break;case"number":x=wu({t:"n",v:t[m]},r),w=_u({t:"n",v:t[m]},r);break;case"boolean":x=wu({t:"b",v:t[m]},r),w=_u({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}d.push(x),u+=x.length,v.push(w),p+=w.length,++l}for(e[2][0].data=$e(l);m<e[7][0].data.length/2;++m)c.setUint16(m*2,65535,!0),h.setUint16(m*2,65535,!0);return e[6][0].data=ti(d),e[3][0].data=ti(v),l}function HA(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=wr(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(ht(n)));var s=Jl(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(U){return U.forEach(function(D){typeof D=="string"&&a.push(D)})});var o={},l=[],c=Ge.read(t.numbers,{type:"base64"});c.FileIndex.map(function(U,D){return[U,c.FullPaths[D]]}).forEach(function(U){var D=U[0],P=U[1];if(D.type==2&&D.name.match(/\.iwa/)){var J=D.content,pe=Mr(J),ve=Lr(pe);ve.forEach(function(ge){l.push(ge.id),o[ge.id]={deps:[],location:P,type:ws(ge.messages[0].meta[1][0].data)}})}}),l.sort(function(U,D){return U-D});var u=l.filter(function(U){return U>1}).map(function(U){return[U,$e(U)]});c.FileIndex.map(function(U,D){return[U,c.FullPaths[D]]}).forEach(function(U){var D=U[0];if(U[1],!!D.name.match(/\.iwa/)){var P=Lr(Mr(D.content));P.forEach(function(J){J.messages.forEach(function(pe){u.forEach(function(ve){J.messages.some(function(ge){return ws(ge.meta[1][0].data)!=11006&&UA(ge.data,ve[1])})&&o[ve[0]].deps.push(J.id)})})})}});for(var d=Ge.find(c,o[1].location),h=Lr(Mr(d.content)),p,v=0;v<h.length;++v){var m=h[v];m.id==1&&(p=m)}var x=An(mt(p.messages[0].data)[1][0].data);for(d=Ge.find(c,o[x].location),h=Lr(Mr(d.content)),v=0;v<h.length;++v)m=h[v],m.id==x&&(p=m);for(x=An(mt(p.messages[0].data)[2][0].data),d=Ge.find(c,o[x].location),h=Lr(Mr(d.content)),v=0;v<h.length;++v)m=h[v],m.id==x&&(p=m);for(x=An(mt(p.messages[0].data)[2][0].data),d=Ge.find(c,o[x].location),h=Lr(Mr(d.content)),v=0;v<h.length;++v)m=h[v],m.id==x&&(p=m);var w=mt(p.messages[0].data);{w[6][0].data=$e(n.e.r+1),w[7][0].data=$e(n.e.c+1);var y=An(w[46][0].data),g=Ge.find(c,o[y].location),k=Lr(Mr(g.content));{for(var j=0;j<k.length&&k[j].id!=y;++j);if(k[j].id!=y)throw"Bad ColumnRowUIDMapArchive";var O=mt(k[j].messages[0].data);O[1]=[],O[2]=[],O[3]=[];for(var T=0;T<=n.e.c;++T){var I=[];I[1]=I[2]=[{type:0,data:$e(T+420690)}],O[1].push({type:2,data:Nt(I)}),O[2].push({type:0,data:$e(T)}),O[3].push({type:0,data:$e(T)})}O[4]=[],O[5]=[],O[6]=[];for(var A=0;A<=n.e.r;++A)I=[],I[1]=I[2]=[{type:0,data:$e(A+726270)}],O[4].push({type:2,data:Nt(I)}),O[5].push({type:0,data:$e(A)}),O[6].push({type:0,data:$e(A)});k[j].messages[0].data=Nt(O)}g.content=qi(Ki(k)),g.size=g.content.length,delete w[46];var R=mt(w[4][0].data);{R[7][0].data=$e(n.e.r+1);var K=mt(R[1][0].data),G=An(K[2][0].data);g=Ge.find(c,o[G].location),k=Lr(Mr(g.content));{if(k[0].id!=G)throw"Bad HeaderStorageBucket";var Q=mt(k[0].messages[0].data);for(A=0;A<s.length;++A){var ye=mt(Q[2][0].data);ye[1][0].data=$e(A),ye[4][0].data=$e(s[A].length),Q[2][A]={type:Q[2][0].type,data:Nt(ye)}}k[0].messages[0].data=Nt(Q)}g.content=qi(Ki(k)),g.size=g.content.length;var Ee=An(R[2][0].data);g=Ge.find(c,o[Ee].location),k=Lr(Mr(g.content));{if(k[0].id!=Ee)throw"Bad HeaderStorageBucket";for(Q=mt(k[0].messages[0].data),T=0;T<=n.e.c;++T)ye=mt(Q[2][0].data),ye[1][0].data=$e(T),ye[4][0].data=$e(n.e.r+1),Q[2][T]={type:Q[2][0].type,data:Nt(ye)};k[0].messages[0].data=Nt(Q)}g.content=qi(Ki(k)),g.size=g.content.length;var re=An(R[4][0].data);(function(){for(var U=Ge.find(c,o[re].location),D=Lr(Mr(U.content)),P,J=0;J<D.length;++J){var pe=D[J];pe.id==re&&(P=pe)}var ve=mt(P.messages[0].data);{ve[3]=[];var ge=[];a.forEach(function(Oe,Tt){ge[1]=[{type:0,data:$e(Tt)}],ge[2]=[{type:0,data:$e(1)}],ge[3]=[{type:2,data:BA(Oe)}],ve[3].push({type:2,data:Nt(ge)})})}P.messages[0].data=Nt(ve);var ue=Ki(D),De=qi(ue);U.content=De,U.size=U.content.length})();var Se=mt(R[3][0].data);{var le=Se[1][0];delete Se[2];var xe=mt(le.data);{var we=An(xe[2][0].data);(function(){for(var U=Ge.find(c,o[we].location),D=Lr(Mr(U.content)),P,J=0;J<D.length;++J){var pe=D[J];pe.id==we&&(P=pe)}var ve=mt(P.messages[0].data);{delete ve[6],delete Se[7];var ge=new Uint8Array(ve[5][0].data);ve[5]=[];for(var ue=0,De=0;De<=n.e.r;++De){var Oe=mt(ge);ue+=WA(Oe,s[De],a),Oe[1][0].data=$e(De),ve[5].push({data:Nt(Oe),type:2})}ve[1]=[{type:0,data:$e(n.e.c+1)}],ve[2]=[{type:0,data:$e(n.e.r+1)}],ve[3]=[{type:0,data:$e(ue)}],ve[4]=[{type:0,data:$e(n.e.r+1)}]}P.messages[0].data=Nt(ve);var Tt=Ki(D),Ie=qi(Tt);U.content=Ie,U.size=U.content.length})()}le.data=Nt(xe)}R[3][0].data=Nt(Se)}w[4][0].data=Nt(R)}p.messages[0].data=Nt(w);var be=Ki(h),F=qi(be);return d.content=F,d.size=d.content.length,c}function VA(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function nd(e){VA([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function GA(e,t){return t.bookType=="ods"?yv(e,t):t.bookType=="numbers"?HA(e,t):t.bookType=="xlsb"?KA(e,t):qA(e,t)}function KA(e,t){cs=1024,e&&!e.SSF&&(e.SSF=ur(lt)),e&&e.SSF&&(kc(),Tc(e.SSF),t.revssf=Nc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ka?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=tv.indexOf(t.bookType)>-1,i=Fg();nd(t=t||{});var s=$f(),a="",o=0;if(t.cellXfs=[],li(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Ce(s,a,Dg(e.Props,t)),i.coreprops.push(a),ze(t.rels,2,a,Le.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Ce(s,a,Rg(e.Props)),i.extprops.push(a),ze(t.rels,3,a,Le.EXT_PROPS),e.Custprops!==e.Props&&It(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Ce(s,a,Lg(e.Custprops)),i.custprops.push(a),ze(t.rels,4,a,Le.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Ce(s,a,Yb(o-1,a,t,e,u)),i.sheets.push(a),ze(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Le.WS[0])}if(d){var p=d["!comments"],v=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,Ce(s,m,Zb(p,m)),i.comments.push(m),ze(u,-1,"../comments"+o+"."+r,Le.CMNT),v=!0),d["!legacy"]&&v&&Ce(s,"xl/drawings/vmlDrawing"+o+".vml",Zg(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&Ce(s,jg(a),vs(u))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Ce(s,a,Qb(t.Strings,a,t)),i.strs.push(a),ze(t.wbrels,-1,"sharedStrings."+r,Le.SST)),a="xl/workbook."+r,Ce(s,a,Xb(e,a)),i.workbooks.push(a),ze(t.rels,1,a,Le.WB),a="xl/theme/theme1.xml",Ce(s,a,Jg(e.Themes,t)),i.themes.push(a),ze(t.wbrels,-1,"theme/theme1.xml",Le.THEME),a="xl/styles."+r,Ce(s,a,Jb(e,a,t)),i.styles.push(a),ze(t.wbrels,-1,"styles."+r,Le.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Ce(s,a,e.vbaraw),i.vba.push(a),ze(t.wbrels,-1,"vbaProject.bin",Le.VBA)),a="xl/metadata."+r,Ce(s,a,eA(a)),i.metadata.push(a),ze(t.wbrels,-1,"metadata."+r,Le.XLMETA),Ce(s,"[Content_Types].xml",Og(i,t)),Ce(s,"_rels/.rels",vs(t.rels)),Ce(s,"xl/_rels/workbook."+r+".rels",vs(t.wbrels)),delete t.revssf,delete t.ssf,s}function qA(e,t){cs=1024,e&&!e.SSF&&(e.SSF=ur(lt)),e&&e.SSF&&(kc(),Tc(e.SSF),t.revssf=Nc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ka?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=tv.indexOf(t.bookType)>-1,i=Fg();nd(t=t||{});var s=$f(),a="",o=0;if(t.cellXfs=[],li(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",Ce(s,a,Dg(e.Props,t)),i.coreprops.push(a),ze(t.rels,2,a,Le.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Ce(s,a,Rg(e.Props)),i.extprops.push(a),ze(t.rels,3,a,Le.EXT_PROPS),e.Custprops!==e.Props&&It(e.Custprops||{}).length>0&&(a="docProps/custom.xml",Ce(s,a,Lg(e.Custprops)),i.custprops.push(a),ze(t.rels,4,a,Le.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Ce(s,a,uv(o-1,t,e,d)),i.sheets.push(a),ze(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Le.WS[0])}if(h){var v=h["!comments"],m=!1,x="";if(v&&v.length>0){var w=!1;v.forEach(function(y){y[1].forEach(function(g){g.T==!0&&(w=!0)})}),w&&(x="xl/threadedComments/threadedComment"+o+"."+r,Ce(s,x,k3(v,u,t)),i.threadedcomments.push(x),ze(d,-1,"../threadedComments/threadedComment"+o+"."+r,Le.TCMNT)),x="xl/comments"+o+"."+r,Ce(s,x,ev(v)),i.comments.push(x),ze(d,-1,"../comments"+o+"."+r,Le.CMNT),m=!0}h["!legacy"]&&m&&Ce(s,"xl/drawings/vmlDrawing"+o+".vml",Zg(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&Ce(s,jg(a),vs(d))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+r,Ce(s,a,Vg(t.Strings,t)),i.strs.push(a),ze(t.wbrels,-1,"sharedStrings."+r,Le.SST)),a="xl/workbook."+r,Ce(s,a,hv(e)),i.workbooks.push(a),ze(t.rels,1,a,Le.WB),a="xl/theme/theme1.xml",Ce(s,a,Jg(e.Themes,t)),i.themes.push(a),ze(t.wbrels,-1,"theme/theme1.xml",Le.THEME),a="xl/styles."+r,Ce(s,a,Xg(e,t)),i.styles.push(a),ze(t.wbrels,-1,"styles."+r,Le.STY),e.vbaraw&&n&&(a="xl/vbaProject.bin",Ce(s,a,e.vbaraw),i.vba.push(a),ze(t.wbrels,-1,"vbaProject.bin",Le.VBA)),a="xl/metadata."+r,Ce(s,a,Qg()),i.metadata.push(a),ze(t.wbrels,-1,"metadata."+r,Le.XLMETA),u.length>1&&(a="xl/persons/person.xml",Ce(s,a,N3(u)),i.people.push(a),ze(t.wbrels,-1,"persons/person.xml",Le.PEOPLE)),Ce(s,"[Content_Types].xml",Og(i,t)),Ce(s,"_rels/.rels",vs(t.rels)),Ce(s,"xl/_rels/workbook."+r+".rels",vs(t.wbrels)),delete t.revssf,delete t.ssf,s}function XA(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Tn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function wv(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return lo(t.file,Ge.write(e,{type:Be?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ge.write(e,t)}function YA(e,t){var r=ur(t||{}),n=GA(e,r);return JA(n,r)}function JA(e,t){var r={},n=Be?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Ge.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Ec(i))}return t.password&&typeof encrypt_agile<"u"?wv(encrypt_agile(i,t.password),t):t.type==="file"?lo(t.file,i):t.type=="string"?_a(i):i}function QA(e,t){var r=t||{},n=pA(e,r);return wv(n,r)}function Qr(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Ka(Xa(n));case"binary":return Xa(n);case"string":return e;case"file":return lo(t.file,n,"utf8");case"buffer":return Be?Cn(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Qr(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ZA(e,t){switch(t.type){case"base64":return Ka(e);case"binary":return e;case"string":return e;case"file":return lo(t.file,e,"binary");case"buffer":return Be?Cn(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Go(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Ka(r):t.type=="string"?_a(r):r;case"file":return lo(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function _v(e,t){CT(),Mb(e);var r=ur(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=_v(e,r);return r.type="array",Ec(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Qr(dA(e,r),r);case"slk":case"sylk":return Qr(Ik.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Qr(xv(e.Sheets[e.SheetNames[i]],r),r);case"txt":return ZA(Sv(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Qr(id(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Qr(Rk.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Go(Dk.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Qr(Lk.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Qr(Hk.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Qr(Hg.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Qr(yv(e,r),r);case"wk1":return Go(Pp.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Go(Pp.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Go(mv(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),QA(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return YA(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function eF(e,t,r,n,i,s,a,o){var l=Pt(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||e[r])for(var p=t.s.c;p<=t.e.c;++p){var v=a?e[r][p]:e[n[p]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;s[p]!=null&&(h[s[p]]=c);continue}var m=v.v;switch(v.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[p]!=null){if(m==null)if(v.t=="e"&&m===null)h[s[p]]=null;else if(c!==void 0)h[s[p]]=c;else if(u&&m===null)h[s[p]]=null;else continue;else h[s[p]]=u&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?m:kn(v,m,o);m!=null&&(d=!1)}}return{row:h,isempty:d}}function Jl(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Qe(u);break;case"number":l=Qe(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var d=Pt(l.s.r),h=[],p=[],v=0,m=0,x=Array.isArray(e),w=l.s.r,y=0,g={};x&&!e[w]&&(e[w]=[]);var k=c.skipHidden&&e["!cols"]||[],j=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(k[y]||{}).hidden)switch(h[y]=Ut(y),r=x?e[w][y]:e[h[y]+d],n){case 1:s[y]=y-l.s.c;break;case 2:s[y]=h[y];break;case 3:s[y]=c.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=kn(r,null,c),m=g[a]||0,!m)g[a]=1;else{do o=a+"_"+m++;while(g[o]);g[a]=m,g[o]=1}s[y]=o}for(w=l.s.r+i;w<=l.e.r;++w)if(!(j[w]||{}).hidden){var O=eF(e,l,w,h,n,s,x,c);(O.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[v++]=O.row)}return p.length=v,p}var $p=/"/g;function tF(e,t,r,n,i,s,a,o){for(var l=!0,c=[],u="",d=Pt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=o.dense?(e[r]||[])[h]:e[n[h]+d];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:kn(p,null,o));for(var v=0,m=0;v!==u.length;++v)if((m=u.charCodeAt(v))===i||m===s||m===34||o.forceQuotes){u='"'+u.replace($p,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace($p,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function id(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Qe(e["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(h[v]||{}).hidden||(d[v]=Ut(v));for(var m=0,x=i.s.r;x<=i.e.r;++x)(p[x]||{}).hidden||(u=tF(e,i,x,d,a,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((m++?o:"")+u)));return delete n.dense,r.join("")}function Sv(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=id(e,t);return r}function rF(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Qe(e["!ref"]),s="",a=[],o,l=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=Ut(o);for(var u=i.s.r;u<=i.e.r;++u)for(s=Pt(u),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function Ev(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?_t(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var d=Qe(s["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),a==-1&&(a=d.e.r+1,u.e.r=a+t.length-1+i)}else a==-1&&(a=0,u.e.r=t.length-1+i);var h=n.header||[],p=0;t.forEach(function(m,x){It(m).forEach(function(w){(p=h.indexOf(w))==-1&&(h[p=h.length]=w);var y=m[w],g="z",k="",j=Ve({c:o+p,r:a+x+i});c=Qa(s,j),y&&typeof y=="object"&&!(y instanceof Date)?s[j]=y:(typeof y=="number"?g="n":typeof y=="boolean"?g="b":typeof y=="string"?g="s":y instanceof Date?(g="d",n.cellDates||(g="n",y=cr(y)),k=n.dateNF||lt[14]):y===null&&n.nullError&&(g="e",y=0),c?(c.t=g,c.v=y,delete c.w,delete c.R,k&&(c.z=k)):s[j]=c={t:g,v:y},k&&(c.z=k))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var v=Pt(a);if(i)for(p=0;p<h.length;++p)s[Ut(p+o)+v]={t:"s",v:h[p]};return s["!ref"]=ht(u),s}function nF(e,t){return Ev(null,e,t)}function Qa(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=_t(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Qa(e,Ve(t)):Qa(e,Ve({r:t,c:r||0}))}function iF(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function sF(){return{SheetNames:[],Sheets:{}}}function aF(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=a+i)!=-1;++i);}if(dv(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function oF(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=iF(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function lF(e,t){return e.z=t,e}function Tv(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function cF(e,t,r){return Tv(e,"#"+t,r)}function uF(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function fF(e,t,r,n){for(var i=typeof t!="string"?t:Qe(t),s=typeof t=="string"?t:ht(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Qa(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Vt={encode_col:Ut,encode_row:Pt,encode_cell:Ve,encode_range:ht,decode_col:Kf,decode_row:Gf,split_cell:C4,decode_cell:_t,decode_range:wr,format_cell:kn,sheet_add_aoa:Tg,sheet_add_json:Ev,sheet_add_dom:gv,aoa_to_sheet:Us,json_to_sheet:nF,table_to_sheet:vv,table_to_book:RA,sheet_to_csv:id,sheet_to_txt:Sv,sheet_to_json:Jl,sheet_to_html:xv,sheet_to_formulae:rF,sheet_to_row_object_array:Jl,sheet_get_cell:Qa,book_new:sF,book_append_sheet:aF,book_set_sheet_visibility:oF,cell_set_number_format:lF,cell_set_hyperlink:Tv,cell_set_internal_link:cF,cell_add_comment:uF,sheet_set_array_formula:fF,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},kv={exports:{}};(function(e,t){(function(r,n){n()})(At,function(){function r(c,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function n(c,u,d){var h=new XMLHttpRequest;h.open("GET",c),h.responseType="blob",h.onload=function(){l(h.response,u,d)},h.onerror=function(){console.error("could not download file")},h.send()}function i(c){var u=new XMLHttpRequest;u.open("HEAD",c,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function s(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(u)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof At=="object"&&At.global===At?At:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(c,u,d){var h=a.URL||a.webkitURL,p=document.createElement("a");u=u||c.name||"download",p.download=u,p.rel="noopener",typeof c=="string"?(p.href=c,p.origin===location.origin?s(p):i(p.href)?n(c,u,d):s(p,p.target="_blank")):(p.href=h.createObjectURL(c),setTimeout(function(){h.revokeObjectURL(p.href)},4e4),setTimeout(function(){s(p)},0))}:"msSaveOrOpenBlob"in navigator?function(c,u,d){if(u=u||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(r(c,d),u);else if(i(c))n(c,u,d);else{var h=document.createElement("a");h.href=c,h.target="_blank",setTimeout(function(){s(h)})}}:function(c,u,d,h){if(h=h||open("","_blank"),h&&(h.document.title=h.document.body.innerText="downloading..."),typeof c=="string")return n(c,u,d);var p=c.type==="application/octet-stream",v=/constructor/i.test(a.HTMLElement)||a.safari,m=/CriOS\/[\d]+/.test(navigator.userAgent);if((m||p&&v||o)&&typeof FileReader<"u"){var x=new FileReader;x.onloadend=function(){var g=x.result;g=m?g:g.replace(/^data:[^;]*;/,"data:attachment/file;"),h?h.location.href=g:location=g,h=null},x.readAsDataURL(c)}else{var w=a.URL||a.webkitURL,y=w.createObjectURL(c);h?h.location=y:location.href=y,h=null,setTimeout(function(){w.revokeObjectURL(y)},4e4)}});a.saveAs=l.saveAs=l,e.exports=l})})(kv);var zp=kv.exports;const dF=()=>{const{users:e,flavors:t,inventory:r,inventoryMovements:n,sales:i,orders:s,financialRecords:a}=er(),o=()=>{try{const p=Vt.book_new(),v=e.map(re=>({ID:re.id,Nombre:re.name,Email:re.email||"",Teléfono:re.phone||"",Dirección:re.address||"","Fecha Creación":new Date(re.createdAt).toLocaleDateString(),Pedidos:re.orderCount,"Total Galletas":re.totalCookies,"Cajas x4":re.box4Count,"Cajas x6":re.box6Count})),m=Vt.json_to_sheet(v);Vt.book_append_sheet(p,m,"Clientes");const x=t.map(re=>({ID:re.id,Nombre:re.name,Disponible:re.available?"Sí":"No"})),w=Vt.json_to_sheet(x);Vt.book_append_sheet(p,w,"Sabores");const y=r.map(re=>({ID:re.id,Sabor:re.flavor,Tamaño:re.size==="medium"?"Mediana":"Grande",Cantidad:re.quantity,"Fecha Creación":new Date(re.createdAt).toLocaleDateString()})),g=Vt.json_to_sheet(y);Vt.book_append_sheet(p,g,"Inventario");const k=n.map(re=>({ID:re.id,Sabor:re.flavor,Tamaño:re.size==="medium"?"Mediana":"Grande",Cantidad:re.quantity,Tipo:re.type==="addition"?"Añadido":"Deducido",Motivo:re.reason,Fecha:new Date(re.date).toLocaleDateString(),Hora:new Date(re.date).toLocaleTimeString(),"ID Pedido":re.orderId||""})),j=Vt.json_to_sheet(k);Vt.book_append_sheet(p,j,"Movimientos");const O=i.flatMap(re=>re.items.map(Se=>({"ID Venta":re.id,Cliente:re.userName,Fecha:new Date(re.date).toLocaleDateString(),Hora:new Date(re.date).toLocaleTimeString(),Sabor:Se.flavor,Tamaño:Se.size==="medium"?"Mediana":"Grande","Tipo Venta":Se.saleType==="unit"?"Unidades":Se.saleType==="box4"?"Caja x4":"Caja x6",Cantidad:Se.quantity,"Galletas Totales":Se.saleType==="unit"?Se.quantity:Se.quantity*(Se.saleType==="box4"?4:6),"Precio Unitario":Se.price,"Total Item":Se.total,"Total Venta":re.total}))),T=Vt.json_to_sheet(O);Vt.book_append_sheet(p,T,"Ventas");const I=s.flatMap(re=>re.items.map(Se=>({"ID Pedido":re.id,Cliente:re.userName,"Fecha Pedido":new Date(re.date).toLocaleDateString(),"Hora Pedido":new Date(re.date).toLocaleTimeString(),Sabor:Se.flavor,Tamaño:Se.size==="medium"?"Mediana":"Grande",Tipo:Se.saleType==="unit"?"Unidades":Se.saleType==="box4"?"Caja x4":"Caja x6",Cantidad:Se.quantity,"Galletas Totales":Se.saleType==="unit"?Se.quantity:Se.quantity*(Se.saleType==="box4"?4:6),"Total Item":Se.total,"Total Pedido":re.total,Preparado:re.isPrepared?"Sí":"No","Fecha Preparado":re.preparedDate?new Date(re.preparedDate).toLocaleDateString():"",Entregado:re.isDelivered?"Sí":"No","Fecha Entregado":re.deliveredDate?new Date(re.deliveredDate).toLocaleDateString():"",Pagado:re.isPaid?"Sí":"No","Fecha Pagado":re.paidDate?new Date(re.paidDate).toLocaleDateString():""}))),A=Vt.json_to_sheet(I);Vt.book_append_sheet(p,A,"Pedidos");const R=a.map(re=>({ID:re.id,Fecha:new Date(re.date).toLocaleDateString(),Hora:new Date(re.date).toLocaleTimeString(),Tipo:re.type==="income"?"Ingreso":"Gasto",Descripción:re.description,Monto:re.amount,Categoría:re.category})),K=Vt.json_to_sheet(R);Vt.book_append_sheet(p,K,"Finanzas");const G=new Date,Q=`Roskuki_Datos_${G.getFullYear()}-${String(G.getMonth()+1).padStart(2,"0")}-${String(G.getDate()).padStart(2,"0")}_${String(G.getHours()).padStart(2,"0")}-${String(G.getMinutes()).padStart(2,"0")}.xlsx`,ye=_v(p,{bookType:"xlsx",type:"array"}),Ee=new Blob([ye],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});zp.saveAs(Ee,Q),alert("¡Datos exportados a Excel exitosamente!")}catch(p){console.error("Error al exportar:",p),alert("Error al exportar los datos. Por favor intenta de nuevo.")}},l=()=>{try{const p={version:"1.0",timestamp:new Date().toISOString(),data:{users:e,flavors:t,inventory:r,inventoryMovements:n,sales:i,orders:s,financialRecords:a}},v=JSON.stringify(p,null,2),m=new Blob([v],{type:"application/json"}),x=new Date,w=`Roskuki_Backup_${x.getFullYear()}-${String(x.getMonth()+1).padStart(2,"0")}-${String(x.getDate()).padStart(2,"0")}_${String(x.getHours()).padStart(2,"0")}-${String(x.getMinutes()).padStart(2,"0")}.json`;zp.saveAs(m,w),alert("¡Backup JSON exportado exitosamente!")}catch(p){console.error("Error al exportar backup JSON:",p),alert("Error al exportar el backup JSON. Por favor intenta de nuevo.")}},c=e.length+i.length+s.length+r.length+a.length,u=i.reduce((p,v)=>p+v.total,0),d=s.length,h=r.reduce((p,v)=>p+v.quantity,0);return n.length,f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[f.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-100",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Total Registros"}),f.jsx(Yh,{className:"h-4 w-4 text-blue-600"})]}),f.jsx("p",{className:"text-2xl font-bold text-blue-700 mt-2",children:c})]}),f.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border border-green-100",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Ventas Totales"}),f.jsx(jl,{className:"h-4 w-4 text-green-600"})]}),f.jsxs("p",{className:"text-2xl font-bold text-green-700 mt-2",children:["$",u.toFixed(2)]})]}),f.jsxs("div",{className:"bg-amber-50 rounded-lg p-4 border border-amber-100",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-amber-800",children:"Pedidos"}),f.jsx(Jh,{className:"h-4 w-4 text-amber-600"})]}),f.jsx("p",{className:"text-2xl font-bold text-amber-700 mt-2",children:d})]}),f.jsxs("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-100",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h3",{className:"text-sm font-medium text-purple-800",children:"Inventario"}),f.jsx(Yh,{className:"h-4 w-4 text-purple-600"})]}),f.jsx("p",{className:"text-2xl font-bold text-purple-700 mt-2",children:h})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[f.jsxs("h2",{className:"text-xl font-semibold text-amber-800 mb-4 flex items-center",children:[f.jsx(Pl,{className:"mr-2 h-5 w-5"})," Exportar Datos"]}),f.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:f.jsxs("div",{className:"flex items-start",children:[f.jsx(WE,{className:"h-5 w-5 text-blue-600 mt-0.5 mr-2 flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-blue-800",children:[f.jsx("p",{className:"font-medium mb-1",children:"Información sobre la exportación:"}),f.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[f.jsxs("li",{children:[f.jsx("strong",{children:"Excel:"})," Perfecto para análisis, reportes y visualización de datos"]}),f.jsxs("li",{children:[f.jsx("strong",{children:"JSON:"})," Formato técnico para backup completo y transferencia entre dispositivos"]}),f.jsx("li",{children:"Los archivos incluyen fecha y hora para fácil identificación"}),f.jsx("li",{children:"Todos los datos se exportan organizados en hojas/secciones separadas"})]})]})]})}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("button",{onClick:o,className:"flex items-center justify-center px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-md",children:[f.jsx(Jh,{className:"h-6 w-6 mr-3"}),f.jsxs("div",{className:"text-left",children:[f.jsx("div",{className:"font-semibold",children:"Exportar a Excel"}),f.jsx("div",{className:"text-sm opacity-90",children:"Para análisis y reportes"})]})]}),f.jsxs("button",{onClick:l,className:"flex items-center justify-center px-6 py-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-md",children:[f.jsx(Pl,{className:"h-6 w-6 mr-3"}),f.jsxs("div",{className:"text-left",children:[f.jsx("div",{className:"font-semibold",children:"Exportar Backup JSON"}),f.jsx("div",{className:"text-sm opacity-90",children:"Para backup completo"})]})]})]}),f.jsxs("div",{className:"mt-6 bg-gray-50 rounded-lg p-4",children:[f.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"Datos que se exportarán:"}),f.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-semibold text-blue-600",children:e.length}),f.jsx("div",{className:"text-gray-600",children:"Clientes"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-semibold text-green-600",children:i.length}),f.jsx("div",{className:"text-gray-600",children:"Ventas"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-semibold text-amber-600",children:s.length}),f.jsx("div",{className:"text-gray-600",children:"Pedidos"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-semibold text-purple-600",children:r.length}),f.jsx("div",{className:"text-gray-600",children:"Items Inventario"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-semibold text-red-600",children:n.length}),f.jsx("div",{className:"text-gray-600",children:"Movimientos"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-semibold text-indigo-600",children:a.length}),f.jsx("div",{className:"text-gray-600",children:"Registros Financieros"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-semibold text-pink-600",children:t.length}),f.jsx("div",{className:"text-gray-600",children:"Sabores"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-semibold text-gray-600",children:c}),f.jsx("div",{className:"text-gray-600",children:"Total"})]})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-amber-800 mb-4",children:"💡 Cómo sincronizar entre dispositivos"}),f.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[f.jsxs("p",{className:"text-sm text-amber-800 mb-3",children:[f.jsx("strong",{children:"Problema:"})," Los datos se guardan localmente en cada dispositivo y no se sincronizan automáticamente."]}),f.jsxs("p",{className:"text-sm text-amber-800 mb-3",children:[f.jsx("strong",{children:"Solución temporal:"})," Usa el backup JSON para transferir datos entre dispositivos:"]}),f.jsxs("ol",{className:"list-decimal list-inside text-sm text-amber-700 space-y-1 ml-4",children:[f.jsx("li",{children:"En el dispositivo con datos actualizados: Exporta backup JSON"}),f.jsx("li",{children:"Envía el archivo al otro dispositivo (WhatsApp, email, etc.)"}),f.jsx("li",{children:"En el otro dispositivo: Descarga el archivo y úsalo para restaurar"})]}),f.jsxs("p",{className:"text-xs text-amber-600 mt-3",children:[f.jsx("strong",{children:"Nota:"})," Para una solución permanente, se recomienda implementar una base de datos en la nube."]})]})]})]})},hF=()=>f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl font-bold text-amber-900 mb-6",children:"Exportación de Datos"}),f.jsx("div",{className:"space-y-6",children:f.jsx(dF,{})})]}),pF=()=>{const{isAuthenticated:e,isLoading:t,login:r}=$x();return t?f.jsx("div",{className:"min-h-screen bg-amber-50 flex items-center justify-center",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-amber-600 mx-auto mb-4"}),f.jsx("p",{className:"text-amber-800",children:"Cargando aplicación..."})]})}):e?f.jsx(BE,{children:f.jsx(p_,{children:f.jsx(aT,{children:f.jsxs(o_,{children:[f.jsx(on,{path:"/",element:f.jsx(Eh,{to:"/ventas",replace:!0})}),f.jsx(on,{path:"/roskukiManage",element:f.jsx(Eh,{to:"/ventas",replace:!0})}),f.jsx(on,{path:"/ventas",element:f.jsx(dT,{})}),f.jsx(on,{path:"/orders",element:f.jsx(pT,{})}),f.jsx(on,{path:"/inventory",element:f.jsx(vT,{})}),f.jsx(on,{path:"/financial",element:f.jsx(_T,{})}),f.jsx(on,{path:"/customers",element:f.jsx(TT,{})}),f.jsx(on,{path:"/backup",element:f.jsx(hF,{})})]})})})}):f.jsx(oT,{onLogin:r,isLoading:t})};function mF(){return f.jsx(UE,{children:f.jsx(pF,{})})}rx(document.getElementById("root")).render(f.jsx(H.StrictMode,{children:f.jsx(mF,{})}));
